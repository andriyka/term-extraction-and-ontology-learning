2010 17th International Symposium on Temporal Representation and Reasoning  Local Polynomial Regression Models for Average Traffic Speed Estimation and Forecasting in Linear Constraint Databases Hang Yue, Elizabeth Jones* Nebraska Transportation Center Civil Engineering Department University of Nebraska-Lincoln Email: yuehang366@gmail.com *ejones1@unl.edu  Peter Revesz Computer Science & Engineering Department University of Nebraska-Lincoln Email: revesz@unl.cse.edu  difficult to see the intuitive relationship among the important traffic attributes [4].
Time discontinuity is another significant deficiency in relational databases.
Users expect that, regardless of the magnitude of change, the complete snapshot produced at each time slice could duplicate all the unchanged data in the database.
However, relational databases with time discontinuity [3] cannot store the complete information of moving objects, such as vehicles.
Constraint databases are viewed as a special kind of post-relational databases, although they share with relational databases some important features, such as, formal model-theoretic semantics, and various highlevel query languages including SQL and Datalog [5].
Constraint databases have some additional useful features like the ability to represent infinite relations by various types of constraints, to describe continuous temporal and spatiotemporal data in arbitrarily highdimension [6].
Linear equations over rational numbers form a type of constraint in constraint databases (other constraints include linear inequalities over rational numbers or polynomial equations over real numbers).
Once linear equations support the storage of continuous curve, constraint databases can serve as a more useful tool for traffic data archiving and query operations.
As a nonparametric method, local polynomial regression is a real-time curve model without data pre-classification.
It follows the curved tendency of the raw data over the entire estimating region and learns the functions from the dataset [7].
Further, a complicated global regression model can be easily approximated by a local polynomial regression model using the band width and weight.
The aim of our study is to develop the local polynomial regression models to estimate and predict nonlinear average traffic speed with a continuous time-line in linear constraint databases.
The development of these new models means that  Abstract Constraint databases have the specific advantage of being able to represent infinite temporal relations by linear equations, linear inequalities, polynomial equations, and so on.
This advantage can store a continuous time-line that naturally connects with other traffic attributes, such as traffic speed.
In most cases, vehicle speed varies over time, that is, the speed is often nonlinear.
However, the infinite representations allowed in current constraint database systems are only linear.
Our article presents a new approach to estimate and forecast continuous average speed using linear constraint database systems.
Our new approach to represent and query the nonlinear average traffic speed is based on a combination of local polynomial regression and piecewise-linear approximation algorithm.
Experiments using the MLPQ constraint database system and queries show that our method has a high accuracy in predicting the average traffic speed.
The actual accuracy is controllable by a parameter.
We compared the local linear regression model with the local cubic model by using a field experiment.
It was found that the local cubic model follows more closely the raw data than the linear model follows.
1.
Introduction Today relational databases are popularly applied to many traffic systems [1, 2], such as traffic management systems, public transit systems and Advanced Traveler Information Systems (ATISs).
However, when the relational model is used to handle spatial data, the points, lines and polygons in space are discretely saved in tables and often lose some of the important spatial relationships [3].
Having only a finite set of tuples in the relational tables may make it  1530-1311/10 $26.00 (c) 2010 IEEE DOI 10.1109/TIME.2010.24  154  There is a basic difference between a parametric approach and a nonparametric approach.
The former assumes a pre-specified functional form for the density estimator, while the latter does not.
The density estimation in nonparametric regression can effectively describe the overall pattern in a set of data.
Suppose that in a sample of random pairs (x1, y1),..., (xn, yn), the response variable yi is assumed to satisfy [13]:  constraint databases have the capability to model and store continuous nonlinear data.
In addition, constraint databases have far-reaching potentials to evaluate and analyze the information of moving traffic objects (vehicles and pedestrians) on the basis of statistical nonparametric methods.
Section 2 reviews the related literature.
Section 3 discusses the local polynomial regression models and piecewise-linear approximations.
Section 4 presents the experiments that test the accuracy of using constraint databases to predict the average traffic speed.
Finally, Section 5 gives a brief discussion and some concluding remarks.
yi = m( xi ) + u 1/2 ( xi )e i  (1)  where m is a function to be estimated; u is a variance function; ei is an independent random variable with zero mean and unit variance; xi is a random variable having common density f; i =1,..., n. A local polynomial estimator ; , [19, 20, and 21] can be developed via "locally" fitting a pth degree polynomial [?]
b to (xi, yi) using weighted least squares.
Bandwidth h is assumed to approach zero at a rate slower than n -1, that is:  2.
Literature review Local polynomial regression without data preclassification has several advantages.
It can avoid the drawbacks of the traditional kernel regression methodologies, such as the Nadaraya-Watson estimator [8, 9] and the Gasser-Muller estimator [10].
The Nadaraya-Watson estimator produces an undesirable bias, and the Gasser-Muller estimator must pay a price in variance to manipulate a random design model.
Moreover, local polynomial regression with high curvature adapts well to the bias problems at boundaries [11, 12].
As opposed to the local model, the global model deviates from the data pattern and requires the offline training [7], such as neural networks and time series models.
The local modeling is not the approximate function with more accuracy from it, and this feature avoids negative interference exhibited by the global models.
Moreover, the local linear method is preferable to the local constant regression in traffic data analysis [7, 13].
About local constant regression, Smith et al.
[14] and Faouzi [15] respectively implement the k-nearest neighbor method and kernel estimator in transportation.
Travel time estimation has been an interesting research area related to traffic short-term prediction.
[16] describes how speed-based travel time estimation has two application contexts: on-line real-time prediction and off-line historic data analysis.
[17] emphasizes the combination of real-time and historic data for dynamic travel time prediction.
The method of travel time estimation in [18] relies solely on average speeds.
lim h = 0  lim nh = [?]
n-[?]
n-[?]
The function of local polynomial estimator for the true function Y is shown below:  ^ ( x; p, h) Y =  m = e1T ( X xTWx X x )-1 X xTWx y = e1T b^ = b^0  (2)  where e1 is a (p+1)x1 vector having 1 in the first entry and zero elsewhere;  y = ( y1 , [?][?][?
], yn )T is a vector of responses; Wx = diag{Kh ( x1 - x), [?][?][?
], Kh ( xn - x)} is an nxn diagonal matrix of weights;  [?
]1 x1 - x L ( x1 - x) p [?]
[?]
[?]
X x = [?
]M M O M [?]
[?
]1 xn - x L ( xn - x) p [?]
[?]
[?]
is an nx(p+1) design matrix, n is the number of observations;  b^ = (b^0 , [?][?][?
], b^p )T is able to minimize the locally weighted polynomial regression  3.
Method  p  n  [?]
{ y - [?]
b ( x - x) } K i =1  i  j =0  j 2  j  i  h  ( xi - x) ;  K h ([?])
= K ([?]
/ h) / h  is a kernel function scaled by h  3.1.
Local polynomial regression  (kernel function is usually a unimodal symmetric probability with K ( x) dx = 1 ).
[?]
3.1.1.
Definition  155  of several important assumptions, [31] clarifies the rules and calculation steps about DPI bandwidth.
Figure 1 illustrates the important aspects of local polynomial regression theory.
Y (green curve) is the true model, and Y (red curve) is the result of the local polynomial regression.
The bandwidth h is a nonnegative number controlling the size of the local neighborhood.
Kh(xi - x) is the weight assigned to yi , and this weight depends on the height of the kernel function centered about the particular point x.
The data closer to x carry more influence in the value of m(x), not assuming a specific form of the regression function m(x).
There are some shape choices about kernel function [22], such as Epanechnikov, Biweight, Triweight, Normal, Uniform, Triangular, etc.
The shape choice about kernel function is not that important for data estimation and analysis as the bandwidth selection.
3.1.3.
Order choice  In terms of the order of polynomial fit for the ; , , [13] shows that asymptotic performance of fitting the polynomials of higher order leads to a possible bias reduction and a variance increase, and odd order fits are preferable to even order fits in the problem of the variability increase.
Further, even order fits achieve a lower efficiency in a bias reduction, especially in boundary regions and highly clustered design regions.
According to the practical performance in many cases, the order of polynomial fits, which are beyond cubic fit, need a very large sample to actualize a significant improvement.
Therefore, our study proposes to use p=1 or p=3.
A local cubic fit (when p=3) has more degrees of freedom for estimating a high curve region in a set of data than a linear fit (when p=1), although a cubic fit has a higher requirement concerning its calculation and sample variability than a local fit does [22].
3.2.
Piecewise-linear approximation In a piecewise-linear approximation [32] data points (xi, yi) with i=1,2,...,n, the relation between the piecewise-linear function f(xi) and yi satisfies: | f(xi) - yi | <= Ps for each (xi, yi)  (3)  The maximum error threshold Ps controls the maximum difference between the original data points and the piecewise-linear function.
It means that the original data points are always within a narrow band with width Ps around the piecewise-linear function, as shown in Figure 2.
Figure 1.
Local polynomial regression model.
3.1.2.
Bandwidth selection  The bandwidth choice is particularly important to highlight the significant structure in a set of data.
[23] executes a survey of several bandwidth selections for the density estimation, and these selectors are Biased Cross-validation (BCV) [24], Least Squares Crossvalidation (LSCV) [25], Rule-of-Thumb (ROT), Solve-the-equation (STE) [19, 26, 27, 28, and 29], and Smoothed Bootstrap [30], and [23] summarizes that ROT has a small variance yet an unacceptable large mean; LSCV has a good mean yet a too large variance; BCV suffers from unstable performance; both STE and smoother bootstrap have a correctly centered distribution in mean and an acceptable variance.
[31] compares three plug-in bandwidth selection strategies [13], such as ROT, STE, and Direct Plug-in (DPI) via data simulation and analysis, and the result is that DPI and STE have the same appealing performance.
Moreover, DPI does not need the extra complication of requiring a root-finding procedure and minimization.
Hence, DPI is selected as the approach of the bandwidth calculation in our paper.
On the basis  Figure 2.
Piecewise-linear approximation.
The piecewise-linear approximation compresses the discrete data points into a piecewise-linear function for data interpolation and faster query.
Our study innovatively uses this algorithm to approximately transform a curve into a piecewiselinear form.
156  computed for an estimation of accuracy.
Their definitions are shown in the following equations, where n is the number of the average speed reported by the detector station from 4:30 pm to 6:30 pm (n=25), Yi is the average speed from the detector station, and Yi is the speed of the speed-time pairs in the local linear or cubic model:  4.
Experimental results 4.1.
Data collection The values of vehicle speeds used in this research were collected by Cambridge Systematics Inc. at the detector station (717490) of U.S. Highway 101 in Los Angeles, California on June 8, 2005 [33].
Figure 3 shows a schematic of the detector placement for the five lane highway section of this detector station.
Each station records the time that each vehicle occupies the detector as it travels over it.
The detector also counts the number of vehicles passing over it.
The occupancy and the flow rate of vehicles are then used along with the mean vehicle length to determine speed (speed = flow / occupancy / mean vehicle length).
These data for occupancy, flow and speed are aggregated and computed over a specified period of time and only the aggregated data are stored.
The data at this station are averaged over 5 minute periods.
The data points (the open circles in Figure 4) represent the sequential fiveminute average speed values in miles per hour (mph).
Figure 4.
Local linear and cubic models for traffic speed data.
Figure 3.
Loop detector station  4.2.
Model implementation The local polynomial models with the bandwidth h=11.5 and Normal shape estimate the average speed of vehicles in all lanes.
Moreover, the models alter the discrete vehicle speed points into the continuous speed curves.
Figure 4 shows the local linear model (black curve) and the local cubic model (red curve).
The solid circles in this figure represent the average speed of five lanes reported at the detector station.
Figures 5 and 6 respectively display the speedtime pairs in the local linear and cubic models with those average speed values from the detector station (the continuous curve about the local linear or cubic regression model is divided into 361 data points, and these data points are called speed-time pairs).
Mean Square Error (MSE), Root Mean Square Error (RMSE), and Mean Absolute Error (MAE) are  Figure 5.
Speed-time pairs in local linear model and average speed from detector.
The accuracy estimations about the linear and cubic models are given in Table 1.
The results show that the cubic model is closer to the speed values recorded by the detector station than the linear model.
The data patterns in Figures 4, 5, and 6 display that the local cubic fit has more degrees of freedom for estimating a high curve region, which is consistent with the description in [22].
Due to the traffic congestion at the rush hours, the speed is the lowest  157  around 5:00 pm, i.e.
x=30, and then the speed begins to rise and has a tendency to level off after 6:00 pm, i.e., x=90.
From 4:30 pm (x=0) to 4:40 pm (x=10) and from 5:20 pm (x=50) to 5:40 pm (x=70), the local linear and cubic models show significantly different results (see Figures 5 and 6), and the local cubic model is more accurate in following the raw data.
curves in Figure 4 into the corresponding linear functions / constraints with high accuracy for the storage and query of the speed curves.
More importantly, the accuracy can be adjusted and controlled via the error threshold Ps, and the accuracy is higher with a smaller error threshold.
The query design and results are displayed using the MLPQ system [6].
MLPQ allows Datalog queries, minimum and maximum aggregation operators over linear objective functions, and some other operators.
MSE, RMSE, and MAE are also applied for an estimation of accuracy about each sub-function of the piecewise function, where n is the number of the speed-time pairs related to a certain sub-function, Yi is the speed of the pairs, and Yi is the speed calculated by the sub-function.
Based on the piecewise-linear algorithm with the error threshold Ps=0.05, the speed-time pairs' data points in Figures 5 and 6 are compressed into some linear functions, which are respectively shown in Tables 2 and 3.
The MSE, RMSE, and MAE columns summarize the accuracy analysis of every piecewiselinear function calculated by the piecewise-linear approximation algorithm.
The piecewise-linear segments listed in Tables 2 and 3 are actualized to exert the data analysis in constraint databases.
In Figure 7, the MLPQ database system shows the curves similar to those in Figure 4.
Table 4 lists the model speed values evaluated by the local linear and cubic regressions and the query results from constraint databases.
The query results are very close to the velocity values in the local linear and cubic models.
Table 4 also shows that the cubic regression has a better result than the linear regression.
Figure 6.
Speed-time pairs in local cubic model and average speed from detector.
Table 1.
Model estimation  4.3.
Database implementation and queries After using the speed-time pairs in the local polynomial models, the piecewise-linear approximation can transform the continuous speed  158  Table 3.
Local cubic model  Table 4.
Result comparison  159  Figure 7.
Piecewise model speed in MLPQ.
spatiotemporal data analysis in constraint databases.
Moreover, the analysis of other important traffic parameters, such as volume, flow rate, and queue length, would be also necessary in databases.
5.
Conclusions Linear constraint databases are able to store and query discrete data points or linear data.
However, research related to the use of constraint databases for nonlinear data storage and advanced statistical modeling is not well developed.
Our article proposes a novel and flexible approach to use the local polynomial regression and piecewise-linear approximation algorithm for the estimation and prediction of nonlinear traffic average speed in constraint databases.
The experiment results show that this approach has a high accuracy in the storage of continuous nonlinear data in linear constraint databases for a transportation application.
Our study details the definition of local polynomial regression models, their bandwidth selection, and their order choice.
The local cubic fit has more degrees of freedom for estimating a high curve region in traffic speed data than the linear fit, and yet the local cubic fit has a higher requirement concerning its calculation.
Fortunately, the development of the software package can execute the complex calculations concerning the local cubic model, and overcome this demerit to satisfy traffic data operation in a large data size.
More importantly, our approach can make a piecewise-linear function with a high accuracy for any nonparametric regression model.
Future research would concentrate on the microsimulation of traffic moving objects by storing traffic geographical information and vehicular trajectory data extracted from traffic video.
The development of vehicular trajectory data models need to implement  6.
Acknowledgements This research was supported by Nebraska Department of Roads Project No.
ITS-STWD (66).
The authors are solely responsible for the contents of this paper.
References [1] Bob McQueen, Kan Chen and Rick Schuman.
Advanced Traveler Information Systems.
Artech House Publishers, 2002.
[2] Schofer, J.L., F.S.
Koppelman, and W.A.
Charlton.
Perspectives on Driver Preferences for Dynamic Route Guidance Systems.
Transportation Research Record 1588, pp.
26-31, 1997.
[3] Linxin Li, Xingyou Zhang, Reinhard Piltner.
A Spatiotemporal Database for Ozone in the Conterminous U.S.
Proceeding of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIME'06).
Budapest, Hungary, June 15-17, 2006.
[4] Fleming CC, Von Halle B. Handbook of Relational Database Design.
Addison-Wesley, Reading, pp.605, 1989.
[5] Peter Revesz.
Constraint Databases: A Survey.
Semantics in Databases, Springer Berlin, Vol.
1358, pp.
209-246, 1998.
[6] Peter Revesz.
Introduction to Database: From Biological to Spatiotemporal.
Springer, New York, 2010.
160  [7] Hongyu Sun, Henry X. Liu, Heng Xiao, Rachel R. He, and Bin Ran.
Use of local linear regression model for short-Term traffic forecasting.
Transportation Research Board, No.
1836, Vol.
18, pp.59-71, 2003.
[8] Nadaraya, E.A.
On estimating regression.
Theory Probab.
Appl.
10, pp.186-190, 1964.
[9] Wathson, G. W. and Leadbetter, M.R.
Hazard analysis I. Biometrika 51, pp.175-84, 1964.
[10] Gasser, T. and Muller, H.-G. Kernel estimation of regression functions.
In Smoothing Techniques for Curve Estimation (eds.
T. Gasser and M. Rosenblatt).
Springer-Verlag, Heidelberg, pp.
23-68, 1979.
[11] Silverman, B.W.
Density estimation for statistics and data analysis.
Chapman and Hall, London, 1986.
[12] Fan, J. and Marron, J.S.
Fast implementations of nonparametric curve estimators.
J. Comput.
Graphical Statist.
3, pp.35-56, 1994.
[13] Fan J. and Gijbels I.
Local polynomial modeling and its applications.
Chapman & Hall, London, New York, 1996.
[14] Smith, B., Williams, B.
& Oswald, K. Parametric and nonparametric traffic volume forecasting.
Transportation Research Record.
CDROM, 1999.
[15] Faouzi, E. Nonparametric Traffic Flow Prediction Using Kernel Estimator.
Transportation and Traffic Theory: Proceedings of the 13th International Symposium on Transportation and Traffic Theory, Lyon, France, pp.24-26, July, 19, 1996.
[16] Ruimin Li, Geoffrey Rose, and Majid Sarvi.
Evaluation of speed-based travel time estimation models.
Journal of Transportation Engineering, Vol.
132, ASCE, 2006.
[17] Steven l-Jy Chien and Chandra Mouly Kuchipudi.
Dynamic travel time prediction with real-time and historic data.
Journal of Transportation Engineering, Vol.
129, ASCE, 2003.
[18] Lu Sun, Jun Yang, and Hani Mahmassani.
Travel time estimation based on piecewise truncated quadratic speed trajectory.
Transportation Research Part A, Vol.
42, Page 173-186, 2008.
[19] Scott, D.W., Tapia, R.A. and Thompson, J.R. Kernel density estimation revisited.
Nonlinear Anal.
Theory Meth.
Applic.
1, pp.339-372, 1977.
[20] Cleveland, W. Robust locally weighted regression and smoothing scatterplots.
Journal of the American Statistical Association.74, pp.829-836, 1979.
[21] Fan, J. Design-adaptive nonparametric regression.
[22] [23]  [24]  [25] [26]  [27] [28]  [29]  [30]  [31]  [32]  [33]  161  Journal of the American Statistical Association.
87, pp.998-1004, 1992.
Wand, M. P. and Jones, M. C. Kernel Smoothing.
Chapman and Hall, London, 1995.
Jones, M.C.
Marron J.S.
and Sheather S. J.
A brief survey of bandwidth selection for density estimation.
Journal of the American Statistical Association.
91, No.
433, 1996.
Scott, D.W. and Terrell, G.R..
Biased and unbiased cross-validation in density estimation.
Journal of the American Statistical Association.
82, pp.1131-1146, 1987.
Bowman, A. W. An alternative method of crossvalidation for the smoothing of density estimates.
Biometrika 71, pp.353-360, 1984.
Sheather, S.J.
An improved data-based algorithm for choosing the window width when estimating the density at a point.
Comp.
Statist.
Data Anal.
4, pp.6165, 1986.
Park, B. U. and Marron, J.S.
Comparison of data-driven bandwidth selectors.
Journal of the American Statistical Association.
85, 66-72, 1990.
Sheather, S.J.
and Jones, M.C.
A reliable data-based bandwidth selection method for kernel density estimation.
J. Roy.
Statist.
Soc.
Ser.
B 53, pp.683-690, 1991.
Engel, J., Herrmann, E. and Gasser, T. An iterative bandwidth selector for kernel estimation of densities and their derivative.
J. Nonparametric Statist.
to appear, 1995.
Faraway, J.J., and Jhun, M. Bootstrap choice of bandwidth for density estimation.
Journal of the American Statistical Association.
85, pp.1119-1122, 1990.
Ruppert, D., Sheather, S. J. and Wand, M. P. An effective bandwidth selector for local least squares regression.
Journal of the American Statistical Association, 90, pp.1257-1270, 1995.
Peter Revesz, Rui Chen, Min Ouyang.
Approximate Query Evaluation Using Linear Constraint Databases.
Proceeding of the Eighth International Symposium on Temporal Representation and Reasoning (TIME'01).
Cividale Del Friuli, Italy, June 14-16, 2001.
Cambridge Systematics, Inc.
Prepared for Federal Highway Administration.
NGSIM U.S. 101 Data Analysis (4:30 p.m. to 6:30 p.m.), June 8, 2005.