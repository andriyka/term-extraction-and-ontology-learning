2013 20th International Symposium on Temporal Representation and Reasoning  Minimal Consistency Problem of Temporal Qualitative Constraint Networks Jean-FrancESSois Condotta UniversiteE Lille-Nord de France, CRIL CNRS, UMR 8188 Lens, France Email: condotta@cril.fr  Souhila Kaci UniversiteE Montpellier 2, LIRMM CNRS, UMR 5506 Montpellier, France Email: kaci@lirmm.fr  AbstractaVarious formalisms for representing and reasoning about temporal information with qualitative constraints have been studied in the past three decades.
The most known are dedZnitely the Point Algebra (PA) and the Interval Algebra (IA) proposed by Allen.
In this paper, for both calculi, we study a particular problem that we call minimal consistency problem (MinCons).
Given a temporal qualitative constraint network (TQCN) and a positive integer k, this problem consists in deciding whether or not this TQCN admits a solution using at most k distinct points on the line.
On the one hand, we prove that this problem is NP-complete for both PA and IA, in the general case.
On the other hand, we show that for TQCNs dedZned on the convex relations, MinCons is polynomial.
For these TQCNs, we give a polynomial method allowing to obtain compact scenarios.
in the case of IA).
We also consider a close decision problem which we call Minimal Consistency Problem (MinCons).
It consists, given a positive integer k and a TQCN, in deciding whether this TQCN admits a solution using at most k distinct points of the line.
Given a TQCN, to characterize a solution or a scenario among the most compact ones is very interesting and pertinent for some applications.
For example, consider a system allowing to handle temporal qualitative constraints in the context of a project management tool.
For each temporal constraint added by the user, such a system can offer some functionalities like consistency checking or visualizating possible condZgurations of the different temporal activities.
Concerning this last functionality, it is natural that the visualized solution or scenario belongs to the set of the most compact solutions or scenarios.
Another dZeld of applications where characterizing compact solutions of TQCNs can be pertinent is the intelligent systems involving preference handling.
In the context of a recommender system, for decision purposes, it is more convenient to characterize a unique complete preorder associated with a preference set [5].
In the case where preference information can be represented by TQCNs [6], [7], these distinguished models can correspond to particular compact solutions or scenarios.
I. I NTRODUCTION Representing and reasoning about temporal information is crucial in many areas of ArtidZcial Intelligence.
In this context, several qualitative constraint calculi have been proposed.
Allenas calculus [1], also called Interval Algebra, and Point Algebra [2] are certainly the most well-known qualitative temporal calculi.
These two formalisms allow to represent and to reason about possible condZgurations of temporal entities by means of Temporal Qualitative Constraint Networks (TQCNs).
Each constraint of a TQCN is dedZned by a set of base relations of the calculus representing the possible relative positions between two temporal entities.
Several fundamental problems arise with TQCNs.
The main is the consistency problem which consists in deciding whether a given TQCN admits a scenario represents consistent temporal information.
This problem has been widely studied, in particular in the context of PA and IA.
It is polynomial for PA and NP-complete for IA.
We have now efdZcient methods to solve the consistency problem of a TQCN, see for example [3].
Concerning IA, a complete complexity map of the consistency problem has been realized and now, we know all tractable subclasses of this calculus [4].
Another problem is the minimal labeling problem which consists in characterizing the feasible base relations (base relations satisdZed by at least a solution) of a TQCN.
In this paper, we introduce and study a problem which consists, given a TQCN, in dZnding one of the the most compact solutions, i.e.
a solution involving a minimal number of distinct points of the line (of distinct endpoints of intervals 1530-1311/13 $26.00 AS 2013 IEEE 1550-1311/13 DOI 10.1109/TIME.2013.11  In this work, we show that, MinCons is NP-complete for PA despite that the consistency problem is polynomial for this calculus.
Less surprisingly, MinCons is also NP-complete for IA in the general case, but it is also NP-complete for some subclasses known to be tractable concerning the consistency problem.
With that in mind, we focus on the subclasses of the convex relations of PA and IA and show that for these particular cases, MinCons is polynomial.
We dedZne, for convex TQCNs, a polynomial method allowing to extract compact scenarios corresponding to minimal elements of particular partial orders.
After necessary background in Section 2, we introduce MinCons in Section 3.
We study particular orders on scenarios in Section 4 and two aggregation operators of scenarios in Section 5.
Section 6 is devoted to MinCons restricted to the convex TQCNs.
Lastly, we conclude.
11 7  II.
P RELIMINARIES ON T EMPORAL Q UALITATIVE C ONSTRAINT N ETWORKS  pi mi  Relation Symbol Inverse  A (binary) temporal qualitative calculus [8] is based on a dZnite set B of jointly exhaustive and pairwise disjoint (JEPD) relations dedZned on a domain D, called base relations.
The set B contains the identity relation Id, and is closed under the converse operation (a1 ).
Given two elements x and y belonging to D and a base relation b a B, x b y will denote that x and y satisdZes b, i.e.
(x, y) a b.
The complete set of relations are unions of base relations.
Each relation is represented by the set of the base relations included in the corresponding union.
Hence, 2B will represent the set of relations and we get 2|B| possible relations.
Given x, y a D and r a 2B , x r y will denote that x and y satisdZes a base relation b a r, and we will say that x and y satisdZes the relation r. The set 2B is equipped with the usual set-theoretic operations (union and intersection), the converse operation, and the weak composition operation.
The converse of a relation is the union of the converses of its base relations.
The weak composition  of two base relations b and b belonging to a set of base relations B is the relation of 2B dedZned by b  b = {b : ax, y, z a D such that x b y, y b z and x b z}.
For two relations r, r a 2B , r  r is the relation of 2B  dedZned by r  r = bar,b ar b  b .
Intuitively, r  r gives the subset of possible base relations can be satisdZed by two elements x and y when x and y satisfy respectively r and r with a third element z. Renz and Ligozat [8] discuss about the difference between the weak composition and the usual relational composition.
A subclass of relations is a set A a 2B closed under converse, intersection, and weak composition.
In this paper, we are just concerned with two temporal qualitative formalisms, namely the Interval Algebra (IA) [9], [1] and the Point Algebra [10] (PA).
The domain of IA used will be the set of the intervals of the integer line, formally DIA = {(xa , x+ ) a N A N : xa < x+ }.
The set of base relations of this calculus is the set BIA = {eq, p, pi, m, mi, o, oi, s, si, d, di, f, f i}.
These thirteen binary relations represent all the orderings of the four endpoints of two intervals, see Figure 1.
Concerning PA, the domain considered will be the set of points of the integer line, i.e.
DPA = N. The set of base relations of PA, denoted by BPA , is composed by the three binary relations <, > and =, corresponding to the usual strict total orders and the identity relation on N. The set 2BPA is formed by 8 relations corresponding to the set {{<}, {>}, {=}, {<, >}, {<, =}, {> , =}, {<, >, =}, a}.
Sometimes, we will use a short hand notation for these relations: we will write <, >, =, =, a$?, aL, ?
for respectively {<}, {>}, {=}, {<, >}, {<, =}, {>, =}, {<, =, >}.
Meaning oi  X  precedes  p  pi  Y X  meets  m  mi  overlaps  o  oi  f  si Y  eq  X  di  Y  d  X  starts  s  si  during  d  di  Y  s  fi  X  o  Y X  finishes  f  fi  equals  eq  eq  Y  m  X Y  p  (a)  (b)  (a) The base relations of IA, (b) the interval lattice.
Fig.
1.  }
 {<} = {<, >, =}.
For the following dedZnitions, we assume given a set B of base relations of a temporal qualitative calculus dedZned on a domain D. A Temporal Qualitative Constraint Network (TQCN) is a pair formed by a set of variables and a set of constraints.
Each variable represents a temporal entity and each constraint represents the set of possible qualitative condZgurations between two entities.
Formally, a TQCN is dedZned as follows: DedZnition 1: A TQCN is a pair N = (V, C) where: V is a non empty dZnite set of variables; C is a mapping that associates a relation C(v, v  ) a 2B to each pair (v, v  ) of VAV.
C is such that C(v, v) a {Id} and C(v, v  ) = (C(v  , v))a1 .
Given a TQCN, N = (V, C) we have the following dedZnitions: N is said to be trivially inconsistent iff av, v  a V with C(v, v  ) = a.
An instantiation of V is a mapping D dedZned from V to the domain D. A solution D of N is an instantiation of V such that for every pair (v, v  ) of variables in V, (D(v), D(v  )) satisdZes C(v, v  ), i.e., there exists a base relation b a C(v, v  ) such that (D(v), D(v  )) a b. N is consistent iff it admits a solution.
Two TQCNs are equivalent iff they admit the same solutions.
v1  v0  v0  {eq, s}  {s}  {p, m}  {p, o, m}  {p} v2  {p}  v1  {p}  {o}  {f i}  {p}  {eq, f, f i}  v3  (a)  (b) v3  v0 0  v2  v3  v1  Example 1: For example, consider the relations of IA, {m, s} and {d, eq}.
We have the two intervals (3, 5) and (3, 20) which satisdZes {m, s} since (3, 5) s (3, 20).
Moreover, {m, s}a1 = {mi, si} and {m, s}  {d, eq} = {d, o, s, m}.
Concerning PA, by considering the two relations of 2BPA , {<, >} and {<}, we have {<, >}a1 = {<, >} and {<, >  {p}  v2 1  2  3  4  5  (c) Fig.
2.
(a) A TQCN N of IA, (b) s scenario S of N and (c) a solution of S and N .
12 8  v0a v0+ v0a = < v0+ > = v1a = < v1+ > aL v2a > aL v2+ > > v3a > > v3+ > >  v1a v1+ = < > a$?
= < > = > ?
> > > > > >  v2a v2+ < < a$?
< < < ?
< = < > = ?
< < =  v3a v3+ < < < < < < < < ?
< > = = < > =  v0a v0+ v0a = < v0+ > = v1a = < v1+ > > v2a > > v2+ > > v3a > > v3+ > >  v1a v1+ = < > < = < > = > < > > > > > >  v2a v2+ < < < < < < > < = < > = > < < =  a solution of N corresponding to S. Figure 3 represents the convex TQCN of PA corresponding to PA(N ) and the scenario of PA corresponding to PA(S).
v3a v3+ < < < < < < < < < < > = = < > =  From now, the term TQCN will implicitly refer to TQCNs of PA or TQCNs of IA.
We associate with each consistent TQCN N = (V, C) of PA a directed graph denoted by G< (N ).
This graph makes explicit the constraints of the TQCN N dedZned by the relation {<} and is dedZned in the following way : G< (N ) = (V, E) with (v, v  ) a E iff C(v, v  ) = {<}.
Note that, since N is consistent G< (N ) is acyclic.
A path ((v 0 , v 1 ), (v 1 , v 2 ), .
.
.
, (v ka1 , v k )) of G< (N ) = (V, E) will be denoted by v 0 < v 1 < v 2 < .
.
.
< v ka1 < v k .
Furthermore, we associate with each variable v a V two positive integer numbers, denoted respectively by ranka (N , v) and by rank+ (N , v), and dedZned in the following way:  Fig.
3.
The TQCN of PA N  = PA(N ) (left side), a scenario S  of N  (right side), the constraint between by two variables v and v  is given by the entry of the row (resp.
the column) corresponding to v (resp.
v  ).
A sub-TQCN N  of N , denoted by N  a N , is a TQCN (V, C  ) such that C  (v, v  ) a C(v, v  ) av, v  a V .
An atomic TQCN is a TQCN where each constraint is dedZned by exactly one base relation.
A scenario is an atomic consistent TQCN.
Given a set of variables V, the set of all scenarios dedZned on V is denoted by V.
For the particular cases of IA and PA, this set is respectively denoted by VIA and VPA .
Given a TQCN N , N  will denote the set of scenarios which are sub-TQCN of N .
We will say that the TQCN N admits the scenario S when S a N .
A TQCN N = (V, C) is -consistent iff for all v, v  , v  a V, C(v, v  ) a C(v, v  )  C(v  , v  ).
Given a TQCN N , the largest (for a) -consistent sub-TQCN of N will be denoted by (N ) and called the closure of N by weak composition.
This TQCN can be computed in polynomial time (O(|V|3 )).
In the sequel, CPA , CIA , PIA and HIA , will denote respectively the subclass of the convex relations of PA, the subclass of the convex relations of IA [11], the subclass of the pointisable relations of IA [12] and the subclass of the ORD-Horn of IA [13].
CPA corresponds to the relations of PA expected the relation {<, >}.
CIA contains 83 relations.
Ligozat introduces a lattice arranging the base relations of BIA , see Figure 1(b).
The convex relations of IA correspond to the intervals of this lattice.
A convex TQCN is a TQCN dedZned by convex relations.
Furthermore, we have CIA a PIA a HIA .
For TQCNs of PA and TQCNs of IA dedZned on HIA , computing the closure under weak composition allows to solve the consistency problem.
HIA is the maximal subclass of IA containing the singleton relations for which the consistency problem is tractable.
A constraint between two intervals dedZned by convex relations of IA can, in an equivalent manner, be expressed by constraints dedZned by convex relations of PA on the bounds of the two intervals.
In [12], is given for each convex relation of IA its translation in PA.
Given a set of interval variables V, we dedZne the set of point variables Points(V) by Points(V) =  a + vaV {v , v }.
Moreover, given a TQCN N = (V, C) of IA dedZned by relations of CIA , PA(N ) will denote the TQCN of PA dedZned on the variables Points(V) obtained by using the translation given in [12].
aV aV  ranka (N , v) is the maximal length of the paths v  < .
.
.
< v from a variable v  a V to the variable v, rank+ (N , v) is the maximal length of the paths v < .
.
.
< v  from the variable v to a variable v  a V.  We dedZne the width of the TQCN N , denoted by width(N ), by the integer number max{ranka (N , v) : v a V} + 1.
We extend this dedZnition to a convex TQCN N of IA by considering its translation into PA : width(N ) = width(PA(N )).
Given a solution D of a TQCN N = (V, C) of PA (resp.
IA), we dedZne the cardinality of D, denoted by card(D), by card(D) = |{D(v) : v a V}| (resp.
card(D) = |{x, y : v a V and D(v) = (x, y)}|).
Example 3: Figure 4(a) shows a graph G0 whose the transitive closure is the graph G< (S  ) with S  = (V, C) the scenario in Figure 3.
For each variable v a V is given the integer ranka (S  , v).
For example, we have ranka (S  , v2a ) = 2 because the longest paths of G< (S  ) having v2a as last vertex have a length of 2 (the path v0a < v0+ < v2a for example).
The width of S  , i.e.
width(S  ), is equal to 6.
Furthermore, rank+ (S  , v2a ) = 3.
The cardinality of the solution in Figure 2(c) is 6.
III.
T HE M INIMAL C ONSISTENCY P ROBLEM In this section, we introduce a decision problem concerning the TQCNs which we call the Minimal Consistency Problem (MinCons).
Intuitively, given a TQCN N and a positive integer k, this problem is to decide whether there exists or not a solution of N using at most k distinct points on the line.
More formally, this problem is dedZned in the following way: DedZnition 2: The problem MinCons : aV Given : A TQCN N = (V, C) and an integer k aL 0. aV Question : Is there a solution D of N such that card(D) a$?
k?
By noting that, given a solution D, the width of the scenario corresponding to D and the cardinality of D are equal, we can in a manner equivalent reformulate the question of MinCons by : is there a consistent scenario S of N such that width(S) a$?
k?
The restriction of MinCons to the TQCNs of PA (resp.
IA)  Example 2: Figure 2(a) represents a TQCN N = (V, C) of IA by a graph.
Note that we do not represent the constraint C(v, v  ) when C(v  , v) is already represented or v = v  .
This TQCN is dedZned on CIA and is -consistent.
In Figure 2(b) and Figure 2(c), we have respectively a scenario S of N and  13 9  0  5  0  5  v0a  v3+  v0a  v3+  v2+  v1a  5  0  v1a  v0+ 1  v2a 2  v1+  v3a  3  4  0  v0+  v1+  v3a  v2a  1  2  3  4  v2+ 5  (a) G0  (b) G1  0 v0a v1a  4  2 v1+ v0+  v3+ v3a  v2a  1  0  2  3  v2+ 4  (c) G2 Fig.
4.
Three graphs G0 , G1 and G2 corresponding to the graphs G< (S0 ), G< (S1 ), G< (S2 ) (without edges which we can obtain by transitivity), with S0 , S1 and S2 three scenarios of the TQCN N  .
The scenario S0 is the scenario S  .
D of N with card(D) a$?
3, for each v a V , there exists a unique i a {1, 2, 3} such that D(coli ) = D(v).
Moreover, for all (v, v  ) a E, D(v) = D(v  ).
We can check that G is 3 colorable iff the answer of D is yes.
aV (2) D  = N  = (V  , C  ), k  .
The integer k is dedZned by 4.
For each vertex of G and each color is introduced a variable of V  : V = V aS {col1 , col2 , col3 }.
We force col1 , col2 and col3 to be instantiated by three intervals (the colors) with same lower bounds and different upper bounds : C  (col1 , col2 ) = C  (col2 , col3 ) = {s} and C  (col2 , col1 ) = C  (col3 , col2 ) = {si}.
For all v a V , we force the interval associated with v to have the same lower bounds that the intervals associated with col1 , col2 and col3 : C  (col1 , v) = {eq, s}.
Given (v, v  ) a V A V , if (v, v  ) a E then C  (v, v  ) is dedZned by {s, si}.
In the contrary case, C  (v, v  ) is dedZned by BIA .
Furthermore, C  (v, v) = {eq} for all v a V. Other constraints of C  are dedZned by BIA .
For each solution D  of N  with card(D  ) a$?
4 and for each v a V , there exists a unique i a {1, 2, 3} such that D  (coli ) = D(v).
Moreover, for all (v, v  ) a E, D  (v) = D  (v  ).
We can show that G is 3 colorable iff the answer of D  is yes.
  will be denoted by PMinCons (resp.
IMinCons).
For example, consider the instance of IMinCons D1 = N , 6 and the instance of PMinCons D2 = N  , 3 with N and N  the TQCNs respectively described in Figure 3 and Figure 4.
The reader can check that the answer of D1 is yes whereas the answer of D2 is no.
Given a subclass A a 2BPA (resp.
A a 2BIA ), PMinCons(A) (resp.
IMinCons(A)) denotes the restriction of PMinCons (IMinCons) to the TQCNs dedZned by relations belonging to A.
Now, we are going to show that in the general case MinCons is a NP-complete problem, even for PA for which the consistency problem is polynomial [2].
By dedZning the two sets E a 2BPA and E2 a 2BIA by E = {{=}, {<, >}, BPA } and E2 = {{eq}, {s}, {si}, {s, si}, BIA }, we have the following result : Proposition 1: Let A a 2BPA and A a 2BIA two subclasses.
We have: (1) if E a A then PMinCons(A) is NP-hard ; (2) if E  a A then IMinCons(A ) is NP-hard.
Proof.
Suppose that E a A and E  a A .
We are going to dedZne a reduction from the 3-coloring problem to PMinCons(A) and a reduction from the 3-coloring problem to IMinCons(A ).
Let G = (V, E) be an undirected graph to be colored with 3 colors.
We dedZne the instance D of MinConsPA and the instance D  of MinConsIA such that the answer of D (resp.
D  ) is yes iff G is 3 colorable.
aV (1) D = N = (V, C), k.
The integer k is dedZned by 3.
To each vertex of G and each color corresponds a variable of V : V = V aS {col1 , col2 , col3 }.
We force col1 , col2 and col3 to have three different values (the colors) by dedZning C(coli , colj ) with the relation {<, >} for all i, j a {1, .
.
.
, 3} such that i = j.
For all v, v  a V such that v = v  , if (v, v  ) a E then C(v, v  ) = {<, >} (v and v  cannot have the same color).
In the contrary case, C(v, v  ) is dedZned by {<, =, >}.
Furthermore, C(v, v) = {=} for all v a V. Other constraints of C are dedZned by {<, =, >}.
For any solution  MinCons is clearly in NP since, in polynomial time, we can check whether an atomic TQCN S on V is a scenario of a TQCN N = (V, C) and check whether width(S) a$?
k with k a positive integer.
Furthermore, we have the set E  which is included by PIA a HIA .
Hence, from the previous proposition we can assert the following result : Theorem 1: PMinCons, IMinCons, IMinCons(PIA ) and IMinCons(HIA ) are NP-complete problems.
Note that MinCons is a problem that is at least as hard that the consistency problem.
Indeed, we can remark that the cardinality of a solution of a TQCN N = (V, C) is at most |V | for a TQCN of PA and at most 2|V | for a TQCN of IA.
Hence, we can solve the consistency problem of a TQCN N = (V, C) of PA (resp.
of IA) by solving PMinCons of  14 10  N , |V | (resp.
IMinCons of N , 2|V |).
From this, we can directly establish (without using Proposition 1) that IMinCons is NP-hard since the consistency problem of IA is NP-hard.
Despite Theorem 1, we will see that there exist some interesting polynomial cases for MinCons.
Indeed, in the sequel, we study the case of the convex subclasses and show that PMinCons(CPA ) and IMinCons(CIA ) are polynomial.
Proof.
The transitivity and the redZexivity follow straightly the dedZnition of (VPA , a$?a ) and (VPA , a$?+ ).
Now, consider two scenarios S = (V, C), S  = (V, C  ) a VPA such that S a$?a S  and S  a$?a S. For all v a V, ranka (S, v) = ranka (S  , v).
Hence, for all v, v  a V, C(v, v  ) = {=} iff ranka (S, v) = ranka (S, v  ) iff ranka (S  , v) = ranka (S  , v  ) iff C  (v, v  ) = {=}.
For all v, v  a V, C(v, v  ) = {<} iff ranka (S, v) < ranka (S, v  ) iff ranka (S  , v) < ranka (S  , v  ) iff C  (v, v  ) = {<}.
We can conclude that S and S  have the same constraints.
By a similar line of reasoning we can show that (VPA , a$?+ ) is antisymmetric.
  IV.
C OMPARISON OF S CENARIOS In this section, we introduce several preorder relations on scenarios of PA.
These binary relations will allow us to compare scenarios and, under certain conditions, to characterize some scenarios of a TQCN among the scenarios having a minimal width, i.e.
the scenarios corresponding to the solutions using a minimal number of points on the line.
To compare the scenarios dedZned on a set of variables V in term of width, we introduce a dZrst binary relation denoted by (VPA , a$?C ) and dedZned in the following manner:  We can show that for all scenarios S and S  , when S and S  satisfy a$?a or a$?+ , S is at least as compact as S  .
Indeed, we have the following property: Proposition 3: Let two scenarios S = (V, C) and S  = (V, C  ) belonging to VPA .
We have: if S a$?a S  or S a$?+ S  then S a$?C S  .
DedZnition 3: Given a set of point variables V, the binary relation (VPA , a$?C ) is dedZned by : aS, S  a VPA , S a$?C S  iff width(S) a$?
width(S  ).
Proof.
We know that width(S) = max{ranka (S, v) : v a V} + 1 = max{rank+ (S, v) : v a V} + 1 et width(S  ) = max{ranka (S  , v) : v a V} + 1 = max{rank+ (S  , v) : v a V}+1.
Furthermore, if S a$?a S  (resp.
S a$?+ S  ), for all v a V, ranka (S, v) a$?
ranka (S  , v) (resp.
rank+ (S, v) a$?
rank+ (S  , v)).
From all this, we can conclude that if S a$?a S  or S a$?+ S  then width(S) a$?
width(S  ).
  Clearly, (VPA , a$?C ) is a transitive and redZexive relation.
In the general case, it is not an antisymmetric relation since two distinct scenarios dedZned on a same set of variables can have same width.
For two scenarios S and S  , we will say that S is at least as compact as S  when S a$?
S  .
In the sequel, we dedZne two orders on the set of the scenarios of PA dedZned on V, respectively denoted by a$?a and a$?+ .
Intuitively, two scenarios S and S  satisfy a$?a iff for all solutions D and D  of S and S  respectively, for each variable v a V, we have the number of points on the line before D(v) for S, i.e.
|{D(v  ) : D(v  ) < D(v)}| which is less than or equal to the number of points on the line before D(v) for S  , i.e.
|{D  (v  ) : D(v  ) < D  (v)}|.
For the relation a$?+ , we compare the numbers of points on the line after D(v) rather than the points before D(v).
Formally, (VPA , a$?a ) and (VPA , a$?+ ) are dedZned in the following manner :  V. AGGREGATION O PERATORS FOR S CENARIOS In this section, we introduce two aggregation operators, denoted by  and a, allowing to combine two scenarios S and S  of PA in order to obtain a scenario both smallest than S and S  w.r.t.
the partial order a$?a (resp.
a$?+ ) for  (resp.
a).
Hence, the scenario resulting of the aggregation is at least as compact as S and S  .
These two operators will allow us to show that all consistent convex TQCN admits a unique minimal scenario w.r.t.
a$?a or a$?+ .
DedZnition 5: Let S = (V, C), S  = (V, C  ) a VPA .
DedZnition 4: Given a set of point variables V, the binary relations (VPA , a$?a ) and (VPA , a$?+ ) are dedZned by :  a aV aS, S a VPA , S a$?
S  iff av a V, ranka (S, v) a$?
a  rank (S , v) ;  + aV aS, S a VPA , S a$?
S  iff av a V, rank+ (S, v) a$?
rank+ (S  , v).
aV  aV  Example 4: For example, consider the three scenarios S0 , S1 and S2 represented by the graphs G0 , G1 and G2 in Figure 4.
We can check that S0 a$?+ S2 and S1 a$?+ S2 .
However, S0 a$?+ S1 .
Indeed, we have for example ranka (S0 , v1+ ) a$?
ranka (S1 , v1+ ) (ranka (S0 , v1+ ) = 3 and ranka (S1 , v1+ ) = 2).
S  S  is the unique scenario S  = (V, C  ) of VPA having as solution the instantiation D dedZned by D(v) = min{ranka (S, v), ranka (S  , v)} ; S a S  is the unique scenario S  = (V, C  ) of VPA having as solution the instantiation D dedZned by D(v) = (max{width(S), width(S  )} a 1) a min{rank+ (S, v), rank+ (S  , v)}.
Intuitively, from two scenarios S and S  , the operator  (resp.
a) allows to obtain a scenario by preserving, for each v a V, the shortest paths of G< (S) or G< (S  ) of the form v 0 < .
.
.
< v k with v k = v (resp.
of the form v 0 < .
.
.
< v k with v 0 = v).
Note that the operators  and a are close to the operator MAX used in [14] to aggregate preference models.
The relations a$?a and a$?+ are two partial orders, as the following proposition proves:  Proposition 2: Let V a set of point variables.
We have: (VPA , a$?a ) and (VPA , a$?+ ) are redZexive, transitive and antisymmetric.
15 11  Example 5: For example, consider the three scenarios S0 , S1 and S2 respectively represented by the graphs G0 , G1 and G2 in Figure 4.
The reader can check that S2 is S0  S2 .
elements and, with this result, we will show that MinCons is polynomial for the convex TQCNs, contrary to the general case.
Proposition 5: Let N = (V, C) be a convex TQCN of PA and two scenarios S, S  a N .
We have: S  S  a N  and S a S  a N .
Proof.
We prove the property S  S  a N .
The property S a S  a N  can be proved by a similar line of reasoning.
Let D the instantiation dedZned by D(v) = min{ranka (S, v), ranka (S  , v)} for all v a V and, let v, v  two variables belonging to V. We denote by b, b and b the base relations dedZning the constraints between v and v  of S, S  , S  S  , respectively.
Note that by dedZnition b is the base relation satisdZed by the pair (D(v), D(v  )).
We are going to show that b a C(v, v  ) : aV Case b is < and b is <.
We have < ranka (S, v  ) and ranka (S  , v) < ranka (S, v) a   rank (S , v ).
Hence, min{ranka (S, v), ranka (S  , v)} < min{ranka (S, v  ), ranka (S  , v  )}.
Consequently, we have D(v) < D(v  ).
We can conclude that b is < which belongs to C(v, v  ) since b is also <.
aV Case b is < and b is =.
We have ranka (S, v) < ranka (S, v  ) and ranka (S  , v) = ranka (S  , v  ).
Consider the three possible following cases: (a) Case ranka (S  , v) a$?
ranka (S, v).
We can show that D(v) = min{ranka (S, v), ranka (S  , v)} = ranka (S  , v) and D(v  ) = min{ranka (S, v  ), ranka (S  , v  )} = ranka (S  , v  ) = ranka (S  , v).
Hence, D(v) = D(v  ).
Consequently, b is = which belongs to C(v, v  ) since b is also =.
(b) Case ranka (S, v) < ranka (S  , v) < ranka (S, v  ).
We can show that D(v) = min{ranka (S, v), ranka (S  , v)} = ranka (S, v) and D(v  ) = min{ranka (S, v  ), ranka (S  , v  )} = ranka (S  , v  ) = ranka (S  , v).
Hence, D(v) < D(v  ).
Consequently, b is < which belongs to C(v, v  ) because b is also <.
(c) Case ranka (S, v  ) a$?
ranka (S  , v).
We can show that D(v) = min{ranka (S, v), ranka (S  , v)} = ranka (S, v) and D(v  ) = min{ranka (S, v  ), ranka (S  , v  )} = ranka (S, v  ).
Hence, D(v) < D(v  ).
Consequently, b is < which belongs to C(v, v  ) since b is also <.
aV Case b is < and b is >.
We have C(v, v  ) = {<, =, >} since {<, =, >} is the unique convex relation containing both < and >.
Consequently, b belongs to C(v, v  ).
aV Case b is = and b is =.
We have = ranka (S, v  ) and ranka (S  , v) = ranka (S, v) ranka (S  , v  ).
Hence, min{ranka (S, v), ranka (S  , v)} = min{ranka (S, v  ), ranka (S  , v  )}.
Consequently, we have D(v) = D(v  ).
We can conclude that b is = which belongs to C(v, v  ) since b is also =.
aV The other cases corresponds to previous cases by permuting  S and S  or v and v  .
As explain at the beginning of this section, the operators  and a allow to obtain a scenario at least as compact as the scenarios given as inputs and also smaller than the two scenarios w.r.t.
respectively a$?a and a$?+ : Proposition 4: Let S and S  = (V, C  ) be two scenarios belonging to VPA .
We have:  a  a  aV (1) (S  S ) a$?
S and (S  S ) a$?
S ;  +  +  aV (2) (S a S ) a$?
S and (S a S ) a$?
S ;     aV (3) (S  S ) a$?C S, (S  S ) a$?C S , (S a S ) a$?C S and   (S a S ) a$?C S .
Proof.
aV (1) Let S  = (V, C  ) be the TQCN S  S  and D the instantiation on V dedZned by D(v) = min{ranka (S, v), ranka (S  , v)}.
D uses only positive or null integers.
Consequently, we have |{v  a V : C  (v  ) = {<}}| a$?
D(v).
Hence, |{v  a V : C  (v  ) = {<}}| a$?
min{ranka (S, v), ranka (S  , v)}.
Since a  rank (S , v) = |{v  a V : C  = {<}}|, we can conclude a$?
min{ranka (S, v), ranka (S  , v)}.
that ranka (S  , v) a  Hence, rank (S , v) a$?
ranka (S, v) and ranka (S  , v) a$?
ranka (S  , v)}.
Thus, we have (S  S  ) a$?a S and (S  S  ) a$?a S  .
aV (2) The property (2) can be proved by following an approach similar to the one followed for the property (1).
aV (3) The property (3) is a consequence of the properties (1) and (2) of Proposition 3.
 Hence, both aggregation operators  and a allows us to obtain from two scenarios S and S  , a scenario at least as compact as S and S  .
Nevertheless, note that in the general case, when S and S  are scenarios of a TQCN N , the scenarios S  S  and S a S  are not necessarily scenarios of N .
To be convinced of this, consider the TQCN of PA N  = (V, C  ) dedZned by the same set of variables and the same constraints than those of the TQCN N  represented in Figure 3 except for the constraint between v1+ and v2a which is dedZned for N  by the relation {<, >}.
The scenarios S0 and S1 represented in Figure 4 are scenarios of N  .
However, the scenario S2 in the same dZgure, which corresponds to S0  S1 , is not a scenario of N  .
Indeed, the base relation satisdZed by (v1+ , v2a ) is = for this scenario whereas C  (v1+ , v2a ) is the relation {<, >}.
In spite of this, we will show in the next section that the result of the operators  and a on two scenarios of a convex TQCN is always a scenario of this TQCN.
VI.
MinCons AND THE CONVEX TQCNS In this section, we focus on the convex TQCNs, i.e.
TQCNs of PA (resp.
IA) dedZned by relations belonging to the subclass CPA (resp.
CIA ).
We will notably show that the partial orders a$?a and a$?+ restricted to the scenarios of a convex and consistent TQCN admits a unique minimal element.
We will also characterize a polynomial method to compute these minimal  From this proposition, we can establish that for every convex and consistent TQCN of PA N , (N , a$?a ) and (N , a$?+ ) have a unique minimal element :  16 12  integers D(v) and D(v  ).
Consider all possible cases and let us show that b a C(v, v  ) : a Case 1: b is the relation <.
We have k < k  .
Furthermore, there exists two paths of G< (N ) composed of distinct variables of the form v 0 < .
.
.
< v k with v k = v   and w0 < .
.
.
< wk with wk = v  .
Now, suppose that < does not belong to C(v, v  ).
We have C(v, v  ) which corresponds to one of the following relations  {{=, >}, {=}}.
Consider the variable wk a1 .
We have  k a1 ) = {>}.
As N is -consistent, we have C(v , w    C(v, wk a1 ) a (C(v, v  )C(v  , wk a1 )).
Hence, C(v, wk a1 ) is the relation {>} since {=, >}  {>} = {=}  {>} = {>}.
 Hence, w0 < .
.
.
< wk a1 < v is a path of G< (N ) with a length greater than or equal to ranka (N , v  ).
There is a contradiction.
We can conclude that < belongs to C(v, v  ).
a Case 2: b is the relation > or the relation =.
By following a line of reasoning similar to the one of the previous case, we can show that b a C(v, v  ).
aV Lastly, let us show that S is Mina$?a (N ).
Suppose that for a variable v a V, ranka (S, v) > ranka (Mina$?a (N ), v).
Let k = ranka (S, v).
For the graph G< (Mina$?a (N )), every path of the form v 0 < .
.
.
< v has a length strictly lower than k. It is not possible since G< (N ) is a subgraph of G< (Mina$?a (N )) which has a path of this form of length equal to k. Hence, for every v a V, we have ranka (S, v) a$?
ranka (Mina$?a (N ), v).
Consequently, S a$?a Mina$?a (N ).
Since Mina$?a (N ) is the unique minimal element of (N , a$?a ), S is the scenario  Mina$?a (N ).
Proposition 6: Let N = (V, C) be a consistent and convex TQCN of PA.
The partial orders (N , a$?a ) and (N , a$?+ ) admit unique minimal elements, denoted by respectively Mina$?a (N ) and Mina$?+ (N ).
Proof.
Note that N  is a non empty set since N is consistent.
Hence, (N , a$?a ) admits at least one minimal element.
Now, suppose that N admits two different scenarios S and S  such that S and S  are minimal elements of (N , a$?a ).
We will denote by S  the scenario corresponding to S  S  .
From Proposition 5, S  belongs to N .
Moreover, from Proposition 4, we have S  a$?a S and S  a$?a S  .
Since S and S  are two minimal elements of (N , a$?a ), we can assert that S  = S and S  = S  .
Consequently, S = S  .
There is a contradiction.
We can conclude that (N , a$?a ) has a unique minimal element.
With a similar line of reasoning we can prove that (N , a$?+ ) admits a unique minimal element.
 For each convex and consistent TQCN of PA N , we can also show that there is no scenario more compact than Mina$?a (N ) and Mina$?+ (N ): Proposition 7: Let N = (V, C) be a convex and consistent TQCN of PA. For every scenario S a N , we have Mina$?a (N ) a$?C S and Mina$?+ (N ) a$?C S. Proof.
Let S a N .
We denote by S  the scenario corresponding to Mina$?a (N )  S. From Proposition 5, S  is a scenario belonging to N .
Moreover, from Proposition 4, we have S  a$?a Mina$?a (N ) (a) and S  a$?a S (b).
From (a) and the dedZnition of Mina$?a (N ), we can assert that S  = Mina$?a (N ).
Consequently, from this and (b) we have Mina$?a (N ) a$?a S. From Proposition 3, we can conclude that Mina$?a (N ) a$?C S. Mina$?+ (N ) a$?C S can be proved in a similar manner.
  From this result we can establish that the scenarios Mina$?a (N ) and Mina$?+ (N ) of a convex, non trivially inconsistent and -consistent TQCN N can be computed in O(n2 ) with n the number of its variables.
Indeed, for this, in a dZrst step we compute the graph G< (N ).
Then, in a second step, we compute for each v a V, ranka (N , v) and rank+ (N , v) from the directed acyclic graph G< (N ).
In a last step, the constraints of Mina$?a (N ) and Mina$?+ (N ) are computed from the integers obtained in the previous step.
Each of these steps can be realized in O(n2 ).
For convex TQCNs, from Proposition 7 we know that Mina$?a (N ) and Mina$?+ (N ) belong to the set of scenarios which are the most compact.
From this and the previous proposition, we can establish that MinCons is a polynomial problem for the convex TQCNs:  Now, given a consistent and convex TQCN of PA N , we are going to establish a result allowing to compute the two scenarios Mina$?a (N ) and Mina$?+ (N ).
Proposition 8: Let N = (V, C) be a not trivially inconsistent, -consistent and convex TQCN of PA. We have : aV  aV  (1) Mina$?a (N ) corresponds to the scenario on V having as solution the instantiation D dedZned by: for all v a V, D(v) = ranka (N , v); (2) Mina$?+ (N ) corresponds to the scenario on V having as solution the instantiation D dedZned by: D(v) = rank+ (N , v).
Theorem 2: PMinCons(CPA ) and IMinCons(CIA ) are polynomial and can be solved in O(n3 ), with n the number of variables of the TQCN considered.
Proof.
Due to lack of space, we just give a proof for the dZrst property.
To prove the property (2), we can use a similar approach.
Note that since N is -consistent and not trivially inconsistent, N is consistent.
Let S = (V, C  ) be the scenario having as solution the instantiation D dedZned by D(v) = ranka (N , v) for all v a V. aV First, let us show that S is a scenario of N .
Let v, v  a V and b the base relation dedZning the constraint C  (v, v  ), i.e.
the base relation satisdZed by the pair (D(v), D(v  )).
Sometimes, we will denote by respectively k and k  the two  Proof.
aV Let D = (N , k) be an instance of PMinCons(CPA ).
To answer to the question associated with D we can in a dZrst step compute (in O(n3 )) the closure under weak composition of N , i.e.
the TQCN (N ).
(N ) is convex and equivalent to N .
In the case where (N ) is trivially inconsistent, we know that N is not consistent and the answer of D is no.
In the contrary case, in a second  17 13  v0a v1a  v0+  v1 v3a  v2  v0  v1+ v2+  v3+  v2a  v3  0  1  2  3  v0a v1a  v0+ v1+ v2a  v3a  v2+ v3+  (a) G3  v1  v2  v0  v3  0  1  2  3  v0a v1a  v0+ v1+  v2a v3a  v2+ v3+  (b) D1  (c) D2  v0  v0 {eq} {m}  v1  {eq}  {p} {p} v2  {p}  v1  {m}  {p} {p} v2  {p}  {f i}  {eq}  v3  v3  (d) S1  (e) S2 Fig.
5.  aV  step we compute the maximal length k  of the paths of G< ((N )) (in O(n2 ).
We know that k  corresponds to the width of the most compact scenarios of N since k  = width(Mina$?a ((N ))) = width(Mina$?+ ((N ))) (Proposition 8).
Hence, if k aL k  then the answer of D is yes, otherwise the answer is no.
Let D = (N , k) an instance of IMinCons(CIA ) with N = (V, C).
To answer to the question associated with D (or dZnd a compact scenario of N ), we can consider the equivalent problem of PMinCons(CPA ) corresponding to the instance D  = (PA(N ), k).
Remind that PA(N ) corresponds to the translation of N into TQCN N  of PA dedZned on the set of variables Points(V).
  [2] M. Vilain, H. Kautz, and P. van Beek, aConstraint propagation algorithms for temporal reasoning: a revised report,a Qualitative Reasoning about Physical Systems, pp.
372a381, 1990.
[3] J. Huang, J. J. Li, and J. Renz, aDecomposition and tractability in qualitative spatial and temporal reasoning,a Artif.
Intell., vol.
195, pp.
140a164, 2013.
[4] T. Drakengren and P. Jonsson, aA complete classidZcation of tractability in allenas algebra relative to subsets of basic relations,a Artif.
Intell., vol.
106, no.
2, pp.
205a219, 1998.
[5] C. Boutilier, aToward a logic for qualitative decision theory,a in KRa94, 1994, pp.
75a86.
[6] A. N. The and A. TsoukiaEs, aNumerical representation of pqi interval orders,a Discrete Applied Mathematics, vol.
147, no.
1, pp.
125a146, 2005.
[7] J.-F. Condotta and S. Kaci, aCompiling preference queries in qualitative constraint problems,a in Proc.
of The 26th Intern.
FLAIRS Conference (FLAIRSa13), pp.
1-6, 2013.
[8] J. Renz and G. Ligozat, aWeak composition for qualitative spatial and temporal reasoning,a in Proc.
of the 11th Intern.
Conf.
CPa05, Spain, LNCS, vol.
3709, 2005, pp.
534a548.
[9] J. F. Allen, aAn interval-based representation of temporal knowledge,a in IJCAI, 1981.
[10] M. Vilain and H. Kautz, aConstraint Propagation Algorithms for Temporal Reasoning,a in Proc.
of the Fifth National Conf.
on ArtidZcial Intelligence (AAAIa86), 1986, pp.
377a382.
[11] K. NoEkel, aTemporally distributed symptoms in technical diagnosis,a LNCS, vol.
517, pp.
1a184, 1991.
[12] P. Van Beek and R. Cohen, aExact and approximate reasoning about temporal relations,a Computational Intelligence, vol.
6, pp.
133a44, 1990.
[13] B. Nebel and H.-J.
BuErckert, aReasoning About Temporal Relations: A Maximal Tractable Subclass of Allenas Interval Algebra,a JACM, vol.
42, pp.
43a66, 1995.
[14] S. Kaci and L. W. N. van der Torre, aAlgorithms for a nonmonotonic logic of preferences,a in Proc.
of The 8th Euro.
Conf.
Symbolic and Quantitative Approaches to Reasoning with Uncertainty (ECSQARUa05), 2005, pp.
281a292.
VII.
C ONCLUSION In this paper, we introduced and studied the problem which consists in charachterizing compact solutions or scenarios of a TQCN and a related decision problem called MinCons.
We showed that these problems are NP-hard for PA and for IA.
Moreover, we proved that for the particular of the convex relations these problems are polynomial.
For this, by following an approach based on particular partial orders and aggregation operators on scenarios, we proved that we can obtain in polynomial time particular compact scenarios for the consistent convex TQCNs.
A dZnal objective of our work is to identify all tractable cases for MinCons of IA and dedZne methods to solve this problem for the general case.
R EFERENCES [1] J. F. Allen, aMaintaining knowledge about temporal intervals,a vol.
26, no.
11.
New York, NY, USA: ACM, 1983, pp.
832a843.
18 14