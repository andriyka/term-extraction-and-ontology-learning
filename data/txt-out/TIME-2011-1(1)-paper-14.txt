The dark side of Interval Temporal Logic: sharpening the undecidability border Davide Bresolin1 , Dario Della Monica2,3 , Valentin Goranko4 , Angelo Montanari3 , Guido Sciavicco5,6 1 University of Verona, Italy, 2 University of Salerno, Italy, 3 University of Udine, Italy, 4 Technical University of Denmark, 5 University of Murcia, Spain, 6 UIST Ohrid, Macedonia  Abstract Unlike the Moon, the dark side of interval temporal logics is the one we usually see: their ubiquitous undecidability.
Identifying minimal undecidable interval logics is thus a natural and important item in the research agenda in the area.
The decidability status of a logic often depends on the class of models (in our case, the class of interval structures) in which it is interpreted.
In this paper, we have identified several new minimal undecidable logics amongst the fragments of Halpern-Shoham logic HS, including the logic of the overlaps relation alone, over the classes of all and finite linear orders, as well as the logic of the meet and subinterval relations, over the class of dense linear orders.
These, together with previously obtained undecidability results, delineate quite sharply the border of the dark side of interval temporal logics.
1.
Introduction Temporal reasoning plays a major role in computer science.
In the most standard approach, the basic temporal entities are time points and temporal domains are represented as ordered structures of time points.
The interval reasoning approach adopts another, arguably more natural perspective on time, according to which the primitive ontological entities are time intervals instead of time points.
The tasks of representing and reasoning about time intervals arises naturally in various fields of computer science, artificial intelligence, and temporal databases, such as theories of action and change, natural language processing, and constraint satisfaction problems.
Temporal logics with interval-based semantics have also been proposed as a useful formalism for the specification and verification of hardware [19] and of real-time systems [11].
Interval temporal logics feature modal operators that correspond to (binary) relations between intervals usually known as Allen's relations [1].
In [13], Halpern and Shoham introduce a modal logic for reasoning about inter-  val structures (HS), with a modal operator for each Allen's relation.
This logic, which we denote as HS, turns out to be undecidable under very weak assumptions on the class of interval structures [13].
In particular, undecidability holds for any class of interval structures over linear orders that contains at least one linear order with an infinite ascending (or descending) sequence of points, thus including the natural time flows N, Z, Q, and R. For a long time, such a sweeping undecidability result have discouraged attempts for practical applications and further research on interval logics.
A renewed interest in the area has been recently stimulated by the discovery of some interesting decidable fragments of HS [6, 7, 8, 9, 10].
Gradually, the quest for expressive decidable fragments of HS has become one of the main points of the current research agenda for (interval) temporal logic.
In this quest, many fragments of HS have already been shown to be undecidable [3, 4, 5, 16].
The main aim of this paper is to contribute to the delineation of the boundary between decidability and undecidability of the satisfiability problem for HS fragments, by establishing new undecidability results.
In particular, here we exhibit the first known case of a single-modality fragment of HS which is undecidable in the class of all linear orders, as well as in the class of all finite linear orders, thus also strengthening our previous results [4, 5].
Besides, most undecidability proofs given so far exploit the existence of a linear ordering with an infinite (ascending or descending) sequence of points; here we show how this assumption can be relaxed.
For lack of space, proofs are omitted or only sketched1 .
Details of the proofs and a complete picture of the state of the art about the classification of HS fragments with respect to the satisfiability problem can be found in [12].
On the web page http: //itl.dimi.uniud.it/content/logic-hs, it is also possible to run a collection of web tools, allowing one to verify the status (decidable/undecidable/unknown) of any fragment with respect to the satisfiability problem, over various classes of linear orders (all, dense, discrete, and finite).
1 In  the submitted version they are put in a technical appendix.
2.
Preliminaries Let D = hD, <i be a linearly ordered set.
An interval over D is an ordered pair [a, b], where a, b [?]
D and a <= b. Intervals of the type [a, a] are called point intervals; if these are excluded, the resulting semantics is called strict interval semantics (non-strict otherwise).
Our results hold in either semantics.
There are 12 different non-trivial relations (excluding the equality) between two intervals in a linear order, often called Allen's relations [1]: the six relations depicted in Table 1 and their inverse relations.
One can naturally associate a modal operator hXi with each Allen's relation RX .
For each operator hXi, we denote by hXi its transpose, corresponding to the inverse relation.
Halpern and Shoham's logic HS is a multi-modal logic with formulae built over a set AP of propositional letters, the propositional connectives [?]
and !, and a set of modal unary operators associated with all Allen's relations.
For each subset {RX1 , .
.
.
, RXk } of these relations, we define the HS fragment X1 X2 .
.
.
Xk , whose formulae are defined by the grammar: ph ::= p | p | !ph | ph [?]
ph | hX1 iph | .
.
.
| hXk iph, where p is a modal constant, true precisely at point intervals.
We omit p when it is definable in the language or when the strict semantics is adopted.
The other propositional connectives, like [?]
and -, and the dual modal operators [X] are defined as usual, e.g., [X]ph [?]
!hXi!ph.
The semantics of an interval-based temporal logic is given in terms of interval models M = hI(D), V i, where I(D) is the set of all intervals over D and the valuation function V : AP 7- 2I(D) assigns to every p [?]
AP the set of intervals V (p) over which it holds.
The truth of a formula over a given interval [a, b] in a model M is defined by structural induction on formulae: * M, [a, b]  p iff a = b; * M, [a, b]  p iff [a, b] [?]
V (p), for all p [?]
AP; * M, [a, b]  !ps iff it is not the case that M, [a, b]  ps; * M, [a, b]  ph [?]
ps iff M, [a, b]  ph or M, [a, b]  ps; * M, [a, b]  hXi ips iff there exists an interval [c, d] such that [a, b] RXi [c, d], and M, [c, d]  ps, Satisfiability is defined as usual.
The notion of sub-interval (contains) can be declined into two variants, namely, proper sub-interval ([a, b] is a proper sub-interval of [c, d] if c <= a, b <= d, and [a, b] 6= [c, d]), and strict sub-interval (when both c < a and b < d).
Both variants will play a central role in our technical results; notice that by sub-interval we usually mean the proper one.
3.
Brief summary of undecidability results In this section, we first briefly summarize and reference the main undecidability results for fragments of HS.
Then,  a hAi  [a, b]RA [c, d] = b = c  hLi  [a, b]RL [c, d] = b < c  hBi  [a, b]RB [c, d] = a = c, d < b  hEi  [a, b]RE [c, d] = b = d, a < c  hDi  [a, b]RD [c, d] = a < c, d < b  hOi  [a, b]RO [c, d] = a < c < b < d  b c  d c  d  c d c d c  d c  d  Table 1.
Allen's interval relations and the corresponding HS modalities.
we state the main results of this paper, extending the previous ones in two directions: (i) we prove a number of new undecidability results for proper sub-fragments of logics that had already been shown to be undecidable, and (ii) we show how to adapt various undecidability proofs to a more general class of linear orders.
The first undecidability result, for full HS, was obtained in the original paper by Halpern and Shoham [13].
Since then, several other results have been published, starting from Lodaya [15], that proved the undecidability of the fragment BE, when interpreted over dense linear orders, or, alternatively, over ho, <i, where infinite intervals are allowed.
In [3], Bresolin at al.
proved the undecidability of a number of interesting fragments, such as AD* E* , AD* O, AD* B* , AD* O, BE, BE, and BE, where, for each X [?]
{A, L, B, E, D, O}, X* denotes either X or X.
In [4], the undecidability of all (HS-)extensions of the fragment O (and thus of O), except for those with the modalities hLi and hLi, has been proved when interpreted in any class of linear orders with at least one infinite ascending (or descending) sequence.
In [5], the one-modality fragment O alone has been proved undecidable, but assuming discreteness.
Recently, Marcinkowski et al.
have first shown the undecidability of B* D* on discrete and on finite linear orders [17], and, then, strengthened that result to the one-modality fragments D and D [16].
Here, we extend and complete the results from [4, 5], by providing an undecidability proof that assumes neither discreteness nor the presence of any infinite ascending or descending sequence.
Second, we claim that all other undecidability proofs for HS-fragments that required infinity of the structures (i.e., A* D* , B* E* ), appeared in detail in [12] for specific cases, can actually be relaxed in a similar way and, thus, generalized.
As a consequence, we depict a very sharp decidability/undecidability border for the family of HS-fragments, as the undecidability for the mentioned logics holds over the class of all finite linear orders as well as over the classical orders based on N, Z- , Z, Q, and R.  Theorem 3.1.
The satisfiability problem for the HS fragments O, O, A* D* , B* E* is undecidable in any class of linear orders that contains, for each n > 0, at least one linear order with length greater than n. In summary, as far as the (un)decidability classification is concerned, the above theorem leaves as open only one more problem, namely, the decidability/undecidability status of D and/or D in the class of all linear orders, which cannot be trivially derived neither from the undecidability in the finite and discrete cases, nor from the decidability in the dense case [18].
Due to space constraints we only show in detail the case of O.
First, we show how to relax the discreteness hypothesis, and, then, we provide the necessary changes required to relax also the hypothesis of having at least one infinite sequence in the model.
We refer the reader to [12] for full details.
4.
Undecidability of O 4.1.
Intuition As in [4, 5], our undecidability proof is based on a reduction from the so-called Octant Tiling Problem (OTP).
This is the problem of establishing whether a given finite set of tile types T = {t1 , .
.
.
, tk } can tile the second octant of the integer plane O = {(i, j) : i, j [?]
N [?]
0 <= i <= j}.
For every tile type ti [?]
T , let right(ti ), lef t(ti ), up(ti ), and down(ti ) be the colors of the corresponding sides of ti .
To solve the problem, one must find a function f : O - T such that right(f (n, m)) = lef t(f (n + 1, m)) and up(f (n, m)) = down(f (n, m + 1)).
By exploiting an argument similar to the one used in [2] to prove the undecidability of the Quadrant Tiling Problem, it can be shown that the Octant Tiling Problem is undecidable too.
Given an instance OT P (T ), where T is a finite set of tiles types, we build an O-formula PhT in such a way that PhT is satisfiable if and only if T tiles O.
The proof is structured as follows.
First, we focus on the (sub)set G[a,b] of all and only those intervals that are reachable in the language of O from a given starting interval [a, b], by defining a suitable global operator [G].
Then, we set the tiling framework by forcing the existence of a unique infinite chain of u-intervals (i.e., intervals satisfying a designated proposition u) on the underlying linear ordering; the elements of such u-chain will be used as cells to arrange the tiling, and we will define in the language a derived modality to capture exactly the next u-interval from the current one.
Third, we encode the octant by means of a unique infinite sequence of Id-intervals (Idchain), each one of them representing a row of the octant.
An Id-interval is composed by a sequence of u-intervals; each u-interval is used either to represent a part of the plane  or to separate two consecutive rows; in the former case it is labelled with tile, while in the latter case it is labelled with *; fourth, by setting suitable propositions, we encode the above-neighbor and right-neighbor relations, which connect each tile in a row of the octant with, respectively, the one immediately above it and the one immediately at its right, if any.
The encoding of such relations must be done in such a way to respect the commutativity property (Def.
4.1 below).
Throughout, if two tiles t1 and t2 are connected by the above-neighbor (resp., right-neighbor) relation, we say that t1 is above-connected (resp., right-connected) to t2 , and similarly for tile-intervals (when they encode tiles of the octant that are above- or right-connected, respectively).
Definition 4.1 (commutativity property).
Given two tileintervals [c, d] and [e, f ], if there exists a tile-interval [d1 , e1 ], such that [c, d] is right-connected to [d1 , e1 ] and [d1 , e1 ] is above-connected to [e, f ], then there exists also a tile-interval [d2 , e2 ] such that [c, d] is above-connected to [d2 , e2 ] and [d2 , e2 ] is right-connected to [e, f ].
4.2.
Technical details in the infinite case Let [a, b] be any interval of length at least 2 (i.e., such that there exists at least one point c with a < c < b).
We define G[a,b] as the set of all and only those intervals [c, d] of length at least 2 such that c > a, d > b.
Accordingly, the modality [G] defined as [G]p [?]
p [?]
[O]p [?]
[O][O]p refers to all, and only those intervals that are in G[a,b] .
Because all formulae that we will use in the encoding will be prefixed with hOi, [O], or [G], hereafter we only refer to intervals in G[a,b] ; all others will be irrelevant.
Definition of the u-chain.
The definition of the u-chain is the most difficult step in our construction, due to the extreme weakness of the language.
It involves three, related, aspects: (i), the existence of an infinite sequence of u-intervals [b0 , b00 ], [b1 , b01 ], .
.
.
, [bi , b0i ], .
.
., with b <= b0 and b0i = bi+1 for each i [?]
N; the existence of an interleaved auxiliary chain [c0 , c00 ], [c1 , c01 ], .
.
.
, [ci , c0i ], .
.
., where bi < ci < b0i , bi+1 < c0i < b0i+1 , and c0i = ci+1 for each i [?]
N, composed by k-intervals (each one of them overlapping exactly one u-chain), used to make it possible for us to reach the 'next' u-interval from the current one (see Fig.
1); (iii) guaranteeing that both chains are unique.
This third aspect is the most difficult one.
To obtain uniqueness, we show that under certain conditions, the language of O can express properties of proper sub-intervals; in particular, we show that whenever p is a so-called disjointly-bounded proposition (see Def.
4.3 below), it is possible to express properties such as "for each interval [a, b], if [a, b] satisfies p then no proper sub-interval of [a, b] satisfies p".
Let M be a model over the set AP of propositional letters - hereafter called just 'propositions', for short - and let  u2 , k1 , and k2 to be disjointly-bounded.
b0 u b1 u b2 u b3 u b4 u b5 u b6 u b7 k  c0  k  c1  k  c2  k  c3  k  c4  k  c5  k  c6  c7  !u [?]
!k [?]
[O](!u [?]
!k) [G]((u - u1 [?]
u2 ) [?]
(k - k1 [?]
k2 )  Figure 1.
Encoding of the u-chain.
[?]
(u1 - !u2 ) [?]
(k1 - !k2 ))  (4) (5)  [G]((u1 - [O](!u [?]
!k2 ))[?
](u2 - [O](!u [?]
!k1 ))) (6) [a, b] be our starting interval (which automatically defines the universe G[a,b] ).
Definition 4.2.
The propositions p, q [?]
AP are said to be disjoint if, for every pair of intervals h[c, d], [e, f ]i such that [c, d] satisfies p and [e, f ] satisfies q, either d <= e or f <= c. The proposition q is called disjoint consequent of p if p and q are disjoint and any p-interval is followed by a q-interval, that is, for each interval [c, d] [?]
G[a,b] that satisfies p, there exists an interval [e, f ] [?]
G[a,b] , with e >= d, that satisfies q.
Definition 4.3.
The proposition p is said to be disjointlybounded in G[a,b] (w.r.t.
a disjoint consequent q) if: (i) [a, b] neither satisfies p nor overlaps a p-interval, that is, p (possibly) holds only over intervals [c, d], with c >= b; (ii) p-intervals do not overlap each other, that is, there exist not two intervals [c, d] and [e, f ] satisfying p and such that c < e < d < f ; (iii) p has a disjoint consequent q.
[G]((k1 - [O](!k [?]
!u1 ))[?
](k2 - [O](!k [?]
!u2 ))) (7) [G]((hOiu1 - !hOiu2 ) [?]
(hOik1 [?]
!hOik2 )) [G]((u1 - hOik1 ) [?]
(k1 - hOiu2 ) [?]
(u2 - hOik2 ) [?]
(k2 - hOiu1 )) (4) [?]
.
.
.
[?]
(9)  - [G](p - [O](hOiq - - p )) - [G](!p [?]
[O](hOiq - - p ) - insidep )  (2)  [G]((insidep - !hOip) [?]
(p - !hOiinsidep ))  (3)  (1)  Lemma 4.4.
Let M be a model, [a, b] be an interval over M , and p, q [?]
AP two propositions such that p is disjointly-bounded in G[a,b] w.r.t.
q.
If M, [a, b]  (1) [?]
(2) [?]
(3), then, in G[a,b] , there are no p-intervals properly contained in other p-intervals.
From now on, for any given disjointly-bounded proposition p, we will use non-sub(p) to denote the (global) property that no p-interval is sub-interval of another p-interval.
By means of the following formulae, we force the letter u1 ,  (9) (10)  Lemma 4.5.
Let M be a model, and [a, b] and interval over M such that M, [a, b]  (10).
Then u1 , u2 , k1 , and k2 are disjointly-bounded.
Thanks to the above lemma, we are justified to use the formulae non-sub(u1 ), non-sub(u2 ), non-sub(k1 ), non-sub(k2 ).
Finally, to build the u-chain, we state the following formulae.
hOihOi(u1 [?]
first)  Now, whenever we can prove that a certain proposition p is is disjointly-bounded in G[a,b] w.r.t.
a disjoint consequent q, we may set an auxiliary proposition insidep in such a way that it is true over all proper sub-intervals (in G[a,b] ) of p-intervals; after that, by simply asserting that insidep intervals and p-intervals cannot overlap each other, we will be able to guarantee that p-intervals are never proper subintervals of other p-intervals.
To define insidep for the (disjointly bounded) letter p, we exploit the existence of its dis- joint consequence q, plus an auxiliary proposition - p , which we make true over a suitable subset of interval starting inside a p-interval and ending outside it.
(8)  (11)  [G](u [?]
k - [O]!first [?]
[O][O]!first)  (12)  [G]((first - u1 ) [?]
(first - [O][O]!first))  (13)  non-sub(u1 ) [?]
non-sub(u2 ) [?]
non-sub(k1 ) [?]
non-sub(k2 ) (14)  [G](u [?]
k - [O]hOi(u [?]
k))  (15)  (11) [?]
.
.
.
[?]
(15)  (16)  Lemma 4.6.
Let M be a model and [a, b] and interval over M such that M, [a, b]  (10) [?]
(16).
Then: (a) there exists an infinite sequence of u-intervals [b0 , b00 ], [b1 , b01 ], .
.
.
, [bi , b0i ], .
.
., with b <= b0 , b0i = bi+1 for each i [?]
N, and such that M, [b0 , b00 ]  first, (b) there exists an infinite sequence of k-intervals [c0 , c00 ], [c1 , c01 ], .
.
.
, [ci , c0i ], .
.
.
such that bi < ci < b0i , bi+1 < c0i < b0i+1 , and c0i = ci+1 for each i [?]
N, and (c) every other interval [c, d] [?]
G[a,b] satisfies neither of u, k, or first, unless c > bi for every i [?]
N. Within this framework, an operator hXu i, used to step from any given u-interval to the next one in the sequence, becomes now definable: hXu iph [?]
(!u[?]hOihOi(first[?]ph))[?](u[?]hOi(k[?]hOi(u[?
]ph))) Definition of the Id-chain.
In order to define the Id-chain,  we make use of the following set of formulae:  a) (17)  bw t15 t25 t35 t45 t55 fw t14 t24 t34 t44  (18)  bw t13 t23 t33 fw t12 t22  [G]((u - * [?]
tile) [?]
(* - !tile))  (19)  bw t11  [G](* - hOi(k [?]
hOiId))  (20)  [G](Id - hOi(k [?]
hOi*))  (21)  [G]((u - !hOiId) [?]
(Id - !hOiu))  (22)  [G](hOi* - !hOiId)  (23)  non-sub(Id)  (24)  (17) [?]
.
.
.
[?]
(24)  (25)  !Id [?]
!hOiId [?]
[G](Id - !hOiId) hXu i(* [?]
hXu i(tile [?]
Id [?]
hXu i* [?]
[G](* - hXu i(tile [?]
hXu itile))))  Lemma 4.7.
Let M, [a, b]  (10) [?]
(16) [?]
(25) and let b <= b01 < c01 < b11 < .
.
.
< bk11 -1 < ck11 -1 < bk11 = b02 < c02 = ck11 < b12 < .
.
.
< bk22 = b03 < .
.
.
be the sequence of points, defined by Lemma 4.6, such that [bij , bi+1 j ] satisfies u and [cij , ci+1 ] satisfies k for each j >= 1, 0 <= i < kj .
Then, j for each j >= 1, we have: (a) M, [b0j , b1j ]  *; (b) M, [bij , bi+1 j ]  tile for each 0 < i < kj ; (c) M, [b1j , b0j+1 ]  Id; (d) k1 = 2, kl > 2 for each l > 1; and no other interval [c, d] [?]
G[a,b] satisfies * (resp., tile, Id), unless c > bij for each i, j > 0.
Above-neighbor relation.
We proceed now with the encoding of the above-neighbor relation (Fig.
2), by means of which we connect each tile-interval with its vertical neighbor in the octant (e.g., t22 with t23 in Fig.
2).
For technical reasons, we need to distinguish between backward and forward rows of O using the propositions bw and fw: we label each u-interval with bw (resp., fw) if it belongs to a backward (resp., forward) row (formulae (26)-(27)).
Intuitively, the tiles belonging to forward rows of O are encoded in ascending order, while those belonging to backward rows are encoded in descending order (the tiling is encoded in a zig-zag manner).
In particular, this means that the left-most tile-interval of a backward level encodes the last tile of that row (and not the first one) in O.
Let a, b [?]
{bw, fw}, with a 6= b: hXu ibw [?]
[G]((u - bw [?]
fw) [?]
(bw - !fw))  (26)  [G]((a[?
]!hXu i* - hXu ia)[?](a[?
]hXu i* - hXu ib)) (27) (26) [?]
.
.
.
[?]
(27)  (28)  Lemma 4.8.
If M, [a, b]  (10) [?]
(16) [?]
(25) [?]
(28), then the sequence of points defined in Lemma 4.7 is such that M, [bij , bi+1 j ]  bw if and only if j is an odd number, and M, [bij , bi+1 j ]  fw if and only j is an even number.
Furthermore, we have that no other interval [c, d] [?]
G[a,b] satisfies bw or fw, unless c > bij for each i, j > 0.  b) z bw }| {z last  fw }|  {z last  bw }| last  {z  fw }|  { last  1 1 2 3 2 1 1 2 3 4 * t1 * t2 t2 * t3 t3 t3 * t4 t4 t4 t4  Figure 2.
Encoding of the above-neighbor relation.
We make use of such an alternation between backward and forward rows to use the operator hOi in order to correctly encode the above-neighbor relation.
We constrain each up rel-interval starting from a backward (resp., forward) row not to overlap any other up rel-interval starting from a backward (resp., forward) row.
The structure of the encoding is shown in Fig.
2, where up rel-intervals starting inside forward (resp., backward) rows are placed one inside the other.
Consider, for instance, how the 3rd and 4th level of the octant are encoded in Fig.
2b.
The 1st tile-interval of the 3rd level (t33 ) is connected to the second from last tile-interval of the 4th level (t34 ), the 2nd tile-interval of the 3rd level (t23 ) is connected to the third from last tile-interval of the 4th level (t24 ), and so on.
Notice that, in forward (resp., backward) level, the last (resp., first) tile-interval has no tile-intervals above-connected to it, in order to constrain each level to have exactly one tile-interval more than the previous one (these tile-intervals are labeled with last).
Formally, we define the above-neighbor relation as follows.
If [bij , bi+1 j ] is a tile-interval belonging to a forward (resp., backward) row, then we say that it is abovej+2-i+1 connected to the tile-interval [bj+2-i ] (resp., j+1 , bj+1 j+2-i-1 j+2-i [bj+1 , bj+1 ]).
To do so, we label with up rel the j+2-i j+2-i-1 interval [cij , cj+1 ] (resp., [cij , cj+1 ]).
Moreover, we distinguish between up rel-intervals starting from forward and backward rows and, within each case, between those starting from odd and even tile-intervals.
To this end, we bw use a new proposition, namely, up relbw o (resp., up rele , fw fw up relo , up rele ) to label up rel-intervals starting from an odd tile-interval of a backward row (resp., even tileinterval/backward row, odd/forward, even/forward).
Moreover, to ease the reading of the formulae, we group up relbw o bw bw and up relbw (up relbw - up relbw e in up rel o [?]
up rele ), and similarly for up relfw .
Finally, up rel is exactly  one among up relbw and up relfw (up rel - up relbw [?]
up relfw ).
In such a way, we encode the correspondence between tiles of consecutive rows of the plane induced by the above-neighbor relation.
Let a, b [?]
{bw, fw} and g, d [?]
{o, e}, with a 6= b and g 6= d:  lae (46)-(49)): [G](tile - hOiup rel)  (38) a  [G](a - [O](up rel - up rel )) [G](up rel - hOib)  (40) bw  [G](hOi* - !
(hOiup rel  !up rel [?]
!hOiup rel  (29)  [G]((up rel - up relbw [?]
up relfw ) a  [?]
(up rel - up  rela o  [?]
up  rela e ))  [G]((k [?]
* - !hOiup rel) [?]
(up rel - !hOik))  (30) (31)  a b [G](u [?]
hOiup rela g - !hOiup reld [?]
!hOiup rel ) (32)  [G](up rela - !hOiup rela )  (33)  [G](up rel - hOiId)  (34)  [G](hOiup rel - !hOifirst) [G](up  rela g  - hOi(tile [?]
hOiup  (29) [?]
.
.
.
[?]
(36)  (35) relbg ))  (36) (37)  (39)  a  [G](tile [?]
hOiup  rela g  fw  [?]
hOiup rel ))  (41)  [?]
hXu itile  (42)  - hXu i(tile [?]
hOiup rela d )) [G](last - tile)  (43)  [G]((* [?]
bw - hXu ilast) [?]
(fw [?]
hXu i* - last)) (44) [G]((last [?]
fw - hXu i*) [?]
(bw [?]
hXu ilast - *)) (45) [G](* [?]
fw - hXu i(tile  (46)  [?]
hOi(up rel [?]
hOi(tile [?]
hXu i*)))) [G](last [?]
bw - hOi(up rel  (47)  [?]
hOi(tile [?]
hXu i(tile [?]
hXu i*)))) [G](k [?]
hOi(tile [?]
hOiup rela g) - [O](hOiup rela g [?]
hOi(k [?]
hOi(tile  Lemma 4.9.
If M, [a, b]  (10) [?]
(16) [?]
(25) [?]
(28) [?]
(37), then the sequence of points defined in Lemma 4.7 is such that, for each i >= 0, j > 0, the following properties hold: 0 a) if [c, d] satisfies up rel, then c = cij and d = cij 0 for 0 0 some i, i , j, j > 0; that is, each up rel-interval starts and ends inside a tile-interval.
More precisely, it starts (resp., ends) at the same point in which a k-interval starts (resp., ends); 0 b) [cij , cij 0 ] satisfies up rel if and only if it satisfies exactly 0 one between up relbw and up relfw and [cij , cij 0 ] satisfies up relbw (resp., up relfw ) if and only if it satisfies exbw actly one between up relbw o and up rele (resp., between fw fw up relo and up rele ); 0 c) for each a, b [?]
{bw, fw} and g, d [?]
{o, e}, if [cij , cij 0 ] a satisfies up relg , then there is no other interval starting b at cij satisfying up relbd such that up rela g 6= up reld ; bw fw d) each up rel -interval (resp., up rel -interval) does not overlap any other up relbw -interval (resp., up relfw interval); 0 bw fw e) if [cij , cij 0 ] satisfies up relbw o (resp., up rele , up relo , fw up relfw e ), then there exists an up relo -interval (resp., fw bw up rele -interval, up relo -interval, up relbw e -interval) 0 starting at cij 0 .
Now, we constrain each tile-interval, apart from the ones representing the last tile of some level, to have a tile-interval above-connected to it.
To this end, we label each tileinterval representing the last tile of some row of the octant with the new proposition last (formulae (43)-(45)).
Next, we force all and only those tile-intervals not labelled with last to have a tile-interval above-connected to them (formu-  [?]
hOiup  relbd  [?]
!last)) - hOiup  (48)  rela d ))  [G](up rel - !hOilast)  (49)  (38) [?]
.
.
.
[?]
(49)  (50)  Lemma 4.10.
If M, [a, b]  (10) [?]
(16) [?]
(25) [?]
(28) [?]
(37) [?]
(50), then the sequence of points defined in Lemma 4.7 is such that the following properties hold: 0 a) for each up rel-interval [cij , cij 0 ], connecting the tile0  0  i +1 i interval [bij , bi+1 j ] to the tile-interval [bj 0 , bj 0 ], if bw fw i i0 [cj , cj 0 ] satisfies up rel (resp., up rel ), then [bij , bi+1 j ] 0  0  satisfies bw (resp., fw) and [bij 0 , bij 0+1 ] satisfies fw (resp., bw); b) (strict alternation property) for each tile-interval [bij , bi+1 j ], with i < kj - 1, such that there exists an bw fw up relbw o -interval (resp., up rele -interval, up relo -infw i terval, up rele -interval) starting at cj , there exists bw fw an up relbw e -interval (resp., up relo -interval, up rele fw i+1 interval, up relo -interval) starting at cj ; c) for every tile-interval [bij , bi+1 j ] satisfying last, there is no up rel-interval ending at cij ; 0 d) for each up rel-interval [cij , cij 0 ], with 0 < i < kj , we have that j 0 = j + 1.
Lemma 4.11.
Each tile-interval [bij , bi+1 j ] is aboveconnected to exactly one tile-interval and, if it does not satisfy last, then there exists exactly one tile-interval which is above-connected to it.
Right-neighbor relation.
The right-neighbor relation connects each tile with its horizontal neighbor in the octant, if any (e.g., t23 with t33 in Fig.
2).
Again, in order to encode  the right-neighbor relation, we must distinguish between forward and backward levels: a tile-interval belonging to a forward (resp., backward) level is right-connected to the tile-interval immediately to the right (resp., left), if any.
For example, in Fig.
2b, the 2nd tile-interval of the 4th level (t24 ) is right-connected to the tile-interval immediately to the right (t34 ), since the 4th level is a forward one, while the 2nd tile-interval of the 3rd level (t23 ) is right-connected to the tile-interval immediately to the left (t33 ), since the 3rd level is a backward one.
Therefore, we define the right-neighbor relation as follows: if [bij , bi+1 j ] is a tile-interval belonging to a forward (resp., backward) Id-interval, with i 6= kj - 1 (resp., i 6= 1), then we say that it is right-connected to the i+2 i-1 i tile-interval [bi+1 j , bj ] (resp., [bj , bj ]).
Lemma 4.12 (Commutativity property).
If M, [a, b]  (10) [?]
(16) [?]
(25) [?]
(28) [?]
(37) [?]
(50), then the commutativity property holds over the sequence defined in Lemma 4.7.
Tiling the plane.
The following formulae constrain each tile-interval (and no other interval) to be tiled by exactly one tile (formula (51)) and constrain the tiles that are rightor above-connected to respect the color constraints (from (52) to (54)): [G]((  k _  k ^  ti - tile) [?]
(  i=1  !
(ti [?]
tj ))  (51)  i,j=1,i6=j  [G](tile -  _  Definition of the u-chain.
The main difference from the reduction of the octant tiling problem described in the previous section is the finiteness of the rectangular area.
This requires the existence of an arbitrarily long, but not infinite, u-chain.
Hence, we introduce an auxiliary propositions lastu to denote the last u-interval of the (finite) u-chain.
The properties of lastu are defined as follows.
hOihOilastu  (56)  [G](lastu - * [?]
[O](!u [?]
!k) [?]
[O][O](!u [?]
!k)) (57)  (ti [?]
hOi(up rel [?]
hOitj ))) (52)  up(ti )=down(tj )  [G](tile [?]
fw [?]
hXu itile -  _  (ti [?]
hXu itj )) (53)  right(ti )=lef t(tj )  [G](tile [?]
bw [?]
hXu itile -  _  (ti [?]
hXu itj )) (54)  lef t(ti )=right(tj )  (51) [?]
.
.
.
[?]
(54)  allow us to conclude that O is undecidable when interpreted in the class of all finite linear orders.
The Finite Tiling Problem is formally defined as the problem of establishing if a finite set of of tile types T , containing a distinguished tile type t$ (blank) with the same color on all sides, can tile the entire Z x Z plane, under the restriction that at least one, but only finitely many tiles are not blank.
This problem has been first introduced and shown to be undecidable in [14].
In this section we concentrate on an equivalent variation of it, defined as the problem of establishing if T can tile a finite rectangular area (of unknown size) whose edges are colored by blank, using at least one non-blank tile.
Indeed, if this is the case then we can extend the tiling to the entire plane by putting the blank tile on all the remaining cells.
Conversely, if we can tile the entire plane using only finitely many non-blank tiles, then we can identify a finite rectangular portion of it containing all non-blank tiles and whose edges are blank.
(55)  Given the set of tile types T = {t1 , t2 , .
.
.
, tk }, let PhT be the formula (10) [?]
(16) [?]
(25) [?]
(28) [?]
(37) [?]
(50) [?]
(55).
Lemma 4.13.
The formula PhT is satisfiable if and only if T can tile the second octant O.
4.3.
Extending undecidability to finite linear orders In this section, we show how to adapt the construction of the previous section in order to encode the Finite Tiling Problem.
This provides us with an undecidability proof for the fragment O that works in any class of strongly discrete linear orders - that is, linear orders satisfying the property that every interval contains only finitely many points - that contains arbitrarily (finitely) long orders.
In particular, this  Now, we analyze the formulae used in the previous section, showing only those that need to be changed for the finite case.
Formula (9) is replaced by (58) in order to guarantee the existence of the u- and k-chains.
[G]((u1 [?]
!lastu - hOik1 ) [?]
(k1 - hOiu2 ) [?]
(u2 [?]
!lastu - hOik2 ) [?]
(k2 - hOiu1 ))  (58)  Since u1 - and u2 -intervals (resp., k1 - and k2 -intervals) do not infinitely alternate with each other in the finite case, we introduce the new proposition cons, and we force it to be a disjoint consequent of u and k. In this way, we can force u1 , u2 , k1 , and k2 to be disjointly-bounded.
!cons [?]
[O]!cons [?]
[G](u [?]
k - hOihOicons)  (59)  [G](hOiu [?]
hOik - !hOicons)  (60)  [G]((u [?]
k - !hOicons) [?]
(cons - [O](!u [?]
!k))) (61) Finally, we replace formula (15) with (62).
[G](u [?]
k - [O](hOihOilastu - hOi(u [?]
k)))  (62)  Notice that formulae (56), .
.
.
, (62) guarantees the existence of the u-chain also when interpreted over arbitrary linear orders, but that the strong discreteness assumption is  crucial to guarantee the finiteness of the chain.
As a counterexample, consider the model over Q depicted in Figure 3, 1 ] such where u1 holds over every interval [2 - 21n , 2 - 2n+1 1 1 ] that n is even, u2 holds over every interval [2- 2n , 2- 2n+1 such that n is odd, the sequence of k1 - and k2 -intervals are defined consistently, and lastu holds over the interval [2, 2 + 21 ].
Such a model satisfy formulae (56), .
.
.
, (62), but contains an infinite u-chain.
k1 u1  u2 1 2  1  k2 k1  u1 , lastu  u1 3 4  7 8  2  2+  1 2  Figure 3.
Infinite u-chain counterexample.
Definition of the Id-chain.
To guarantee that Id is a disjointly-bounded proposition, we exploit the fact that, by definition, cons is also a disjoint consequent of Id.
Moreover, as for the u-chain, we have to make sure that the chain is finite: to this end, we introduce the proposition lastId to denoting the last Id-interval of the (finite) Id-chain.
[G]((lastId - Id)[?](Id[?]hOi(k[?
]hOilastu ) - lastId )) (63) Finally, we redefine formulae (18) and (20) as follows.
hXu i * [?
][G](* - hXu itile)  (64)  [G](* [?]
!lastu - hOi(k [?]
hOiId))  (65)  Above-neighbor relation.
In the finite case, every row has exactly the same number of tiles; therefore, the formulae (43), (44), (45), (47), and (49) can be dismissed.
Formulae (36), (38), and (48) are replaced by the following ones.
[G](up rela g - (hOitile [?]
(hOihOi(* [?]
!lastu ) - hOi(tile [?]
hOiup relbg )))) [G](tile [?]
hOihOi(* [?]
!lastu ) - hOiup rel) [G](k [?]
hOi(tile [?]
hOiup [?]
hOiup  (67)  rela g)  - [O](hOiup rela g [?]
hOi(k [?]
hOi(tile relbd ))  (66)  - hOiup  (68)  rela d ))  Finally, it is not difficult to complete the construction by adding the color constraints on the border of the region and the existence of at least one non-blank tile.
Therefore, undecidability of O is proven also for finite linear orders.
References [1] J. F. Allen.
Maintaining knowledge about temporal intervals.
Communications of the ACM, 26(11):832-843, 1983.
[2] E. Borger, E. Gradel, and Y. Gurevich.
The Classical Decision Problem.
Springer, 1997.
[3] D. Bresolin, D. Della Monica, V. Goranko, A. Montanari, and G. Sciavicco.
Decidable and Undecidable Fragments of Halpern and Shoham's Interval Temporal Logic: Towards a Complete Classification.
In Proc.
of LPAR'08, volume 5330 of LNCS, pages 590-604.
Springer, 2008.
[4] D. Bresolin, D. Della Monica, V. Goranko, A. Montanari, and G. Sciavicco.
Undecidability of Interval Temporal Logics with the Overlap Modality.
In Proc.
of TIME'09, pages 88-95.
IEEE Computer Society Press, 2009.
[5] D. Bresolin, D. Della Monica, V. Goranko, A. Montanari, and G. Sciavicco.
Undecidability of the logic of Overlap relation over discrete linear orderings.
ENTCS, 262:65 - 81, 2010.
Proc.
of M4M-6, 2009.
[6] D. Bresolin, V. Goranko, A. Montanari, and P. Sala.
Tableaux for logics of subinterval structures over dense orderings.
J. of Logic and Computation, 20:133-166, 2010.
[7] D. Bresolin, V. Goranko, A. Montanari, and G. Sciavicco.
Propositional interval neighborhood logics: Expressiveness, decidability, and undecidable extensions.
Annals of Pure and Applied Logic, 161(3):289-304, 2009.
[8] D. Bresolin, A. Montanari, and P. Sala.
An optimal tableaubased decision algorithm for Propositional Neighborhood Logic.
In Proc.
of STACS'07, volume 4393 of LNCS, pages 549-560.
Springer, 2007.
[9] D. Bresolin, A. Montanari, P. Sala, and G. Sciavicco.
Optimal Tableaux for Right Propositional Neighborhood Logic over Linear Orders.
In Proc.
of JELIA'08, volume 5293 of LNAI, pages 62-75.
Springer, 2008.
[10] D. Bresolin, A. Montanari, and G. Sciavicco.
An optimal decision procedure for Right Propositional Neighborhood Logic.
J. of Automated Reasoning, 38(1-3):173-199, 2007.
[11] Z. Chaochen, C. A. R. Hoare, and A. P. Ravn.
A calculus of durations.
Inf.
Processing Letters, 40(5):269-276, 1991.
[12] D. Della Monica.
Expressiveness, decidability, and undecidability of Interval Temporal Logic.
PhD thesis, University of Udine, 2011.
Available at: http: //www.dia.unisa.it/dottorandi/dario.
dellamonica/pubs/thesis/phd_thesis.pdf.
[13] J. Halpern and Y. Shoham.
A propositional modal logic of time intervals.
Journal of the ACM, 38(4):935-962, 1991.
[14] J. Kari.
Reversibility and surjectivity problems of cellular automata.
Journal of Computer Systems and Science, 48:149-182, 1994.
[15] K. Lodaya.
Sharpening the undecidability of interval temporal logic.
In Proc.
of ASIAN'00, volume 1961 of LNCS, pages 290-298.
Springer, 2000.
[16] J. Marcinkowski and J. Michaliszyn.
The ultimate undecidability result for the Halpern-Shoham logic.
Proc.
of LICS'11, 2011.
[17] J. Marcinkowski, J. Michaliszyn, and E. Kieronski.
B and D are enough to make the Halpern-Shoham logic undecidable.
In Proc.
of ICALP'10 - Part II, volume 6199 of LNCS, pages 357-368, July 2010.
[18] A. Montanari, G. Puppis, and P. Sala.
A decidable spatial logic with cone-shaped cardinal directions.
In Proc.
of CSL'09, volume 5771 of LNCS, pages 394-408, 2009.
[19] B. Moszkowski.
Reasoning about digital circuits.
Tech.
rep. stan-cs-83-970, Dept.
of Computer Science, Stanford University, Stanford, CA, 1983.
A.
Proof details A.1.
Proof of Lemma 4.4 Proof.
Suppose, by contradiction, that there exist two intervals [c, d] and [e, f ] (belonging to G[a,b] ) satisfying p and such that [e, f ] is sub-interval of [c, d].
By definition of subinterval, we have that c < e or f < d. Without loss of generality, let us suppose that c < e (the other case is analogous).
Since [e, f ] [?]
G[a,b] , then there exists a point in between e and f , say it e0 .
The interval [c, e0 ] is a sub-interval of [c, d].
Moreover, it cannot satisfy p, since it overlaps the p-interval [e, f ] (and p is a propositional letter disjointlybounded in hM, [a, b]i).
By (1) and by the fact that q is a disjoint consequent of p, each interval starting in between - c and d, and ending inside a q-interval, satisfies - p .
Thus, - - 0 [c, e ] satisfies !p and [O](hOiq - p ).
By (2), it must also satisfy insidep .
But this contradicts (3), hence the thesis.
A.2.
Proof of Lemma 4.6 Proof.
For the sake of simplicity, we will first prove a variant of points (a) and (b), that is, respectively, (a') there exists an infinite sequence of u-intervals [b0 , b00 ], [b1 , b01 ], .
.
.
, [bi , b0i ], .
.
., with b <= b0 , b0i <= bi+1 for each i [?]
N, and such that M, [b0 , b00 ]  first, (b') there exists an infinite sequence of k-intervals [c0 , c00 ], [c1 , c01 ], .
.
.
, [ci , c0i ], .
.
.
such that bi < ci < b0i , bi+1 < c0i < b0i+1 , and c0i <= ci+1 for each i [?]
N. Then, we will prove point (c).
Finally, we will force b0i = bi+1 and c0i = ci+1 for each i [?]
N, actually proving the original version of points (a) and (b).
As for the proof of points (a') and (b'), it is simple to see that formulae (4), (5), (6), (7), (9), and (11) are enough to guarantee the existence of the u- and k-chains with the desired properties.
We must show, now, that each other interval satisfies neither u nor k. As a preliminary step, it is useful to show that an u-interval (resp., k-interval) belonging to G[a,b] cannot be sub-interval of u-intervals or k-intervals.
Formula (8) guarantees that it cannot exist an u1 -interval (resp., k1 -interval) that is sub-interval of an u2 interval (resp., k2 -interval) or, vice versa, an u2 -interval (resp., k2 -interval) that is sub-interval of an u1 -interval (resp., k1 -interval).
Moreover, since, by Lemma 4.5, u1 , u2 , k1 , and k2 are disjointly bounded, then (14) guarantees that no u1 -interval (resp., u2 -interval, k1 -interval, k2 interval) can be sub-interval of another u1 -interval (resp., u2 -interval, k1 -interval, k2 -interval).
So far, we have shown that no u-interval (resp., k-interval) can be sub-interval of any u-interval (resp., k-interval).
It remains to show that no u-interval can be sub-interval of any k-interval, and vice versa.
Suppose, by contradiction, that the u-interval [c0 , d0 ]  is sub-interval of the k-interval [c00 , d00 ].
By (9), there must exist a k-interval, say it [c000 , d000 ], starting in between c0 and d0 .
Then, we either have (i) d000 <= d00 and the k-interval [c000 , d000 ] is sub-interval of the k-interval [c00 , d00 ], contradicting the previous statement, or (ii) d000 > d00 and the k-interval [c00 , d00 ] overlaps the k-interval [c000 , d000 ], contradicting (7).
With a similar argument, one can show that no k-interval can be sub-interval of a u-interval.
Thus, we can state that u-intervals (resp., k-intervals) cannot be subintervals of u- or k-intervals.
Now, let us focus on the point (c) of the lemma.
Suppose, by contradiction, the existence of the u-interval [c, d], belonging to G[a,b] and such that [c, d] 6= [bi , b0i ] for any i [?]
N. By (4), it must be c >= b.
Now, let us distinguish the following cases: * if b <= c < b0 , then one of the following: - if d < b00 , then (12) is contradicted, - if d >= b00 , then the u-interval [b0 , b00 ] is subinterval of the u-interval [c, d], * if c = bi for some i [?]
N, then one of the following: - if d < b0i , then the u-interval [c, d] is sub-interval of the u-interval [bi , b0i ], - if d = b0i , then we are contradicting the hypothesis "per absurdum" that [c, d] 6= [bi , b0i ] for any i [?]
N, - if d > b0i , then the u-interval [bi , b0i ] is subinterval of the u-interval [c, d], * if bi < c < b0i for some i [?]
N, then one of the following: - if d <= b0i , then the u-interval [c, d] is sub-interval of the u-interval [bi , b0i ], - if d > b0i , then the u-interval [bi , b0i ] overlaps the u-interval [c, d], contradicting (6), * if b0i <= c < bi+1 for some i [?]
N, then one of the following: - if d <= bi+1 , then the u-interval [c, d] is subinterval of the k-interval [ci , c0i ], - if bi+1 < d < b0i+1 , then the u-interval [c, d] overlaps the u-interval [bi+1 , b0i+1 ], contradicting (6), - if d >= b0i+1 , then the u-interval [bi+1 , b0i+1 ] is sub-interval of the u-interval [c, d].
Thus, there cannot exist an u-interval [c, d] [?]
G[a,b] such that [c, d] 6= [bi , b0i ] for any i [?]
N. A similar argument can be exploited to prove that there cannot exist a k-interval [c, d] [?]
G[a,b] such that [c, d] 6= [ci , c0i ] for any i [?]
N. In addition, suppose, by contradiction, the existence of the interval [c, d], belonging to G[a,b] , satisfying first, and such that [c, d] 6= [b0 , b00 ].
By the first conjunct of (13), it must be [c, d] = [bi , b0i ] for some i [?]
N, with i 6= 0.
Thus, the second conjunct of (13) is contradicted.
Finally, suppose, by contradiction, that it is the case that b0i < bi+1 for some i [?]
N. By the previous argument, there must be bi , ci , c0i , b0i+1 such that bi < ci < b0i , bi+1 < c0i <  b0i+1 , and [ci , c0i ] satisfies k. By point (c), there cannot exist an u- or k-interval starting in between ci and bi+1 .
Then, the interval [bi , b0i ] contradicts (15), since it overlaps the interval [ci , bi+1 ] that, in turn, does not overlap any u- or k-interval.
Thus, it must be b0i = bi+1 for each i [?]
N. In a very similar way, it is possible to show that it must also be c0i = ci+1 for each i [?]
N.  A.3.
Proof of Lemma 4.7 Proof.
First of all, we show that Id is a disjointly-bounded propositional letter.
By (17), it is easy to see that Id meets the first two requirements of Definition 4.3.
By (22) and (23), * and Id are disjoint, and, by (21), * is a disjoint consequent of Id.
Thus, Id is a disjointly-bounded propositional letter.
The proof proceeds case by case.
(a) Observe that there exists an infinite sequence of *intervals, thanks to (18), (20), and (21).
Let us denote by [b01 , b11 ], [b02 , b12 ], .
.
.
, [b0j , b1j ], .
.
.
such a sequence.
By the first conjunct of (19), we can assume that, for each j > 0, there is no *-interval between [b0j , b1j ] and [b0j+1 , b1j+1 ].
(b) By (19), each interval satisfying * or tile is an u-interval and each u-interval satisfies either * or tile.
Then, the u-intervals between two consecutive *-intervals (if any) must be tile-intervals.
(c) By (20), for each k-interval [c0j , c1j ] overlapped by a *interval, there exists an Id-interval [c, d], with c0j < c < c1j < d. We show that c = b1j and d = b0j+1 .
Suppose that c < b1j .
Then, the u-interval [b0j , b1j ] overlaps the Id-interval [c, d], contradicting (22).
On the other hand, if c > b11 , then we distinguish two cases.
* j = 1.
In this case, by (18), we have that [b1j , b2j ] is the Id-interval representing the first level of the octant.
Now, if d > b21 , then the u-interval [b11 , b21 ] overlaps the Id-interval [c, d], contradicting (22); otherwise, if d <= b21 , then the Id-interval [c, d] is a sub-interval of the Id-interval [b11 , b21 ], contradicting (24) (recall that Id is a disjointly-bounded propositional letter).
* j > 1 ([b1j , b2j ] is not the last tile-interval of the jth level).
In this case, the k-interval [c1j , c2j ] does not overlap a *-interval (since [b2j , b3j ] is a tileinterval).
Thus, due to (21), it must be d > c2j , and the u-interval [b1j , b2j ] overlaps the Id-interval [c, d], contradicting (22).
Hence, it must be c = b1j .
Now, we have to show that d = b0j+1 , that is, the Id-interval starting immediately after the *-interval [b0j , b1j ] ends at the point in which the next *-interval starts.
Suppose, by contradiction, that d 6= b0j+1 .
Suppose that j = 1.
In this case, if d < b02 (resp., d > b02 ), then the Id-interval [c, d] (resp.,  [b11 , b21 ]) is a sub-interval of the Id-interval [b11 , b21 ] (resp., [c, d]), contradicting (24).
So, let us suppose j > 1, and consider the following cases: k -1 * if d <= cj j , then (21) is contradicted, since either [c, d] does not overlap any k-interval or it overlaps a k-interval that does not overlap any *interval; k -1 < d < b0j+1 , then the Id-interval [c, d] * if cj j k -1  k  overlaps the u-interval [bj j , bj j ], contradicting (22); * if b0j+1 < d < b1j+1 , then the Id-interval [c, d] overlaps the u-interval [b0j+1 , b1j+1 ], contradicting (22); * if d >= b1j+1 , then (23) is contradicted, since the interval [a0 , c0j+1 ], where a0 is a generic point in between a and b, overlaps both the *-interval [b0j+1 , b1j+1 ] and the up rel-interval [c, d].
Hence, it must be d = b0j+1 .
(d) By (18), it immediately follows that k1 = 2 and kl > 2 when l > 1.
Finally, suppose, by contradiction, that there exists an Idinterval [c, d] [?]
G[a,b] such that [c, d] 6= [b1j , b0j+1 ] for each j > 0 and that c <= bij for some i, j > 0.
By (17), the interval [a, b] neither satisfies Id nor overlaps an interval that satisfies Id, thus c >= b, and one of the following cases arise.
1.
If b <= c < b01 , then, by (21), it must be d > c01 , and (23) is contradicted.
2.
If b0j <= c < c0j for some j > 0, then (23) is contradicted.
3.
If c0j <= c < b1j for some j > 0, then, due to (21), it must be d > c1j and the u-interval [b0j , b1j ] overlaps the Id-interval [c, d], contradicting (22).
4.
If c = b1j for some j > 0, then we have already shown that it must be d = b0j+1 .
5.
If b1j < c < b0j+1 for some j > 0, then: (a) if d <= b0j+1 , then the Id-interval [c, d] is subinterval of the Id-interval [b1j , b0j+1 ], contradicting (24), (b) if d > b0j+1 , then the Id-interval [b1j , b0j+1 ] overlaps the Id-interval [c, d], contradicting (17).
The fact that no other interval [c, d] [?]
G[a,b] satisfies * or tile, unless c > bij for each i, j > 0 can be proved by a similar argument.
A.4.
Proof of Lemma 4.9 Proof.
We only proof point a), that is the less intuitive.
Let [c, d] be an up rel-interval.
First, we show that it must be 0 c = cij , for some i, j > 0.
Then, we prove that d = cij 0 , for 0 0 some i , j > 0.
Notice that we want to exclude also the case in which c = c0j (resp., d = c0j 0 ) for some j > 0 (resp., j 0 > 0), since this would imply the existence of an up rel-interval  starting (resp., ending) inside a *-interval.
This is done by means of (31) (first conjunct) and (36).
Now, we show that c = cij , for some i, j > 0.
By (29), it must be c >= b and, by (35) and (36), it follows c >= c01 .
Moreover, by (31) and (36), it cannot be the case that bij <= c < cij for any i >= 0, j > 0.
It only remains to exclude the case in which cij < c < bi+1 j for some i >= 0, j > 0.
Thus, suppose, by contradiction, that for some i >= 0, j > 0.
If d > ci+1 cij < c < bi+1 j j , then (31) is contradicted; otherwise, if d <= ci+1 , then, by (34), [c, d] j overlaps an Id-interval.
As a consequence, there should be i i+1 an Id-interval starting at bi+1 j , that means that [bj , bj ] is a *-interval.
This lead to a contradiction with (31), since the *-interval [bij , bi+1 j ] overlaps the up rel-interval [c, d].
Thus, we have that c = cij for some i, j > 0.
Now, we want to 0 prove that d = cij 0 for some i0 , j 0 > 0.
It is easy to see that, 0 if d 6= cij 0 for any j 0 , i0 > 0, then there would be an up relinterval overlapping a k-interval, contradicting (31), hence the thesis.
A.5.
Proof of Lemma 4.10 0  Proof.
a) Let [cij , cij 0 ] be an up rel-interval connecting 0  0  i +1 i the tile-interval [bij , bi+1 j ] to the tile-interval [bj 0 , bj 0 ].
bw i i0 Suppose that [cj , cj 0 ] satisfies up rel (the other case is symmetric) and that [bij , bi+1 j ] satisfies fw.
Then, (39) is 0  0  contradicted.
Similarly, if [bij 0 , bji 0+1 ] satisfies bw, then (40) is contradicted.
b) Straightforward, by (42); c) Straightforward, by (49); 0 d) Let [cij , cij 0 ] be an up rel-interval, with 0 < i < kj , and suppose, by contradiction, that j 0 6= j + 1.
Suppose that 0 [cij , cij 0 ] is an up relbw -interval (the other case is symmetric).
By point a) of this lemma, we have that [bij , bi+1 j ] 0  0  satisfies bw and that [bij 0 , bij 0+1 ] satisfies fw.
Two cases are possible: i0 +1 i0 (i) if j 0 = j, then [bij , bi+1 j ] and [bj 0 , bj 0 ] belong to the same Id-interval.
By Lemma 4.8, they must be both labelled with bw or fw, against the hypothesis; (ii) if j 0 > j + 1, then consider a tile-interval [bhj+1 , bh+1 By j+1 ] belonging to the (j + 1)-th level.
Lemma 4.8, we have that [bhj+1 , bh+1 ] satisfies j+1 fw (since [bij , bi+1 j ] satisfies bw) and, by (38) and (39), we have that there is an up relfw -interval 0 starting at chj+1 and ending at some point chj 00 for 00 some j > j + 1, (by point (i)).
Consider the *-interval [b0j+2 , b1j+2 ].
We have that the interval [a0 , c0j+2 ], where a0 is a generic point in between a and b, overlaps the *-interval [b0j+2 , b1j+2 ], 0 the up relfw -interval [chj+1 , chj 00 ], and the up relbw -  0  interval [cij , cij 0 ], contradicting (41).
Hence, the only possibility is j 0 = j + 1.
A.6.
Proof of Lemma 4.11 Proof.
First of all, we observe that each tile-interval is above-connected with at least one tile-interval, by (38) and by Lemma 4.9, item a).
Now, suppose, by contradiction, that there exists a tile-interval [bij , bi+1 j ] not satisfying last and such that there is no tile-interval above-connected to it.
The proof proceeds by induction.
Base case.
If [bij , bi+1 j ] is the rightmost interval of the jth Id-interval not satisfying last and it satisfies fw (resp., bw), then we have that i = kj - 2 (resp., i = kj - 1).
Formula (47) (resp., (46)) guarantees the existence of an up rel-interval ending at cij , leading to a contradiction.
Inductive step.
Otherwise, if [bij , bi+1 j ] is not the rightmost interval of the j-th Id-interval not satisfying last, then the inductive case applies.
So, we can assume the inductive hypothesis, that is, there is an up rel-interval end0 ing at ci+1 and starting at some point cij-1 .
We want to j show that there exists also an up rel-interval ending at cij .
0 Without loss of generality, suppose that [cij-1 , ci+1 j ] satisfies up relfw .
Then, by Lemma 4.9, item e), there exists o i+1 an up relbw -interval starting at c and, by the strict alo j ternation property (Lemma 4.10, item b)), there exists an i up relbw e -interval starting at cj .
We show that, by applying 0  0  -1 i (48) to the k-interval [cij-1 , cj-1 ], we get a contradiction.
0  0  -1 i Indeed, [cij-1 , cj-1 ] satisfies k [?]
hOi(tile [?]
hOiup relfw o ) 0 and it overlaps [bij-1 , bij ], which satisfies the following formulae: fw i+1 i0 * hOiup relfw o : [cj-1 , cj ] satisfies up relo ; * hOi(k [?]
hOi(tile [?]
hOiup relbw e [?]
!last)): the interi val [ci-1 , c ] satisfies k and overlaps the tile-interval j j i i+1 [bj , bj ], which does not satisfy last (by hypothesis) and overlaps an up relbw e -interval (that one starting at cij ).
0  We show that [bij-1 , bij ] does not satisfy the formula hOiup relfw e , getting a contradiction with (48).
Suppose that there exists an interval [e, f ] satisfying up relfw e and such 0 that bij-1 < e < bij < f .
We distinguish the following cases: 0 * if f > ci+1 and e > cij-1 , then the up relfw o -interval j 0 fw [cij-1 , ci+1 ] overlaps the up rel -interval [e, f ], cone j tradicting Lemma 4.9, item d); 0 * if f > ci+1 and e = cij-1 , then there are an up relfw o j fw i0 and an up rele -interval starting at cj-1 , contradicting Lemma 4.9, item c); fw fw * if f = ci+1 j , then there are an up relo - and an up rele i+1 interval ending at cj and, by Lemma 4.9, item e),  bw there are an up relbw o - and an up rele -interval starting i+1 at cj , contradicting Lemma 4.9, item c); * finally, if f = cij , we have a contradiction with the hypothesis.
Thus, there exists no such an interval, contradicting (48).
This proves that each tile-interval is above-connected to at least one tile-interval and, if it does not satisfy last, then there exists at least one tile-interval above-connected to it.
Now, we show that such connections are unique.
Suppose, 00 0 by contradiction, that for some [cij , cij+1 ] and [cij , cij+1 ], 0 00 0 00 with cij+1 < cij+1 (the case cij+1 > cij+1 is symmet0 00 ric), we have that both [cij , cij+1 ] and [cij , cij+1 ] are up relintervals.
By Lemma 4.9, we have that they both satfw isfy the same propositional letter among up relfw o , up rele , bw bw fw up relo , and up rele , say up relo (the other cases are 0 00 symmetric).
Then, both cij+1 and cij+1 start an up relbw o interval by Lemma 4.9, item e).
By the strict alternation i0 +1 property, an up relbw e -interval starts at the point cj+1 .
Since 0  0  +1 i +2 [bij+1 , bj+1 ] does not satisfy last (it is neither the rightmost nor the leftmost tile-interval of the (j + 1)-th Id-interval), then, as we have already shown, there exists a point c such 0 +1 that [c, cij+1 ] is an up rel-interval.
By Lemma 4.9, items e) 0  i +1 and c), we have that [c, cj+1 ] is an up relfw e -interval.
We show that the existence of such an interval leads to a contradiction: i0 +1 * if c < cij , then the up relfw e -interval [c, cj+1 ] over00 i i laps the up relfw o -interval [cj , cj+1 ], contradicting Lemma 4.9, item d); * if c = cij , then cij starts both an up relfw o - and an fw up rele -interval, contradicting Lemma 4.9, item c); i i0 * if c > cij , then the up relfw o -interval [cj , cj+1 ] 0  i +1 overlaps the up relfw e -interval [c, cj+1 ], contradicting Lemma 4.9, item d).
In a similar way, we can prove that two distinct up relintervals cannot end at the same point.