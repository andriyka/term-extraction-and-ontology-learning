Decidability of the Logics of the Reflexive Sub-interval and Super-interval Relations over Finite Linear Orders Angelo Montanari Dept.
of Mathematics and Computer Science University of Udine, Italy angelo.montanari@uniud.it  Ian Pratt-Hartmann School of Computer Science Manchester University, UK ipratt@cs.man.ac.uk  AbstractaAn interval temporal logic is a propositional, multimodal logic interpreted over interval structures of partial orders.
The semantics of each modal operator are given in the standard way with respect to one of the natural accessibility relations defined on such interval structures.
In this paper, we consider the modal operators based on the (reflexive) subinterval relation and the (reflexive) super-interval relation.
We show that the satisfiability problems for the interval temporal logics featuring either or both of these modalities, interpreted over interval structures of finite linear orders, are all PS PACEcomplete.
These results fill a gap in the known complexity results for interval temporal logics.
Keywords-interval temporal logic; decidability; computational complexity  I. I NTRODUCTION Interval temporal logics provide a natural framework for representing and reasoning about temporal properties in many areas of computer science, including formal specification and verification of reactive systems, temporal databases, knowledge representation, and natural language semantics [1].
For many years, the discouragingly high computational complexity of these logics impeded their systematic investigation.
(As an example, Halpern and Shohamas modal logic of time interval HS [2] and Venemaas CDT logic [3] are highly undecidable.)
Recently, however, the discovery of expressive decidable fragments of HS has generated renewed interest in this subject.
The most significant of these fragments are the logics of temporal neighbourhood [4] and the logics of sub-interval and super-interval structures [5].
Decidability of temporal neighbourhood logics over various classes of linear orders can be proved by reducing their satisfiability problems to that of the two-variable fragment of first-order logic over the same classes of linear orders [6].
In fact, neighbourhood temporal logic turns out to be a maximal decidable fragment of HS, when interpreted over any class of linear orders that contains at least one linear order with an infinitely ascending/descending sequence [4], [7], [8].
In this paper, we focus on interval logics of subinterval and super-interval structures.
There are three natural definitions of the sub-interval  Pietro Sala Dept.
of Mathematics and Computer Science University of Verona, Italy pietro.sala@univr.it  relation [5]: reflexive  (the current interval is a sub-interval of itself), proper  (sub-intervals share at most one endpoint with the current interval), and strict  AV (both endpoints of the sub-intervals are strictly inside the current interval).
And interval temporal logics based on all of these versions of the sub-interval relationainterpreted over the class of dense linear ordersahave been studied in the literature.
Thus, the logic D of reflexive sub-intervals is studied by van Benthem in [9], where it is proved to be equivalent to the standard modal logic S4.
In [10], Shapirovsky and Shehtman establish a connection between the logic of strict sub-intervals DAV and the logic of Minkowski space-time.
They provide a sound and complete axiomatic system for DAV ; moreover, they prove PS PACE-completeness of DAV by means of a suitable filtration technique [10], [11].
An optimal tableau system for DAV is given by Bresolin et al.
in [5].
Finally, the logic D is treated extensively in [5].
The authors prove decidability and PS PACE-completeness of D , and provide an optimal tableau system.
All of the above results concern logics interpreted over dense linear orders; and the question naturally arises as to what happens if we consider classes of discrete orders instead.
In this paper, we go some way to answering this question.
Specifically, we study the satisfiability problem of interval temporal logics based on the reflexive sub-interval and super-interval relations interpreted over finite linear orders.
The paper is organized as follows.
In Section II, we give the syntax and semantics of three propositional modal languages: LD , featuring the modal operator [D], LDE , featuring the modal operator [DE], and LD,DE , featuring both operators.
Informally, we read [D]D as aD is true at all subintervals of the current intervala, and [DE]D as aD is true at all super-intervals of the current intervala.
We interpret all three languages over the class of finite linear orders.
In Section III, we prove PS PACE-hardness of the satisfiability problem for LD and LDE , by reduction from the satisfiability problem for quantified Boolean formulas.
In Section IV, we prove that the satisfiability problem for LD is in PS PACE.
In Section V, we generalize this latter result to LDDE .
It can easily be  1, m  m, m i, j  so @ Rsq , q p1 , p s	 @ 1 ?
?
s q2 , q p2 , p s  j, j  [i, j] i, i i  j Figure 2.
A relational frame satisfying (1)a(10).
1, 1 Figure 1.
Geometrical depiction of intervals.
shown that the proposed techniques cannot be directly lifted to the strict and proper cases.
Moreover, the undecidability of various extensions of the logics of sub-interval and superinterval structures has been recently proved [4], [7], [12].
II.
P RELIMINARIES Fix a set P of proposition letters, and denote its power set by P(P).
The language LD is defined to be the smallest set of expressions satisfying: (i) P a LD ; (ii) if D, D a LD , then D aSS D, AZD, [D]D a LD .
The language LDE is defined similarly, but with [DE] in place of [D]; the language LDDE contains both modalities.
In the following, we employ the usual abbreviations D a" D (for AZ(AZD aSS AZD)), DD (for AZ[D]AZD), and DED (for AZ[DE]AZD).
We denote by 	D	 the total number of symbols occurring in D. For the purposes of this paper, an interval is a set of the form {h a N | i  h  j}, where i, j are positive integers with i  j; we write [i, j] to denote this interval.
Note that intervals are finite and non-empty, but may be singletons.
If I is an interval, we write Sub(I) to denote the set of intervals J such that J a I.
A structure is a pair A = (IA , AVA ), where IA = [1, m] for some m fi 1, and AVA is a function from Sub(IA ) to P(P).
We refer to IA as the domain of A, m as the size of A, and AVA as the interpretation function of A.
We define a truth-relation for LDDE -formulas (hence for LD -formulas and LDE -formulas), relative to structures A and intervals I a IA , as follows: (i) for p a P, A |=I p if and only if p a I A ; (ii) the usual rules for aSS and AZ; (iii) A |=I [D]D if and only if, for all intervals J a I, A |=J D; (iv) A |=I [DE]D if and only if, for all intervals J a Sub(IA ) such that J a I, A |=J D. If IS is a set of formulas, we write A |=I IS if A |=I D for all D a IS.
If A |=I D for some I a Sub(IA ), we say that A is a model of D. If D has a model, then D is satisfiable; if AZD has no model, then D is valid.
We denote the set of valid LD -formulas by D. If I = [1, m], it is useful to depict Sub(I) as the upper left-hand half of an m A m integer grid, as shown in Fig.
1,  where each interval [i, j] a Sub(I) corresponds to the cell in the grid having co-ordinates i, j.
In this representation, all intervals sharing a common end-point j lie in the jth row (counting from the bottom upwards), all intervals sharing a common start-point i lie in the ith column (counting leftto-right), and all singleton intervals [i, i] lie on the diagonal section of the boundary.
Motivated by this representation, if A is a structure of size m, and 1  j  m, then we refer to the set of intervals {[i, j] | for some i (1  i  j)} as the jth row of A, and to the interval [i, j] as the ith cell in that row.
We refer to the mth row of A as the top row.
Evidently, we may identify LD with the language of propositional modal logic, where [D] replaces the modal operator ; and it is natural to ask how D is related, under this identification, to the modal logics of various familiar frame-classes.
Thus, for example, it is easy to show that every satisfiable LD -formula (using the semantics for LD given above) has a relational (Kripke) model over a finite, reflexive, transitive tree.
Since the logic S4Grz is known to be sound and complete for the class of finite, reflexive, transitive trees [13, p. 101], we have S4Grz a D. However, a little thought shows that this inclusion is strict.
For consider the following set of LD -formulas featuring the proposition letters o, p, q, p1 , p2 , q1 and q2 : o  (1)  [D](o a" p1 a" p2 a" q1 a" q2 ) [D](o a D(p1 aSS AZo) aSS D(q1 aSS AZo))  (2) (3)  [D](p1 a D(p2 aSS AZp1 )) [D](q1 a D(q2 aSS AZq1 ))  (4) (5)  [D](p1 a" p2 a p) [D](q1 a" q2 a q) [D]AZ(p aSS q)  (6) (7) (8)  [D](p a [D]p) [D](q a [D]q).
(9) (10)  The corresponding -formulas are easily seen to be satisfied at the root of the reflexive, transitive tree with two depth-3 branches illustrated in Fig.
2 (where only the true proposition letters are indicated); hence these formulas are S4Grzconsistent.
Now suppose (1)a(10) are true at an interval I in some structure A (under LD -semantics).
From (3)a(5), every sub-  interval of I satisfying o has length at least 3, and every sub-interval of I satisfying p1 or q1 , length at least 2.
Hence, by (2), all unit-length sub-intervals of I satisfy either p2 or q2 , and by (6)a(8), no such interval satisfies both.
By (1), (3)a(7) and (9)a(10), there exists at least one unit-length subinterval of I satisfying p2 and similarly for q2 .
Therefore, we can find adjacent unit-length intervals, say, Jp satisfying p2 and Jq , satisfying q2 .
Now consider the length-2 interval J which includes Jp and Jq .
Since J is of length less than 3, J cannot satisfy o; since Jp satisfies p by (6), J cannot satisfy q1 or q2 by (7)a(8) and (10); likewise, J cannot satisfy p1 or p2 by (6) and (8)a(9).
This falsifies (2).
q0  I, = Q1 p1 .
.
.
Qn pn D,  (11)  where D is a formula of propositional logic and, for all i (1  i  n), Qi is either a or a.
Given a truth-value assignment to its free variables, I, is assigned a truth-value in the obvious way; in particular, if I, is closed (has no free variables), it is either true or false simpliciter.
The problem of determining the truth-value of closed quantified Boolean formulas was shown to be PS PACE-complete in [14].
Theorem 1.
The satisfiability problems for LD -formulas and LDE -formulas over finite linear orders are both PS PACEhard.
Proof: By (logarithmic space) reduction from the satisfiability problem for quantified Boolean formulas.
Let the quantified Boolean formula I,, of the form (11), be given, where D is a formula of propositional logic featuring only the proposition letters p1 , .
.
.
, pn .
We construct an LD formula I,E, and show that I,E is satisfiable over finite linear orders if and only if I, is true.
For all i (0  i  n), define I,i to be the formula Qi+1 pi+1 .
.
.
Qn pn D, with free variables p1 , .
.
.
, pi .
Thus, I,0 = I, and I,n = D. The LD -formula I,E will feature the proposition letters p1 , .
.
.
, pn together with additional proposition letters q0 , .
.
.
, qn .
We define I,E to be the conjunction of the following set of formulas: q0 (1  j  i < k  n) [D](qi aSS pj a [D](qk a pj )) [D](qi aSS AZpj a [D](qk a AZpj )) (1  j  i < k  n) (0  i < n) [D](qi a fiDqi+1 ) (0  i < n, Qi+1 = a) [D](qi a fiD(qi+1 aSS pi+1 ) [D](qi a fiD(qi+1 aSS AZpi+1 ) (0  i < n, Qi+1 = a)  (12) (13) (14) (15) (16) (17)  q3 , p 3  q2 ,AZp2  q4 ,AZp4 q3 ,AZp3 q4 , p 4  q1 ,AZp1 q2 , p 2  q3 , p 3  q3 ,AZp3 q4 , p 4  p3 /0  AZp1 , p2 , AZp3  a  p1 /1  AZp1  AZp1 , p2  p4 /1  Figure 3.  p1 /0  p2 /1  q4 ,AZp4  III.
L OWER B OUND The task of this section is to establish the PS PACEhardness of the satisfiability problems for D and D over finite linear orders.
The argument is straightforward, and proceeds by reduction from the satisfiability problem for quantified Boolean formulas, the canonical PS PACE-hard problem.
Recall, in this context, that a quantified Boolean formula is an expression of the form  q1 , p 1  p3 /1  AZp1 , p2 , p3  p4 /0  p1  p3 /0  p2 /0 p1 , AZp2  p1 , AZp2 , AZp3  p4 /1  p3 /1  p1 , AZp2 , p3  p4 /0  AZp1 , p2 ,  AZp1 , p2 ,  p1 , AZp2 ,  p1 , AZp2 ,  AZp3 , p4  p3 , AZp4  AZp3 , p4  p3 , AZp4  A tree-model and its embedding into a grid structure.
[D](qn a D)  (18)  It is routine to check that the construction of I,E requires only space bounded by a logarithmic function of 	I,	.
Suppose A |=I0 I,E.
We think of the truth of a proposition letter qi (0  i < n) at an interval as indicating that the quantifier Qi+1 is being aconsidereda.
Formula (12) starts the process by considering Q1 .
Now, suppose A |=I qi , where 0  i < n and I a I0 .
By Formulas (13) and (14), every sub-interval of I satisfying qk (k > i) must agree with I on the truth-values assigned to p1 , .
.
.
, pi ; thus these proposition letters may be regarded as fixed for all such intervals.
If Qi+1 = a, then, by Formulas (15), I has a sub-interval J satisfying qi+1 (at which pi+1 must be either true or false); on the other hand, if Qi+1 = a, then, by Formulas (16) and (17), I has two sub-intervals satisfying qi+1 : one in which pi+1 is true, and one in which pi+1 is false.
Finally, Formula (18) ensures that, if I a I0 and A |=I qn , then D is true at I.
Now, any I a I0 such that A |=I qi defines a natural truth-value assignment I"I with domain {p1 , .
.
.
, pi } obtained by taking I"(pj ) =  just in case A |=I pj , for all j (1  j  i).
Using a (backwards) inductive argument, we claim that, if I a I0 and A |=I qi , then I"I |= I,i .
For i = n, the claim is guaranteed by Formula (18).
Assuming the result holds for i (0 < i  n) Formulas (13), (14), (16) and (17) guarantee that it holds for i a 1 if Qi = a, and Formulas (13)a(15) do the same if Qi = a.
Formula (12) then guarantees that I, is true.
Conversely, suppose I, is true.
We define a tree tr(I,) as follows.
Each node I" of tr(I,) will be a truth-value assignment with domain {p1 , .
.
.
, pi } for some i (0  i  n), with the property that I" |= I,i ; we call i the level of I".
We take the root node I"0 of tr(I,) to be the empty assignment (i.e., the unique assignment with level 0).
Since I, = I,0 is a true formula with no free variables, we have I"0 |= I,0 .
Suppose now that I" is a node of tr(I,), with level i  (0  i < n), such that I" |= I,i .
If I,i = api+1 I,i+1 , let I"  be an assignment with domain {p1 , .
.
.
, pi+1 } such that I" a I"  , and I"  |= I,i+1 ; we then take I"  to be the sole daughter of I" in tr(I,).
If, on the other hand, I,i = api+1 I,i+1 , let I"  = I" aS {pi+1 a }, I"  = I" aS {pi+1 a aL}, and take I"  and I"  to be the daughters of I" in tr(I,); evidently, I"  |= I,i+1 and I"  |= I,i+1 .
This completes the definition of tr(I,).
Note that, in particular, if I" is a node with level n, then I" |= I,n ; i.e., I" |= D. A straightforward induction on n shows that, setting m = 2n+1 , we may define an embedding f : tr(I,) a Sub([1, m]) in such a way that f (I") a f (I"  ) if and only if I" is a descendant of I"  in tr(I,).
This is illustrated by the lefthand diagram in Fig.
3, where a tree-model for the QBF formula I, = ap1 ap2 ap3 ap4 (p1 a" p2 ) aSS (AZp1 a" AZp2 ) aSS (p3 a" p4 ) aSS (AZp3 a" AZp4 ) is given, together with its embedding into a grid structure.
To show that I,E is satisfiable, define A with domain [1, m] as follows.
For all i (0  i  n), we set A |=I qi if and only if I = f (I") for some node I" of tr(I,) with level i.
Further, for each node I" with level i, and each j (1  j  i), we set A |=f (I") pj if and only if I"(pj ) = .
The truth-values of the other proposition letters may be assigned arbitrarily.
It is then obvious that A |=f (I"0 ) I,E.
An example of this construction is shown in the right-hand diagram of Fig.
3.
By replacing every occurrence of [D] with [DE], we similarly establish the PS PACE-hardness of LDE .
IV.
U PPER B OUND The task of this section is to establish the membership in PS PACE of the satisfiability problem for LD -formulas over the class of finite linear orders.
Fix an LD -formula D. Let IS be the set of all sub-formulas of D (including D itself), and let IS be the set of all formulas D or AZD, where D a IS .
A 1-type is a subset Ia a IS satisfying the properties: (T1) for all formulas AZD a IS, either D a Ia or AZD a Ia; (T2) Ia is propositionally consistent; (T3) if [D]D a Ia, then D a Ia.
Let A be a structure and I a Sub(IA ).
Evidently, there is a unique 1-type Ia such that A |=I Ia; we say that A realizes Ia at I.
For the purposes of this paper, a vector is a finite, nonempty sequence of positive integers.
The following notation will be used.
If wE = (w1 , .
.
.
, ws ) is a vector of length s, we write |wE| = s, and if m is a positive integer, we write mwE for the vector (mw1 , .
.
.
, mws ).
If vE = (v1 , .
.
.
, vs ) is a vector of the same length, we write wE  vE (equivalently: vE fi wE) if wi  vi for all i (1  i  s).
Less conventionally, we take corresponding upper-case letters to denote the successive partial sums of vectors, thus: Wi = w1 + AV AV AV + wi , for all i (0  i  s).
Note that, for any vector wE, W0 = 0.
Let A be a structure of size m, I1 , .
.
.
, Is , a selection of intervals in IA occurring left-to right across a single  wi  w1  Ia1 Figure 4.
AVAVAV  Ia1  AVAVAV  Iai  AVAVAV  ws  Iai  AVAVAV  Ias  AVAVAV  Ias  Geometrical depiction of the realization of a profile by a row.
row in the grid-representation of Sub(IA ), and Ia1 , .
.
.
, Ias the respective 1-types realized in A by these intervals.
In addition, suppose that the final cell in that row realizes Ias .
Evidently: (C1) if 1  h < h  s and [D]D a Iah , then [D]D a Iah ; (C2) if DD a Ias , then D a Ias .
Accordingly, we say that a configuration is a finite, nonempty sequence IaE = (Ia1 , .
.
.
, Ias ) of 1-types satisfying conditions (C1) and (C2).
Again, we denote the length of this sequence by |IaE|.
A profile is a pair IaE, wE, where IaE is a configuration of length s fi 1, and wE = (w1 , .
.
.
, ws ) a vector, also of length s; we say that the length of this profile is s. For 1  j  m, we say that the jth row of A realizes the profile (Ia1 , .
.
.
, Ias ), (w1 , .
.
.
, ws ) if Ws = j and, for all h (1  h  s) and all i (Wha1 < i  Wh ), A |=[i,j] Iah .
Pictorially, this means that the successive 1-types Ia1 , .
.
.
, Ias are realized horizontally in uniform blocks of length w1 , .
.
.
, ws , respectively, and that these blocks cover the entire row, as shown in Fig.
4.
For all j (1  j  m), the jth row of A obviously realizes at least one profile; however, since there is no requirement that neighbouring Iai are distinct, this profile will not in general be unique.
The following lemma shows that we may, without loss of generality, confine attention to ashorta profiles.
Lemma 2.
If an LD -formula D has a model, then it has a model over the same domain in which every row realizes a profile of length at most 	D	 + 1.
Proof: Fix a model A of D, of size m. If D a IS, a witness for D is an interval I a Sub(IA ) such that A |=I D. We call an interval I = [i, j] a Sub(IA ) special if there exists D a IS such that A |=I D and, for all k (i < k  j) A |=[k,j] Dathat is, if there is some formula of IS for which I is the right-most witness in its row.
Since every singleton interval, [j, j], is special, it follows that, for any I = [i, j] a Sub(IA ), there is a least k (i  k  j) such that K = [k, j] is special.
We refer to K as the first special interval to the right of I. Evidently, K = I if and only if I is itself special.
Moreover, since |IS|  2	D	, and the right-most interval of any row is the right-most witness for at least |IS|/2 of the formulas of IS in that row, it follows that the number of special intervals in any row is at most 	D	 + 1.
Now define the structure B, over the same domain as A, by setting, for all I a Sub(IA ), I B = K A , where K is the first special interval to the right of I.
We claim that, for all I a Sub(IA ) and all D a IS:     Vh Vh a1  v1 v2 .
.
.
vta1  -  -  vt  -  6 I,h    Uh Figure 5.
Iah -  Neighbouring rows of a structure  Vt a Us  I,1 I,2 .
.
.
I,ta1 ?  (S1) for all h (1  h  s) and all h (1  h  t), if [D]D a I,h and Uh > Vh a1 , then [D]D a Iah ; (S2) for all h (1  h  t), if DD a I,h , either there exists h (h  h  t) such that D a I,h , or there exists h (1  h  s) such that Uh fi Vh and DD a Iah ; (S3) Vta1  Us < Vt .
The following two lemmas motivate this definition.
Lemma 3.
Let A be a structure of size m, let 1  j < m, and let IaE, uE, I,E, vE be profiles realized by the jth and  -  A  B |=I D if and only if A |=K D, where K is the first special interval to the right of I.
We prove the claim by structural induction.
If D = p is a proposition letter, the claim is immediate by the construction of B; furthermore, the Boolean cases are trivial.
So suppose D = [D]I, (whence AZD, AZI, a IS).
Pick any I a Sub(IA ), and let K be the first special interval to the right of I.
Suppose first that B |=I D. Then B |=J I, for some J a I.
Let K  be the first special interval to the right of J, so that, by inductive hypothesis, A |=K  I,.
Since K  a J a I, we have A |=I AZ[D]I,; so let I  be the right-most witness for AZ[D]I, in the same row as I.
By definition, I  is special, and hence must lie (non-strictly) to the right of K; thus, I  a K. But then A |=K AZ[D]I,, i.e., A |=K D. Conversely, suppose A |=K D. Then A |=J AZI, for some J a K. So now let J  be the right-most witness for AZI, in the same row as J.
By definition, J  is special, and thus (trivially) the first special interval to the right of J  , whence, by inductive hypothesis, B |=J  AZI,.
But J  a J a K a I, so that B |=I D. This completes the induction, and establishes the claim.
To conclude the proof, suppose A |=I D, and suppose, without loss of generality, that I is the right-most witness for D in its row.
Thus, I is special, and, furthermore, is (trivially) the first special interval to the right of I. Constructing B as above, BI |= D. Finally, the claim shows that every row in B realizes a profile of length no greater than the number of special intervals in that row.
But we have already noted that this number is bounded by 	D	 + 1.
Now suppose IaE = (Ia1 , .
.
.
, Ias ) and I,E = (I,1 , .
.
.
, I,t ) are configurations.
A solution for IaE, I,E is a pair uE, vE, where uE is a vector of length s and vE a vector of length t, satisfying the following conditions:  Us  I,t  Figure 6.
The structure B of Lemma 4.
(j + 1)th rows of A, respectively.
Then uE, vE is a solution for IaE, I,E.
Proof: Numbering the cells of the jth row from left to right (starting with 1), we observe that, for all h (1  h  |IaE|), the cells in positions Uha1 + 1 to Uh all satisfy Iah ; similar remarks apply to row j +1.
Conditions (S1)a(S2) are then evident by inspection of Fig.
5, which depicts the two rows of A in question.
For condition (S3), note that Us = j, Vt = j + 1 and, by assumption, vt > 0.
Lemma 4.
Let IaE and I,E be configurations.
Suppose that uE, vE is a solution for IaE, I,E, and that A is a structure whose top row realizes the profile IaE, uE.
Then there exists a structure B whose top row realizes the profile I,E, vE.
Proof: Write I,E = (I,1 , .
.
.
, I,t ), and let s = |IaE|.
The structure B shown in Fig.
6 has the required properties.
A label I,h in a region indicates that all the intervals in that region make true exactly the proposition letters I,h aSP.
Condition (S3) guarantees that the dimensions of the rectangles labelled I,1 , .
.
.
, I,ta1 are such that the atrapeziuma labelled I,t exists.
In particular, each of the new rows (above the top row of A) contains a final block of cells in the region labelled I,t .
(This is important, because (I,1 , .
.
.
, I,h ) need not be a configuration for h < t.) Using Conditions (C1)a(C2) and (S1)a(S2), a routine structural induction establishes that, for all h (1  h  t), and any interval I lying in the region labelled I,h , B |=I I,h .
Thus, Lemma 3 states that configurations belonging to profiles realized by successive rows in a structure always have a solution, while Lemma 4 provides a partial converse: given a solution uE, vE for IaE, I,E, we can extend any structure whose top row realizes the profile IaE, uE to one whose top row realizes the profile I,E, vE (notice that reflexivity of the sub-interval relation plays an essential role in Lemma  4.3).
Indeed, the next lemma allows us to create, ex nihilo, a structure whose top-row realizes any profile of length 1.
Lemma 5.
Let Ia be a 1-type such that DD a Ia implies D a Ia, and let m be a positive integer.
Then there exists a structure A whose top row realizes the profile (Ia), (m).
Proof: Set IA = [1, m], and I A = Ia aS P for all I a Sub(IA ).
The following sequence of lemmas shows that, if IaE, I,E has one solution, then it has many.
Lemma 6.
Let IaE and I,E be configurations, and m a positive integer, and suppose that uE, vE is a solution for IaE, I,E.
Then muE, mvE is also a solution for IaE, I,E.
Proof: Satisfaction of inequalities x1 + AV AV AV + xh  y1 + AV AV AV + yk and x1 + AV AV AV + xh < y1 + AV AV AV + yk is preserved under multiplication by m. Lemma 7.
Let IaE and I,E be configurations, and suppose that uE, vE is a solution for IaE, I,E.
If uE is a vector satisfying uE  uE , then there exists a vector vE  satisfying vE  vE  such that uE , vE   is a solution for IaE, I,E.
Proof: It suffices to prove the lemma where uE = (u1 , .
.
.
, us ), vE = (v1 , .
.
.
, vt ), and uE = (u1 , .
.
.
, uia1 , ui + 1, ui+1 , .
.
.
, us ).
Since Vt > Us , pick the least j (1  j  t) such that Vj > Uia1 , and set vE  = (v1 , .
.
.
, vja1 , vj + 1, vj+1 , .
.
.
, vt ).
It is then obvious that, for all i (0  i  s) and all j (0  j  t), Ui > Vj if and only if Ui > Vj .
Lemma 8.
Let IaE and I,E be configurations, with |IaE| = s  m and |I,E| = t  n, such that IaE, I,E has a solution.
Then IaE, I,E has a solution uE, vE satisfying uE  (n, .
.
.
, n).
Indeed, it has a solution uE, vE satisfying uE  (n, .
.
.
, n) and vE  (m + 1, .
.
.
, m + 1).
Proof: Let uE, vE be a solution with uE = (u1 , .
.
.
, us ) and vE = (v1 , .
.
.
, vt ).
For the first statement of the lemma, suppose ui > n for some i (1  i  s).
We claim that there exists j (1  j  t) such that, writing uE = (u1 , .
.
.
, uia1 , ui a 1, ui+1 , .
.
.
, us ) and vE  = (v1 , .
.
.
, vja1 , vj a1, vj+1 , .
.
.
, vt ), uE , vE   is also a solution.
By repeated applications of this claim, we obtain the desired solution.
The claim is obvious if n = 1; so assume n > 1 (whence ui fi 3).
Now, since Vt > Us fi Usa1 + 1, let j  be the smallest positive integer such that Vj  > Uia1 + 1.
If vj  > 1, then, since ui fi 3, setting j = j  gives the required vE  .
So suppose vj  = 1, in which case, we also have j  fi 2 and indeed Vj  = Uia1 + 2.
Since, in addition, ui fi n + 1, there exists j (j  < j  t) such that vj > 1 and Vja1  Ui a 2.
Again, it is easy to check that this value of j gives the required vE  .
The second statement of the lemma follows by an almost identical argument.
Lemma 9.
Let IaE and I,E be configurations whose length  is bounded by a polynomial function of 	D	.
Then we can determine, using space likewise bounded by a polynomial function of 	D	, whether IaE, I,E has a solution.
Proof: Try all pairs of vectors uE, vE satisfying the bounds given in Lemma 8.
Lemma 10.
Let IaE and I,E be configurations, with |I,E|  n, such that IaE, I,E has a solution; and let m be a positive integer.
For any vector uE satisfying uE fi (mn, .
.
.
, mn), there exists a vector vE satisfying vE fi (m, .
.
.
, m), such that uE, vE is a solution for IaE, I,E.
Proof: By Lemma 8, let uE , vE   be a solution satisfying uE  (n, .
.
.
n).
By Lemma 6, muE , mvE   is a solution, with muE  uE, and (trivially) mvE  fi (m, .
.
.
, m).
By Lemma 7, there exists a vector vE with vE fi mvE  such that uE, vE is a solution.
Define the directed graph GD = (C, E) as follows:   C  = {IaE | IaE is a configuration s.t.
|IaE|  	D	 + 1}  E  = {IaE, I,E a C 2 | IaE, I,E has a solution}.
Since the number of 1-types is at most 2fiDfi , |C|  2n , where n = 	D	(	D	 + 1).
The main lemma of this section states necessary and sufficient conditions for D to be satisfiable.
Lemma 11.
Let D be an LD -formula, and let the graph GD = (C, E) be constructed as above.
Then D is satisfiable if and only if there is a path in GD from some configuration IaE of length 1 to some configuration I,E containing a 1-type I, such that D a I,.
Proof: Suppose first that A is a model of D. By Lemma 2, we may assume that each row of A realizes some profile (IaE, uE) of length at most 	D	 + 1, so that IaE a C. The first row necessarily realizes a profile of length 1; by Lemma 3, the configurations corresponding to successive rows are joined by an edge in E; and, since A is a model of D, some row of A realizes a profile in which D occurs somewhere.
That is: there is a path in GD from some configuration IaE of length 1 to some configuration I,E containing a 1-type I, such that D a I,.
Conversely, suppose there is a path IaE1 , .
.
.
, IaEz in GD where: (i) IaE1 = (Ia) is a configuration of length 1; (ii) IaEi , IaEi+1  is an edge of E for all i (1  i < z); and (iii) IaEz contains a 1-type I, such that D a I,.
Let n = 	D	 + 1.
By definition, each configuration in C is of length at most n. We show by induction that, for all j (1  j  z), there exists a structure Aj whose top row realizes a profile of the form IaEj , uE, with uE fi (nzaj , .
.
.
, nzaj ).
It follows that Az is a model of D, proving the lemma.
Case j = 1: By Lemma 5, there exists a structure whose top row realizes the profile (Ia), (nza1 ).
Case 1 < j  z: Suppose Aja1 has been defined, and that the top row of Aja1 realizes the profile IaEja1 , uEja1 , with  uEja1 fi (nzaj+1 , .
.
.
, nzaj+1 ).
Since (IaEja1 , IaEj ) a E, the pair IaEja1 , IaEj , has a solution, and hence, by Lemma 10, a solution uEja1 , uEj  with uEj fi (nzaj , .
.
.
, nzaj ).
By Lemma 4, there exists a model Aj whose top row realizes the profile IaEj , uEj .
This completes the induction, and the proof.
Theorem 12.
The satisfiability problem for LD is in PS PACE.
Proof: Denote 	D	(	D	 + 1) by n, and consider the following nondeterministic procedure 1. set N = 0; 2. guess a configuration I,E of length 1; 3. until N = 2n or I,E contains a 1-type I, such that D a I, do: 4. set IaE = I,E and increment N ; 5. guess a configuration I,E s.t.
|I,E|  	D	 + 1; 6. if IaE, I,E has no solution, then fail; 7. end until 8. if N = 2n then fail; 9. succeed.
By Lemma 9, the test in Line 6 requires only space bounded by a polynomial function of 	D	; further, the counter N requires only n + 1 bits.
Evidently, the procedure has a successful run if and only if there exists a path in GD from some configuration IaE of length 1 to some configuration I,E containing a 1-type I, such that D a I,.
The result then follows by Lemma 11 and Savitchas theorem.
V. A DDING THE O PERATOR [DE] In this section, we show how to generalize Theorem 12 to the satisfiability problem for LDDE over finite linear orders (LDE is just a special case).
First, we modify the definitions of configuration and profile by adding to conditions (C1)a (C2) the further condition: (C3) if 1  h < h  s and [DE]D a Iah , [DE]D a Iah .
Next, we prove an analogue of Lemma 2.
Lemma 13.
If an LDDE -formula D has a model, then it has a model over the same domain in which every row realizes a profile of length at most 4	D	 + 3.
Proof: Fix a model A of D. If D a IS, a witness for D is an interval I a Sub(IA ) such that A |=I D. We call an interval I = [i, j] a Sub(IA ) right (resp., left) special if there exists D a IS such that A |=I D and, for all k (i < k  j) (resp., (1  k < i)) A |=[k,j] Dathat is, if there is some formula of IS for which I is the right-most (resp., left-most) witness in its row.
A special interval is a right special or left special interval.
Evidently, for any I = [i, j] a Sub(IA ), there is a least k (i  k  j) (resp., greatest k  (1  k  < i)) such that Kr = [k, j] (resp., Kl = [k  , j]) is special.
We refer to Kr (resp., Kl ) as the closest-to-the-right (resp., closestto-the-left) special intervals for I.
Finally, since |IS|  2	D	,  and the right-most (resp., left-most) interval of any row is the right-most (resp., left-most) witness for at least |IS|/2 of the formulas of IS in that row, it follows that the number of special intervals in any row is at most 2	D	 + 2.
Let f : Sub(IA ) a Sub(IA ) be a function that satisfies the following properties: (F1) for every special interval I, f (I) = I; (F2) for every non-special interval I, f (I) = I  , where I  is a non-special interval such that the closest-to-the-left and closest-to-the-right special intervals for I and I  are the same; (F3) for every pair of non-special intervals I, I  , if the closest-to-the-left and closest-to-the-right special intervals for I and I  are the same, then f (I) = f (I  ).
Observe that, for any D = [D]I, a IS and any I a Sub(IA ), A |=I D if and only if A |=f (I) D; similarly for D = [DE]I,.
Let B be a structure with the same domain as A (that is, Sub(IB ) = Sub(IA )) such that I B = f (I)A .
We claim that, for every I a Sub(IA ) and every D a IS: B |=I D if and only if A |=f (I) D. We prove the claim by structural induction.
If D = p is a proposition letter, the claim is immediate by the construction of B. Boolean cases are trivial.
So suppose D = [D]I, (whence AZD, AZI, a IS).
Pick I a Sub(IA ), and let f (I) = I  .
For the left-to-right implication, suppose that A |=I  AZD.
Let K be the right-most witness for AZD in the same row as I.
Since K is special and non-strictly to the right of I  , we have K a I.
Now, there exists an interval KE such that KE a K, A |=KE AZI,, and KE is the right-most witness for AZI, in its row.
Since KE is special, f (KE) = KE, and thus, by inductive hypothesis, B |=KE AZI,, whence B |=I AZD.
Conversely, suppose B |=I AZD.
Then, there exists J a I such that B |=J AZI,, whence A |=f (J) AZI,, by inductive hypothesis.
Let K be the right-most witness for AZI, in the same row as J.
Since K is special and non-strictly to the right of f (J), we have K a J, whence A |=I AZ[D]I,.
But we have already observed that A |=I [D]I, if and only if A |=f (I) [D]I,.
Hence, A |=f (I) AZD as required.
The case D = [DE]I, is completely symmetric.
Now, suppose A |=I D. We may assume without loss of generality that I is special, whence I = f (I), so that, constructing B as above, B |=I D. To conclude the proof, it suffices to observe that every row in B realizes a profile that features one 1-type for every special interval in that row (at most 2	D	+2) plus at most one 1-type for every maximal consecutive sequence of non-special intervals in that row (at most 2	D	 + 1).
Next, we modify the definition of a solution for a pair of configurations IaE, I,E, given in Section IV, by adding to conditions (S1)a(S3) the further conditions (S4) for all h (1  h  s) and all h (1  h  t), if [DE]D a Iah and Uh > Vh a1 , then [DE]D a I,h ;  (S5) for all h (1  h  s), if DED a Iah , either there exists h (1  h  h) such that D a Iah , or there exists h (1  h  t) such that Vh a1  Uha1 and DED a I,h .
We construct the graph GD exactly as described in Section IV, except that we employ the revised definitions of configuration and solution, and set C = {IaE | IaE is a configuration s.t.
|IaE|  4	D	 + 3}.
In place of Lemma 11, we then have: Lemma 14.
Let D be an LDDE -formula, and let the graph GD = (C, E) be constructed as above.
Then D is satisfiable over finite linear orders if and only if there is a path in GD from some configuration Ia of length 1 to some configuration I,E containing a 1-type I, such that D a I,, and a path in GD from I,E to some configuration (Il1 , .
.
.
, Ilk ) such that, for every j (1  j  k) and every DED a Ilj , there exists j  (1  j   j) with D a Ilj  .
The following theorem is the counterpart of Theorem 12 for LDDE , and may be proved similarly.
Theorem 15.
The satisfiability problem for LDDE is in PS PACE.
VI.
C ONCLUSIONS In this paper, we have shown that the satisfiability problems for the interval logics of the reflexive sub-interval and super-interval relations interpreted over finite linear orders are PS PACE-complete.
The authors are currently investigating the problem of establishing whether decidability, and complexity, of LDDE are preserved if we replace finite linear orders by the natural numbers or the integers.
The problem is of interest, because, as is easily shown, DE can be used to write formulas satisfiable over infinite discrete linear orders, but not over finite linear orders.
As we have already pointed out, some basic steps of our proof do not work if we replace reflexive sub-interval and super-interval relations by strict or proper ones.
To the best of our knowledge, the satisfiability problems for interval logics of the strict (respectively, proper) sub-interval and super-interval relations, interpreted over finite linear orders, are still open.
ACKNOWLEDGMENTS This paper resulted from a visit of the first and third authors to Manchester University in January 2010, funded by the ESF Research Networking Programme GAMES (Games for Design and Verification).
The same authors acknowledge the support of the Italian PRIN and GNCS projects Innovative and multi-disciplinary approaches for constraint and preference reasoning and Logics, automata, and games for the formal verification of complex systems.
The second author acknowledges the support of the EPSRC, grant reference EP/E035248.
R EFERENCES [1] V. Goranko, A. Montanari, and G. Sciavicco, aA road map of interval temporal logics and duration calculi,a Journal of Applied Non-Classical Logics, vol.
14, no.
1a2, pp.
9a54, 2004.
[2] J. Halpern and Y. Shoham, aA propositional modal logic of time intervals,a Journal of the ACM, vol.
38, pp.
279a292, 1991.
[3] Y. Venema, aA modal logic for chopping intervals,a Journal of Logic and Computation, vol.
1, no.
4, pp.
453a476, 1991.
[4] D. Bresolin, V. Goranko, A. Montanari, and G. Sciavicco, aPropositional interval neighborhood logics: expressiveness, decidability, and undecidable extensions,a Annals of Pure and Applied Logic, vol.
161, no.
3, pp.
289a304, 2009.
[5] D. Bresolin, V. Goranko, A. Montanari, and P. Sala, aTableaux for logics of subinterval structures over dense orderings,a Journal of Logic and Computation, vol.
20, no.
1, pp.
133a 166, 2010.
[6] M. Otto, aTwo variable first-order logic over ordered domains,a Journal of Symbolic Logic, vol.
66, no.
2, pp.
685a 702, 2001.
[7] D. Bresolin, D. Della Monica, V. Goranko, A. Montanari, and G. Sciavicco, aDecidable and undecidable fragments of Halpern and Shohamas interval temporal logic: towards a complete classification,a in Proc.
of the 15th International Conference on Logic for Programming, Artificial Intelligence, and Reasoning, ser.
LNCS, vol.
5330.
Springer, 2008, pp.
590a604.
[8] A. Montanari, G. Puppis, and P. Sala, aMaximal decidable fragments of Halpern and Shohamas modal logic of intervals,a in Proc.
of the 37th International Colloquium on Automata, Languages and Programming, 2010.
[9] J. van Benthem, The Logic of Time: A Model-Theoretic Investigation into the Varieties of Temporal Ontology and Temporal Discourse, Second Edition.
Kluver, 1991.
[10] I. Shapirovsky and V. Shehtman, aChronological future modality in Minkowski spacetime,a in Advances in Modal Logic.
London: Kingas College Publications, 2003, vol.
4, pp.
437a459.
[11] I. Shapirovsky, aOn PSPACE-decidability in Transitive Modal Logic,a in Advances in Modal Logic.
London: Kingas College Publications, 2005, vol.
5, pp.
269a287.
[12] E. Kieronski, J. Marcinkowski, and J. Michaliszyn, aB and D are enough to make the Halpern-Shoham logic undecidable,a in Proc.
of the 37th International Colloquium on Automata, Languages and Programming, 2010.
[13] K. Segerberg, aAn essay in classical modal logic,a Filosofiska Studier, vol.
13, 1971.
[14] L. J. Stockmeyer and A. Meyer, aWord problems requiring exponential time,a in Proc.
of the 5th ACM Symposium on the Theory of Computing, 1973, pp.
1a9.