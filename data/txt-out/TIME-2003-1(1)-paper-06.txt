Journal of Applied Logic 4 (2006) 119-140 www.elsevier.com/locate/jal  On the consistency problem for the IN DU calculus  Philippe Balbiani a,* , Jean-Francois Condotta b , Gerard Ligozat c a IRIT-CNRS, 118, route de Narbonne, 31062 Toulouse, France b CRIL-CNRS, Universite d'Artois, Faculte des sciences Jean Perrin, rue Jean Souvraz, 62307 Lens, France c LIMSI-CNRS, Universite de Paris-Sud, 91403 Orsay, France  Available online 20 July 2005  Abstract In this paper, we further investigate the consistency problem for the qualitative temporal calculus IN DU introduced by Pujari et al.
[A.K.
Pujari, G.V.
Kumari, A. Sattar, INDU: An interval and duration network, in: Australian Joint Conference on Artificial Intelligence, 1999, pp.
291-303].
We prove the intractability of the consistency problem for the subset of pre-convex relations, and the tractability of strongly pre-convex relations.
Furthermore, we also define another interesting set of relations for which the consistency problem can be decided by the -closure method, a method similar to the usual path-consistency method.
Finally, we prove that the -closure method is also complete for the set of atomic relations of IN DU implying that the intervals have the same duration.
(c) 2005 Elsevier B.V. All rights reserved.
Keywords: Qualitative temporal reasoning; Interval algebra; Qualitative constraint networks; Tractability   This paper is an improved version of the paper [P. Balbiani, J.-F. Condotta, G. Ligozat, On the consistency problem for the INDU calculus, in: IEEE (Ed.
), Proceeding of the Combined Tenth International Symposium on Temporal Representation and Reasoning and Fourth International Conference on Temporal Logic (TIME-ICTL 2003), Cairns, Queensland, Australia, 2003, pp.
203-211.
[2]].
* Corresponding author.
E-mail addresses: balbiani@irit.fr (P. Balbiani), condotta@cril.univ-artois.fr (J.-F. Condotta), ligozat@limsi.fr (G. Ligozat).
1570-8683/$ - see front matter (c) 2005 Elsevier B.V. All rights reserved.
doi:10.1016/j.jal.2005.06.002  120  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  1.
Introduction Temporal reasoning is a central task for numerous applications in many areas such as natural language understanding, specification and verification of programs and systems, scheduling, etc.
In the field of qualitative reasoning about temporal data, the framework proposed by Allen [1], the Interval Algebra (IA), is one of the best-known models.
Allen considers as basic temporal entities intervals of the time line and bases the IA calculus on 13 qualitative binary relations which correspond to all possible configurations between the four end-points of two intervals.
In the IA calculus, temporal information can be represented using constraint networks (interval networks) whose variables correspond to intervals and whose constraints are expressed by disjunctions of the basic relations (interval relations).
The consistency problem for interval networks is NP-complete.
A large amount of research in the recent past has been devoted to the study and characterization of tractable subclasses of the interval algebra (see for example [4,11]).
Now all tractable subclasses of IA are known.
More recently, a new qualitative formalism, called IN DU has been proposed by Pujari et al.
[7,8,12].
IN DU also considers intervals as temporal entities, but it adds information about the relative durations of the intervals considered to the information expressed by Allen's relations.
The resulting calculus has 25 basic relations corresponding to refinements of Allen's basic relations.
Each one of the 25 basic relations of IN DU can therefore be represented as a pair consisting of one of Allen's basic relations and of a basic relation of the Point Algebra (<, > or =), which expresses the relation between the durations.
From a structural point of view, IN DU and IA look very similar.
This first impression, however, is quite deceptive.
The real fact is that there exist numerous differences between the two formalisms.
In particular, contrary to the relations of IA, the relations of IN DU are not closed for the composition operation.
We also show that the consistency problem for IN DU networks whose constraints are atomic relations cannot be decided by means of the well known path-consistency method.
In this paper, we are mainly interested in the consistency problem for IN DU networks.
Our aim is to characterize several important tractable sets for this problem.
To this end we define the set of convex relations of IN DU (in a way which is different from that used by Pujari et al.
), the set of pre-convex relations, and a subset of the latter, the set of strongly pre-convex relations [3].
On the negative side, we prove that the consistency problem for IN DU networks whose constraints are pre-convex relations is NP-complete.
On the positive side, we show that strongly pre-convex relations can be expressed as conjunctions of Horn clauses [6] and, as a consequence, that the corresponding consistency problem is tractable.
We also show that the usual method based on path-consistency cannot be used for strongly pre-convex relations.
On the other hand, we define an interesting subclass of IN DU relations for which the consistency problem can be decided by means of that method.
Finally, we prove that the -closure method is also complete for the set of those atomic relations of IN DU that imply that the intervals have the same duration.
P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  121  2.
The IN DU calculus: an extension of IA 2.1.
The IN DU relations The framework introduced by Pujari et al.
[12], called IN DU , is an extension of the well-known Allen's calculus [1], the Interval Algebra (IA).
IA considers intervals of the line, and is based onto 13 binary relations.
Each relation corresponds to a particular relative position between two intervals.
An interval can be before (b), meet (m), overlap (o), contain (di), start (s), finish (f ), be equal to (eq), another interval (the remaining six relations correspond to the converses of the first six relations).
We denote by IA this set of 13 relations: IA = {b, bi, m, mi, o, oi, s, si, f, fi, d, di, eq}.
Vilain et al.
[14] have defined a similar but less expressive formalism, the Point Algebra formalism (PA).
PA is based onto three basic relations PA = {<, >, =}, corresponding to the three possible relative positions between two points of the line.
IN DU is based on 25 binary relations between intervals of the line.
Each one is defined as a pair of relations.
The first relation is a basic relation of IA and denotes the relative position satisfied by the two intervals, the second one is a basic relation of PA and corresponds to the relation satisfied by the durations of the two intervals.
Each basic relation of IN DU will be denoted by an expression i p where i [?]
IA and p [?]
PA. Two intervals x and y satisfy i p , denoted by x i p y, iff x i y and (x + - x - ) p (y + - y + ), where x - , y - (resp.
x + , y + ) are the lower (resp.
upper) endpoints of x and y.
For example, the intervals1 (1, 2) and (2, 4) satisfy the basic relation m< .
We denote by INDU the set of the 25 basic IN DU relations, INDU = {b< , b> , b= , bi< , bi> , bi= , m< , m> , m= , mi< , mi> , mi= , o< , o> , o= , oi< , oi> , oi= , s < , si> , d < , di> , f < , fi> , eq= }.
Any two intervals satisfy one and only one relation of INDU.
In the sequel, we will also consider other basic relations which we call virtual.
These particular basic relations are the unsatisfiable relations i p .
This set corresponds to {eq< , eq> , d = , d > , di= , di< , f = , f > , fi= , fi< , s = , s > , si= , si< }.
From the 25 basic relations of INDU, 225 relations can be defined.
Each one corresponds to an element of the power set of INDU, i.e., 2INDU .
Let r [?]
2INDU , and x and y be two intervals, x r y iff x a y for some a [?]
r. For instance, (1, 2) and (3, 4) satisfy the relation {b< , b= , m= , d < }.
The particular relation { } is called the empty relation (we will also denote this relation by [?]).
Each relation r [?]
2INDU can be seen as the disjunction of the basic relations which it contains.
A relation containing only one basic relation is also called an atomic relation.
Similarly, 2IA defines 213 interval relations and 2PA defines 23 relations.
In some cases, the constraint "two intervals x and y must satisfy a relation r [?]
INDU" can be expressed by a conjunction of Horn clauses.
A Horn clause [6] is a disjunction of literals (inequations or inequalities) of the following forms: c1 u1 + * * * + cn un  cn+1 un+1 +* * *+cn+k un+k or c1 u1 +* * *+cn un = cn+1 un+1 +* * *+cn+k un+k , with at most one literal using  (each ci is a rational number, each ui is a rational variable).
The basic relations belonging to INDU can be expressed by a conjunction of unitary Horn clauses (a unitary clause is a clause containing only one literal).
For example, the satisfaction of 1 We consider closed intervals of the rational number line.
Such an interval will be denoted by (a, b) with a and b two rational numbers satisfying a < b.
122  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  Fig.
1.
Geometrical representation of the basic relations of IN DU .
m< by two intervals x = (x - , x + ) and y = (y - , y + ) can be expressed by the following conjunction of unitary Horn clauses: (x -  x + ) [?]
(x - = x + ) [?]
(y -  y + ) [?]
(y - = y + )[?]
(x +  y - ) [?]
(y -  x + ) [?]
(x + - x -  y + - y - ) [?]
(x + - x - = y + - y - ).
A ORD Horn clause is a Horn clause which contains only literals of the forms u = v or u  v, with u, v two endpoints.
All relations of 2PA can be expressed by a conjunction of ORD Horn clauses, those of 2IA having this property are called the ORD Horn relations [11].
In the same way as for the basic relations of IA, the basic relations of IN DU can be represented by regions of the plane equipped with an orthogonal basis.
Each interval x = (x - , x + ) is represented by a point with coordinates (x - , x + ).
Given an interval of reference y = (y - , y + ), the region representing the basic relation a [?]
INDU, denoted by Reg(a, y), corresponds to the set of points {x = (x - , x + ): x a y}.
We obtain 25 convex regions partitioning the half plane H = {(x, y): y > x} (see Fig.
 1).
The geometrical representation of r [?]
2INDU is the region defined by Reg(r, y) = a[?
]r {Reg(a, y)}.
When the choice of the point of reference y is immaterial, we denote this region by Reg(r).
2.2.
The fundamental operations Similarly to the case of relations of IA and PA, we define operations for the relations of IN DU .
Considering a relation of 2INDU as a usual binary relation defined on intervals, the operations union ([?
]), intersection ([?
]), converse (-1 ) and composition (*) can be defined in the usual way: x(r [?
]s)y iff x r y and x s y; x(r [?
]s)y iff x r y or x s y; x(r * s)y iff [?
]z, x r z and z s y; x r -1 y iff y r x.
It is easy to show that r [?]
s = {a [?]
INDU: a [?]
r and a [?]
s}, r [?
]s = {a [?]
INDU: a [?]
r or a [?]
s}.
The converse of an atomic relation is an atomic relation,  -1 like for IA and PA, and {i p }-1 = {(i -1 )p }, with i p [?]
INDU.
Hence, r -1 = a[?
]r {a -1 }.
Hence, 2INDU is closed for [?
], [?]
and -1 .
The IN DU composition operation has an unusual behavior for a qualitative formalism.
Indeed, unlike IA and PA, 2INDU is not closed under  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  123  composition: consider the relation r = {m= }, the pair of intervals formed by (1, 2) and (3, 4) belongs to r * r as (1, 2) and (2, 3) satisfy m= , (2, 3) and (3, 4) satisfy m= .
Since (1, 2) and (3, 4) satisfy the relation b= , b= [?]
r * r. Now, given a pair of intervals (x, y) satisfying the basic relation b= , an interval z such that x m= z and z m= y may not exist.
For example, this is the case for x = (0, 1) and y = (4, 5).
So, the composition operation is inadequate for qualitative reasoning in IN DU since basic building blocks must be the basic relations.
It is necessary to define a weaker operation, sometimes called weak composition, for which 2INDU is closed; we will denote this operation by .
The operation  is defined as follows: Firstly, for atomic relations a, b [?]
INDU, a  b = {c [?]
INDU: [?
]x, y, z with x a z, z b y and x c y}; then, for arbitrary relations r, s [?]
2INDU , r  s =  INDU containing r * s. Note a[?]r,b[?
]s {a  b}.
Equivalently, r  s is the smallest relation of 2 that * and  are the same operations for IA and PA.
The operation  is not associative, for instance, ({bi> }  {mi> })  {m> } = {oi> , mi> , bi> } and {bi> }  ({mi> }  {m> }) = {bi> }.
As a result  cannot be used to define a relation algebra [13] on INDU.
We also define a binary operation corresponding to the Cartesian product of an interval relation and a point relation by: r x s = {i p : i [?]
r, p [?]
s}, with r [?]
2IA and s [?]
2PA .
This relation can contain virtual basic relations of IN DU .
Note that for i p , j q [?]
INDU, i p  j q = ((i * j ) x (p * q)) [?]
INDU.
The interval and point projections of an IN DU relation r, denoted respectively, by rI and rP are defined by rI = {i: i p [?]
r}, rP = {p: i p [?]
r}.
In the sequel we will say that a subset of relations of 2INDU is a subclass iff it is closed for the operations -1 , , and [?].
3.
Qualitative constraint networks 3.1.
Definitions Definition 1.
An IN DU constraint network is a pair N = (V , C), where: * V is a finite set {V1 , .
.
.
, Vn } (with n = |V |) of variables representing intervals of the line; * C is a mapping associating with each pair Vi , Vj [?]
V a constraint, denoted by Cij , defined by a relation of 2INDU .
We assume that Cij-1 = Cj i and Cii = {eq= }.
We define constraint networks on IA (interval networks) and on PA (point networks) in a similar way.
By definition, an atomic network is a network whose constraints are defined by atomic relations.
Definition 2.
Let N = (V , C) be a constraint network on IN DU with n = |V |.
An instantiation m of N is a mapping which associates an interval mi with each variable Vi [?]
V .
The basic relation of INDU satisfied by mi and mj will be denoted by mij .
The instantiation m will be called a consistent instantiation or a solution of N iff for every pair of variables Vi , Vj [?]
V , mij [?]
Cij .
In the case where N has a solution, N will be said consistent.
N is k-consistent (with k [?]
{1, .
.
.
, n}) iff any partial consistent instantiation on k - 1 variables can be extended to a new variable while remaining consistent.
N will be said  124  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  -closed iff for each i, j, k [?]
{1, .
.
.
, n}, Cij [?]
Cik  Ckj .
A subnetwork N  = (V  , C  ) is a network such that V  = V and Cij [?]
Cij for each pair of variables Vi and Vj .
A network N  = (V , C  ) is equivalent to N iff N and N  have the same solutions.
Given a constraint network, the main problem is to decide whether it admits a consistent instantiation.
This problem is called the consistency problem.
Given a set E [?]
2INDU (closed for converse and containing the relation {eq= }), the consistency problem for IN DU networks whose constraints belong to E will be denoted by Cons(E).
The consistency problem for interval networks being NP-complete, obviously Cons(2INDU ) is NP-hard.
Moreover, we will show in Section 4.2 that the consistency problem for atomic IN DU networks is a polynomial problem.
Hence, we can test the consistency of any IN DU network in exponential time by testing the consistency of all its atomic subnetworks.
As a consequence, we get the fact that Cons(2INDU ) is NP-complete.
We call -closure method, the method which consists in obtaining from a network N = (V , C) an equivalent and -closed subnetwork N  by iterating the operation Cij := Cij [?]
(Cik  Ckj ), for i, j, k [?]
{1, .
.
.
, |V |}, until a fixpoint is obtained.
This method can be implemented in O(n3 ) time (with n = |V |) by an algorithm similar to those used to obtain equivalent path-consistent constraint subnetworks from binary constraint networks [10].
3.2.
Consistency and the -closure method Given that the set 2INDU is not closed for the composition operation, several fundamental properties of networks of IA and PA are no longer true in the framework of IN DU .
Proposition 1.
Let N be a consistent IN DU network.
A 3-consistent network N  equivalent to N may not exist.
The atomic IN DU network depicted in Fig.
2(a) is -closed and consistent but it is not 3-consistent: consider the partial solution m(V1 ) = (1, 2), m(V3 ) = (3, 5).
This solution cannot be extended to V2 .
This network is consistent and does not admit an equivalent 3-consistent network.
Fig.
2.
(a) a consistent atomic network which is not 3-consistent, (b) an atomic network which is -closed but not consistent.
P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  125  Moreover, there are -closed atomic networks which are not consistent (for example, see Fig.
2(b)).
Consequently, we can state the following property: Proposition 2.
A -closed (atomic) IN DU network which does not contain the empty constraint is not necessarily consistent.
For IA it has been shown that the complexity of Cons(E), with E [?]
2IA , is the same as the complexity of Cons(E), with E the closure of E for the operations converse, intersection and composition.
The proof of this result is based on the fact that from an interval network whose constraints belong to E we can always build an equivalent network from E. If we replace the composition operation by , we can no longer prove this property for IN DU .
This is a consequence of the fact that if x (r  s) y then a third interval z such that x r z and z s y may not exist (a necessary property for building an equivalent network on E from the network on E).
Nevertheless, we can prove a weaker property: Proposition 3.
Let E [?]
2INDU be a subset of relations which is closed under the converse operation and which contains the atomic relation {eq= }.
Then Cons(E) is a polynomial problem (resp.
a NP-complete problem) if, and only if, Cons(E * ) is a polynomial problem (resp.
a NP-complete problem), where * denotes the closure for the intersection operation.
A proof of this proposition can be based on the fact that a constraint x (r0 [?]
* * * [?]
ri ) y in E * (with r0 , .
.
.
, ri [?]
E) can be replaced by the constraints x r0 y, x r1 z1 , .
.
.
, x ri zi , y {eq= } z1 , .
.
.
, y {eq= } zi , where z1 , .
.
.
, zi are new variables.
Hence, we have a polynomial reduction from Cons(E * ) to Cons(E).
In the sequel of this paper, we are going to characterize several sets of IN DU for which the consistency problem is polynomial.
Several cases of tractability can be obtained in a direct way from the tractable cases of IA.
For instance, we can state the following result: Proposition 4.
Let E [?]
2IA be a set for which the consistency problem is polynomial.
Let E  [?]
2INDU be defined by E  = {(r x {<, =, >}) [?]
INDU: r [?]
E}.
Then Cons(E  ) is polynomial.
The validity of this proposition is due to the fact that E and E  represent the same class of temporal constraints.
Indeed, the IN DU temporal constraint x ((r x {<, =, >}) [?]
INDU) y (with x, y two variables and r [?]
E) can be equivalently expressed by the temporal constraint of the interval algebra x r y.
Let us now establish less trivial tractability cases.
4.
Convex relations in the IN DU calculus 4.1.
Definition and representation In this section, we introduce a lattice structure on the set of basic IN DU relations, based on the similar structures for IA and PA [9] (see also [12]).
In [9] the interval lattice  126  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  Fig.
3.
(a) the interval lattice, (b) the point lattice, (c) the IN DU lattice.
(resp.
the point lattice) is defined by associating to each basic relation A a pair of integers (iA , jA ) (resp.
an integer iA ).
For example, the pair (1, 3) corresponds to the basic relation eq, while 1 corresponds to the basic relation = (see Fig.
3 for a complete description).
Using this correspondence, an ordering int (resp.
pt ) is defined on IA (resp.
on PA) by specifying that A int B iff iA  iB and jA  jB (resp.
iA  iB ).
We refer to the resulting structure (IA, int ) (resp.
(PA, pt )) as to the interval lattice (resp.
the point lattice).
Once the lattice has been defined, convex relations of IA (resp.
PA) correspond to intervals in the lattice2 (resp.
the point lattice) (see Fig.
3 (a) and (b)).
For example, the interval relation {o, s, fi, eq} and the point relation {<, =} are convex relations corresponding to the intervals [o, eq] and [<, =].
In a natural way, we define the IN DU lattice as the Cartesian product of the interval lattice and the point lattice (see Fig.
3).
This lattice is also defined on the virtual basic relations of IN DU .
We define the set of convex relations of 2INDU in the following way: Definition 3.
A relation r [?]
2INDU is a convex relation iff r = [min, max] [?]
INDU, where [min, max] an interval in the IN DU lattice.
For example, the relation {m< , m= , o< , o= } is a convex relation.
We denote by C the set of convex relations.
Remark that r [?]
2INDU is convex iff r = (s x t) [?]
INDU with s and t convex relations of 2IA and 2PA .
Hence from a geometrical point of view, a relation r of IN DU is a convex relation when its geometrical representation in the plane Reg(r) satisfies the following equality: [?
]h [?]
H, Reg(r) = (Proj1 (Reg(r)) x Proj2 (Reg(r))) [?]
h, where H = {Reg(INDU), Reg(INDU [?]
(IA x{<})), Reg(INDU [?]
(IA x{<, =})), Reg(INDU [?]
(IA x {>})), Reg(INDU [?]
(IA x {>, =})), Reg(INDU [?]
(IA x {=}))} and where Proj1 (resp.
Proj2 ) denote the projection functions on the horizontal axis (resp.
vertical axis).
2 Given a lattice (E, ), an interval is either the empty set or a set {e [?]
E: min  e  max} for some min, max [?]
E with min  max (this last set will be denoted by [min, max]).
P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  127  In the same way as for the convex relations of IA and of PA we have the following property for the convex relation of IN DU : Proposition 5.
A relation r [?]
INDU is a convex relation iff it can be expressed by a conjunction of unitary Horn clauses Ph such that if u = v [?]
Ph then u  v [?]
Ph or v  u [?]
Ph (where u and v denote endpoints or differences of endpoints).
Proof.
Let r [?]
INDU be a convex relation.
We know that r = (s x t) [?]
INDU where s and t are convex relations in 2IA and 2PA respectively.
Now s is a convex relation of 2IA which expresses the constraint concerning the relative position between the two intervals.
This constraint can be expressed by a conjunction of unitary Horn clauses Phs such that if u = v [?]
Phs then u  v [?]
Phs or v  u [?]
Phs (with u and v denoting endpoints).
In a similar way, the duration constraint between the two intervals is expressed by t a convex relation of 2PA .
Again, t can be also expressed by a conjunction of unitary Horn clauses Pht such that if u = v [?]
Pht then u  v [?]
Pht or v  u [?]
Pht (with u and v denoting differences of endpoints).
Let us remark that u and v denote differences of endpoints in Phs and endpoints in Pht .
Finally, we can define the required conjunction Ph by Phs [?]
Pht .
2 For example, consider the IN DU convex relation r = {m= , m< , o= , o< }.
We have r = (s x t) [?]
INDU with s = {m, o} and t = {<, =}.
The constraint x r y can be expressed by Phs = y -  x + [?]
x +  y + [?]
x -  x + [?]
y -  y + [?]
x + = y + [?]
x - = x + [?]
y - = y + .
The duration constraint t can be expressed by Pht = x + - x -  y + - y - .
Hence, the temporal constraint x r y can be expressed by the conjunction Phs [?]
Pht .
Notice that a convex relation of IN DU cannot always be represented by a conjunction of unitary ORD Horn clauses (see the previous example).
Pujari et al.
enumerate 227 convex relations.
Our definition, by contrast, results in 240 convex relations, this difference arising from the fact that Pujari et al.
use a lattice which does not take into account the virtual basic relations.
The set C is closed for -1 , [?
], but not for .
The closure for the intersection and converse follows directly from the definition.
The following example shows the instability of C for : {b< }  {d < , o< , o> , o= , s < } is the non-convex relation {b< , b> , b= , d < , o< , m< , s < }.
Some relations of C can be expressed by conjunctions of ORD Horn clauses.
This set of relations, denoted by CIA , corresponds to the 83 convex relations of IA.
CIA can be defined as follows: Definition 4.
Let r be a relation in 2INDU .
Then r [?]
CIA iff r satisfies one of the equivalent properties: * r = (s x {<, =, >}) [?]
INDU where s is a convex interval relation, * r = [a < , b> ] [?]
INDU, where [a < , b> ] is an interval of the IN DU lattice (a, b [?]
IA).
Given that the set CIA corresponds to the set of convex interval relations, the operation  on CIA corresponds to the composition operation *.
As a further consequence, CIA is a subclass.
128  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  4.2.
Tractability of the convex IN DU relations The convex IN DU relations can be represented by conjunctions of unitary Horn clauses; as a consequence, the consistency problem of the convex IN DU networks (IN DU networks whose constraints are convex) is polynomial.
Indeed, we can translate this kind of network into conjunctions of Horn clauses and apply a resolution algorithm such as the algorithm proposed by Koubarakis [6].
Notice that we can also use the Simplex algorithm or Kachian's algorithm for solving these particular constraints (as a consequence of Proposition 5).
Proposition 6.
Cons(C) is a polynomial problem.
It is well known that the path-consistency method can be used to solve the consistency problem of the convex interval networks.
Hence, Cons(CIA ) can be decided by the -closure method.
5.
The pre-convex IN DU relations The maximal tractable set of IA containing the 13 atomic interval relations is the set of pre-convex interval relations, which is identical with the set of ORD Horn interval relations.
To define the pre-convex relations of IN DU we use the method introduced by Ligozat [9] by extending the notions of convex closure and dimension to IN DU .
For the interval algebra, the dimension of an interval relation corresponds to the dimension of the geometrical representation of this region in the plane.
This dimension is the maximal dimension of the dimensions of the basic relations it contains.
In a similar way, we have the following definition: Definition 5.
Let a [?]
INDU.
The dimension of a, denoted by dim(a), is the dimensional space of Reg(a).
If r [?]
2INDU is a non-empty relation, dim(r) = max{dim(a): a [?]
r}.
As usual, we define dim({}) as -1.
As an illustration, we have dim(m= ) = 0, dim(s < ) = 1, dim(b> ) = 2 and dim({m= , o< }) = max{0, 2} = 2.
Definition 6.
The convex closure of an INDU relation r, denoted by I (r), is the smallest convex relation of C containing r: I (r) = {s [?]
C: r [?]
s}.
Notice that this definition makes sense because the set C is closed under intersection.
The convex closure in IN DU can be computed from the convex closures in IA and PA.
Indeed, we have I (r) = (I (rI ) x I (rP )) [?]
INDU for all relations r [?]
2INDU .
Now, we can define the pre-convex relations of IN DU : Definition 7.
Let r [?]
2INDU .
Then r is a pre-convex relation iff r = { } or dim(I (r) \ r) < dim(r).
P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  129  We denote by P the set of pre-convex IN DU relations.
P contains 88096 relations.
The set of convex relations C is a subset of P. The set P is closed under -1 , but not closed under the operations [?]
and : consider the pre-convex IN DU relations r = {eq= , b< , b= , o< }, s = {eq= , b> , b= , o> }, t = {b< } and u = {d < , o< , o> }.
Then the relations r [?]
s = {eq= , b= } and t  u = {b< , b> , b= , d < , o< , m< , s < } are not pre-convex relations.
5.1.
Intractability of the pre-convex IN DU relations In this section we prove that the consistency problem for P is NP-complete.
In order to do so, we define a polynomial reduction from the 3-coloring problem of a graph [5] to Cons(P * ).
Proposition 7.
Cons(P * ) is a NP-complete problem.
Proof.
Let G = (S, A) be a non-oriented graph, with S a set of vertices and A a set of edges between these vertices.
We build an IN DU network N = (V , C) in the following way: V is a set of variables corresponding to the union of Col = {Col1 , Col2 , Col3 } and VS = {S1 , .
.
.
, Sn } with n = |S|.
Each variable of Col is associated with a color.
Each variable Si [?]
VS is associated with a vertex si [?]
S. The constraints of N between the three variables of Col are given in Fig.
4(a).
Those between two variables Si and Sj such that (si , sj ) [?]
A (resp.
[?]
/ A) are given in Fig.
4(b) (resp.
(c)).
We can check that these constraints belong to P * .
For example, the relation {m= , eq= , mi= } is the intersection of the preconvex relations {o> , di> , oi> , m= , eq= , mi= } and {o< , d < , o< , m= , eq= , mi= }.
We can prove that G = (S, A) is 3-colorable iff N is consistent: given a solution of the 3-coloring problem for G, we assign to each variable Si the interval corresponding to the color assigned to the vertex si .
Conversely, to obtain a solution of the 3-coloring problem for G from a solution of N , we assign to the vertex si the color corresponding to the interval assigned to Si .
2  Fig.
4.
The constraints of N = (V , C).
130  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  As a consequence of this proposition and Proposition 3 we obtain: Theorem 1.
Cons(P) is a NP-complete problem.
6.
The strongly pre-convex IN DU relations Balbiani et al.
have proved that for the strongly pre-convex generalized interval relations the consistency problem is polynomial [3].
Following the line of reasoning given by Balbiani et al., we define the strongly pre-convex relations of IN DU .
Definition 8.
Let r [?]
2INDU .
Then r is strongly pre-convex iff for each convex relation t [?]
C, the relation r [?]
t is a pre-convex relation.
The definition of the strongly pre-convex relations is guided by the desire to obtain a subset of pre-convex relations closed under the intersection operation.
F will denote the set of strongly pre-convex relations of IN DU .
It has 45792 elements.
Proposition 8.
The set F is closed3 under the operations -1 , [?
], but not closed under .
As a counter-example, consider the strongly pre-convex relations r = {b< } and s = r  s is the relation {b< , b> , b= , d < , o< , m< , s < } which is not a strongly pre-convex relation.
{d < , o< , o> },  6.1.
Tractability of the strongly pre-convex IN DU relations This section is devoted to the properties of the strongly pre-convex IN DU relations in relation to the consistency problems.
Proposition 9.
The strongly pre-convex IN DU relations can be represented by conjunctions of Horn clauses.
Proof.
Let r [?]
F .
As I (r) is convex, there exists a conjunction of Horn clauses representing it.
Denote by PhI (r) such a conjunction.
In the general case, PhI (r) is too permissive.
Indeed, each basic relation a [?]
I (r) \ r is realizable w.r.t.
PhI (r) .
We must forbid these basic relations, without forbidding the basic relations of r. For each such a [?]
I (r) \ r, we exhibit a Horn clause, denoted by Pha , such that the addition of Pha to Ph excludes the satisfaction of a without excluding that of the atomic relations belonging to r. Since r is pre-convex, then dim(I (r) \ r) < dim(r), hence dim(a) < dim(r).
Consequently, dim(a) = 1 or 0.
Let us first consider the basic relations which do not impose equality on the durations.
Phm< = (x + = y - [?]
x + - x -  y + - y - ), 3 A computer-program has been used to prove this result, as well as for the future Proposition 10.
P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  131  Phm> = (x + = y - [?]
x + - x -  y + - y - ), Phmi< = (y + = x - [?]
x + - x -  y + - y - ), Phmi> = (y + = x - [?]
x + - x -  y + - y - ), Phs < = (x - = y - [?]
x + - x -  y + - y - ), Phsi> = (x - = y - [?]
x + - x -  y + - y - ), Phf < = (x + = y + [?]
x + - x -  y + - y - ), Phf i > = (x + = y + [?]
x + - x -  y + - y - ).
Next, consider the basic relations imposing equality of the durations.
These atomic relations belong to the convex relation s = {eq= , b= , bi= , o= , oi= , m= , mi= }.
As a consequence, Pha will always contain x + - x - = y + - y - (except for Pheq ).
Phb= = (x + - x - = y + - y - [?]
x +  y - ), Phbi= = (x + - x - = y + - y - [?]
y +  x - ), Phm= = (x + - x - = y + - y - [?]
x + = y - ), Phmi= = (x + - x - = y + - y - [?]
y + = x - ), Pheq= = (x - = y - [?]
x + = y + ).
The cases of the basic relations o= and oi= remain to be examined.
Consider the case a = o= (the case oi= is similar).
Suppose that r [?]
{b= , m= } = [?]
and r [?]
{eq= , mi= , oi= , bi= } = [?].
Hence a [?]
I (r [?]
s).
Moreover, we know that a [?]
/ r. As a consequence dim(I (r [?]
s) \ (r [?]
s))  1.
Since r [?]
s [?]
s and dim(s) = 1, dim(I (r [?]
s) \ (r [?]
s))  1.
Hence, dim(r [?]
s)  dim(I (r [?]
s) \ (r [?]
s)) and r [?]
s is not pre-convex.
This is a contradiction (r is a strongly pre-convex relation).
Hence, only three cases have to be considered: * r [?]
s = [?].
Then Pho= is x + - x - = y + - y - ,  y+ - * r [?]
{b= , m= } = [?]
and r [?]
{eq= , mi= , oi= , bi= } = [?].
Then Pho= is x + - x - = - + - y [?
]x y ,  y+ - * r [?]
{b= , m= } = [?]
and r [?]
{eq= , mi= , oi= , bi= } = [?].
Then Pho= is x + - x - = - + + y [?
]x y .
Using the clauses defined above, any r [?]
F can be represented by the conjunction of fi Horn clauses PhI (r) [?]
a[?
](I (r)\r) Pha .
2 As a consequence, we get: Theorem 2.
Cons(F) is a polynomial problem.
7.
The tractable subclass G In this section we characterize a new subset of pre-convex relations for which the closure method gives a decision method for the consistency problem (contrarily to what is  132  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  the case for F ).
We will denote this set by G. The definition of G was guided by our desire to obtain pre-convex relations forming a subclass for which the convex closures are convex interval relations.
Definition 9.
Let r [?]
2INDU .
Then r belongs to G iff for each convex relation s [?]
CIA r [?]
s is a pre-convex relation and I (r [?]
s) is a convex relation which belongs to the set CIA .
The set G forms a subclass containing 11854 relations.
Proposition 10.
The set G is closed for the operations -1 , [?]
and .
Since the universal relation INDU (that is, the set I NDU ) belongs to CIA , each relation of G is a pre-convex relation.
Moreover, we notice that some relations of G are not strongly pre-convex.
For example, the relation {eq= , d < , di> , o< , o> , oi< , oi> , m< , m> , m= , mi< , mi> , mi= } belongs to G but is not strongly pre-convex: indeed its intersection with the convex relation {eq= , o= , oi= , m= , mi= } is not a pre-convex relation.
7.1.
Tractability of G We are now in a position to prove the tractability of the consistency problem for the set G, using the notion of maximal solution introduced by Ligozat in [9].
Given a solution m of a network N = (V , C), m will be said maximal if dim(mij ) = dim(Cij ) for all i, j [?]
1, .
.
.
, |V |.
Intuitively, a maximal solution is a solution which involves basic relations imposing as few equalities--between endpoints and difference of endpoints--as possible.
For example, given the constraint x {m= , m> , o= , o< , b> } y, a maximal solution will satisfy o< or b> between x and y. Firstly, we prove the following result: Proposition 11.
Let N = (V , C) a IN DU network whose constraints belong to CIA (with the exclusion of the empty relation).
If N is -closed then N admits a maximal solution.
Proof.
CIA corresponds to the convex relations of IA.
Let N  = (V , C  ) be the convex interval network equivalent to N .
From [9] we know that N  admits a solution m1 , .
.
.
, mn (with n = |V |) such that a = b, with a and b two endpoints of mi and mj , iff all basic relations belonging to Cij impose this equality (m is a maximal solution for IA).
For -   example, we have m- i = mj iff all basic relations of Cij impose this equality.
Cij could be the relation {s, eq, si} but could not be the relation {s, eq, f, d} since d does not impose the - equality m- i = mj .
We can modify m to obtain a solution s having the additional property: si+ - si- = sj+ - sj- iff Cij = {eq= }.
Consider the lower endpoint m- i , let l be the number - - of endpoints located before mi .
We assign to si the value l/(1 + l).
We treat in a similar way the upper endpoints.
s satisfies the properties fixed previously.
Hence, we obtain a maximal solution s of N = (V , C).
2 Proposition 12.
Let r, s [?]
INDU such that I (r  s), I (r) and I (s) [?]
CIA .
We have I (r  s) [?]
I (r)  I (s).
P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  133  Proof.
r [?]
I (r) and s [?]
I (s).
Hence r s [?]
I (r)I (s).
Consequently, I (r s) [?]
I (I (r) I (s)).
As CIA is closed for the operation , I (r)  I (s) is a convex relation.
Hence, I (I (r)  I (s)) = I (r)  I (s).
Hence, I (r  s) [?]
I (r)  I (s).
2 Proposition 13.
Let N = (V , C) be a network whose constraints belong to G. Let N I = (V , C I ) be defined by CijI = I (Cij ) for all i, j [?]
{1, .
.
.
, n}, with n = |V |.
If N is -closed then N I is -closed.
Proof.
Let Vi , Vj , Vk [?]
V .
Cij [?]
Cik  Ckj , consequently, I (Cij ) [?]
I (Cik  Ckj ).
We know that G is closed for the operation .
Hence, I (Cik  Ckj ) [?]
CIA .
Moreover, by definition of G, I (Cik ) and I (Ckj ) [?]
CIA .
From Proposition 12, we get that I (Cik  Ckj ) [?]
I (Cik )  I (Ckj ).
Using this result, we deduce that I (Cij ) [?]
I (Cik )  I (Ckj ).
2 Now, we can establish the main result concerning the set G. Theorem 3.
Cons(G) can be decided by means of the -closure method.
Proof.
Let N = (V , C) be a network containing constraints belonging to G. By using the -closure method on N we obtain an equivalent subnetwork N  = (V , C  ).
The constraints of N  belong to G since G is closed for the three operations -1 , [?]
and .
If N  contains the empty constraint, then N is not consistent.
In the opposite case, let us show that N  (and consequently N ) is consistent.
Let N  = (V , C  ) be defined by Cij = I (Cij ).
N  is closed (Proposition 13).
It admits a maximal solution m (Proposition 11).
This solution m is also a maximal solution of N  .
This is due to the fact that dim(I (Cij ) \ Cij ) < dim(Cij ) (see definition of G), for each pair of variables Vi and Vj .
2 Hence, we have characterized a set for which the -closure method is complete.
8.
The atomic relations of INDU= In the previous section we showed that the -closure solves the consistency problem  Cons(G).4 On the other hand, we know that for the general case, the -closure method is  not complete for the consistency problem of the atomic networks of IN DU .
In this section, we show that this method is complete for the atomic relations which imply the equality of the durations of the intervals.
In the sequel, we will denote by INDU= the subset of the basic relations of IN DU implying the equality between the durations of two intervals, that is INDU= = {eq= , b= , bi= , m= , mi= , o= , oi= }.
Notice that the atomic relations defined from INDU= , excepted {eq= }, are convex relations of IN DU which do not belong to the set CAI .
Given an IN DU constraint network N = (V , C), we will denote by N IA the interval constraint network (V , C IA ) defined as follows: for each i, j [?]
1, .
.
.
, |V |, CijIA = {i: i p [?]
4 Note that the only basic IN DU relations belonging to G are {eq= }, {d < }, {di> }, {f < }, {f i > }, {s < }, {si > }.
134  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  Cij }.
Similarly, we will denote by N PA the point constraint network (V , C PA ) defined as follows: for each i, j [?]
1, .
.
.
, |V |, CijPA = {p: i p [?]
Cij }.
The constraint networks N IA and N PA are, respectively, the projection of N onto the Interval Algebra and the projection of N onto the Point Algebra.
In the general case, it is clear that the consistency of N IA and the one of N PA do not imply the consistency of N .
The projection operation retains the property of -closure: Proposition 14.
Let N = (V , C) an IN DU constraint network.
If N is a -closed network then N IA and N PA are -closed networks (and also *-closed networks).
Proof.
Denote by n the number of elements of the set V .
Let i, j, k [?]
1, .
.
.
, n. Let a [?]
CijIA (resp.
b [?]
CijPA ), there exists b [?]
PA (resp.
a [?]
IA) such that a b [?]
Cij .
By definition of the operation  and by -closure of N , for each basic relation a b [?]
Cij , there exist cd [?]
Cik and ef [?]
Ckj such that a b [?]
(cd  ef ).
Moreover, cd  ef = ((c * e) x (d * f )) [?]
INDU.
IA IA PA PA Hence a [?]
(c * e) and b [?]
(d * f ).
By projection, c [?]
Cik , e [?]
Ckj , d [?]
Cik and f [?]
Ckj .
IA IA PA PA IA IA IA PA Consequently, a [?]
(Cik * Ckj ) and b [?]
(Cik * Ckj ).
Hence Cij [?]
(Cik * Ckj ) and Cij [?]
PA PA * Ckj ).
Hence, N IA and N PA are *-closed networks.
For the Interval Algebra and the (Cik Point Algebra, the operations * and  are the same operations, consequently, N IA and N PA are -closed networks too.
2 Now, we are going to prove that some particular interval constraint networks admit solutions enforcing a common duration for all intervals.
Proposition 15.
Let N = (V , C) an atomic network of the Interval Algebra such that each constraint is formed by one basic relation belonging to the set S = {eq, m, mi, b, bi, o, oi}.
If N is a *-closed network (and does not have the empty relation as a constraint) then N admits a consistent instantiation s such that s (Vi )+ - s (Vi )- = s (Vj )+ - s (Vj )- for all Vi , Vj [?]
V .
Proof.
Let N = (V , C) be an atomic interval constraint network such that Cij = {A} with A [?]
{eq, m, mi, b, bi, o, oi}.
Suppose that N is a *-closed network.
As N is *closed and atomic we know that there exists a consistent instantiation s  of N [11].
From this instantiation, we build a new consistent instantiation, denoted by s , using uniquely intervals with same duration, as follows: Without loss of generality, we suppose that the variables V = V1 , .
.
.
, Vn are such that if si + < sj + then i < j , for all i, j [?]
1, .
.
.
, n. Thus, if i < j , then, Cij [?]
{eq, m, b, o}.
In the sequel of this proof we will denote by T the interval relation {eq, m, b, o} and d will denote the difference s1 + - s1 - .
Moreover, we define the sets ElA , with A [?]
{eq, b, m, o, oi, mi, bi} and l [?]
1, .
.
.
, n, by ElA = {i [?]
1, .
.
.
, l - 1: Cil = {A}}.
Let the instantiation s defined in the following way: * s1 = s1 , * for each k [?]
2, .
.
.
, n, - if Ck-1k = {eq} then sk = sk-1 , + + - if Ck-1k = {m} then sk = (sk-1 , sk-1 + d),  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  135  + + - if Ck-1k = {b} then sk = (sk-1 + d, sk-1 + 2d), - if Ck-1k = {o} then if Ekm = [?]
then sk = (si+ , si+ + d), with i = min Ekm , + + else sk = ((u + v)/2, (u + v)/2 + d), with v = smin E o and u = s  the case where  (Ekb  o ) = [?]
[?]
Ek-1  else  - u = sk-1 .
k  o ) max(Ekb [?
]Ek-1  in  Let us prove that the instantiation s satisfies the properties required.
Firstly, we can remark that for all k [?]
1, .
.
.
, n, sk+ - sk- = d. Hence, all the intervals used in the instantiation s have the same duration.
Now, we show that s is a consistent instantiation of N = (V , C).
Let P be the property defined by P (k) (with k [?]
1, .
.
.
, n) be satisfied if, and only if, the partial instantiation s1 , .
.
.
, sk is a consistent instantiation of the network N .
P (1) is trivially true.
Let k [?]
2, .
.
.
, n, suppose that P (k - 1) is true, we show that the property P is satisfied for k. We know that the constraint Ck-1k is a atomic relation such that Ck-1k [?]
T .
Examine all possible cases concerning the constraint Ck-1k .
* Ck-1k = eq.
We have sk = sk-1 .
Hence, sk-1 Ck-1k sk .
Moreover, for each l [?]
1, .
.
.
, k - 2, from the *-closure of N , we have Clk [?]
Clk-1 * Ck-1k .
Moreover, Clk-1 * Ck-1k = Clk-1 * {eq} = Clk-1 .
Since the constraints of N are atomic relations, Clk = Clk-1 .
As P (k - 1) is true, sl Clk-1 sk-1 .
From the fact that sk-1 = sk and Clk-1 = Clk , we deduce that sl Clk sk .
+ + , sk-1 + d).
Consequently, we have sk-1 Ck-1k sk .
* Ck-1k = m. Hence, sk = (sk-1 From the *-closure of N , we have Clk [?]
Clk-1 * Ck-1k for each l [?]
1, .
.
.
, k - 2.
Moreover, Clk-1 [?]
{eq, m, b, o} and Ck-1k = {m}.
Since {eq, m, b, o} * {m} = {m, b}, we obtain the inclusion Clk [?]
{m, b}.
Consider the two possible cases for Clk : * Clk = {b}.
From the *-closure of N , we have Clk-1 [?]
Clk * Ckk-1 .
Hence, Clk-1 [?]
{b} * {mi}.
Since {b} * {mi} = {b, m, o, d, s} and Clk-1 [?]
T we can assert that Clk-1 [?]
{b, m, o}.
As P (k - 1) is satisfied, we have sl Clk-1 sk-1 .
Consequently, + + .
Moreover, remember that sk-1 = sk- .
We deduce that sl+ < sk- .
We sl+ < sk-1 can conclude that sl {b} sk and hence, sl Clk sk .
* Clk = {m}.
From the *-closure of N , we have Clk-1 [?]
Clk * Ckk-1 .
Hence, Clk-1 [?]
{m} * {mi}.
From the fact that {m} * {mi} = {f, fi, eq} and Clk-1 [?]
T we get that Clk-1 = {eq}.
Since P (k - 1) is satisfied, we have sl Clk-1 sk-1 .
Consequently, + = sk- .
We conclude that sl {m} sk and sl = sk-1 .
Moreover, remember that sk-1 hence, sl Clk sk .
+ + + d, sk-1 + 2d).
Consequently, sk-1 Ck-1k sk .
From * Ck-1k = b.
Hence sk = (sk-1 the *-closure of N , for each l [?]
1, .
.
.
, k - 2, we get Clk [?]
Clk-1 * Ck-1k .
Hence, Clk [?]
T * {b}.
From the fact that {eq, m, b, o} * {b} = {b} we can deduce that Clk = {b}.
As P (k - 1) is true, sl Clk-1 sk-1 .
From the fact that Clk-1 [?]
{eq, m, b, o}, we get + + .
Moreover, notice that sk-1 < sk- .
Hence, we can assert that sl+ < sk- .
sl+  sk-1 Consequently, sl {b} sk and hence, sl Clk sk .
* Ck-1k = o.
We must take into account two possible cases: the case where Ekm = [?]
and the case where Ekm = [?].
136  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  * Ekm = [?].
Let i = min Ekm (notice that 1  i < k and Cik = {m}).
We have sk = (si+ , si+ + d).
Let l [?]
1, .
.
.
, k - 1.
We know that Clk [?]
T .
Examine all possible cases concerning Clk .
* Clk = {eq}.
From the *-closure of N , we deduce that Cil [?]
Cik * Ckl .
Hence, Cil [?]
{m} * {eq}.
Moreover, {m} * {eq} = {m}.
Consequently, Cil = {m}.
Since P (k - 1) is satisfied, si msl .
Hence, sl- = si+ .
As the duration of sl is d, sl = (si+ , si+ + d).
Consequently, sl = sk and hence, sl {eq} sk .
We deduce that sl Clk sk .
* Clk = {m}.
From the *-closure of N , Cil [?]
Cik * Ckl .
Consequently, Cil [?]
{m} * {mi}.
From the fact {m} * {mi} = {f, fi, eq} and Cil [?]
S, we can assert that Cil = {eq}.
Since P (k - 1), si {eq} sl .
Hence, sl = si .
As sk- = si+ , we have sk- = sl+ .
Consequently, sl {m} sk and hence, sl Clk sk .
* Clk = {b}.
From the *-closure of N , we can deduce that Cil [?]
Cik * Ckl .
Consequently, Cil [?]
{m} * {bi}.
Moreover, {m} * {bi} = {bi, oi, mi, di, si} and, we know that Cil [?]
S. Hence, Cil [?]
{bi, oi, mi} and Cli [?]
{b, o, m}.
Since the property P (k - 1) is true, we have sl Cli si .
Consequently, we can assert that sl+ < si+ .
As sk- = si+ , we get that sk- > sl+ .
Consequently, sl b sk .
* Clk = {o}.
From the *-closure of N , Cil [?]
Cik * Ckl .
Consequently, Cil [?]
{m} * {oi}.
{m} * {oi} = {o, d, s} and moreover, we know that Cil [?]
S. Hence, Cil = {o}.
As the property P (k - 1) is true, we have si Cil sl .
Consequently, we can assert that si- < sl- < si+ < sl+ , with sl+ - si+ < d. Moreover, we know that sk = (si+ , si+ + d).
Hence, sl- < sk- < sl+ < sk+ .
Consequently, sl {o} sk .
Hence, sl Clk sk .
* Ekm = [?].
Denote by i the element corresponding to min Eko .
Notice that i exists since o = [?]
and the Ck-1k = {o}.
Two cases must be considered: the case where Ekb [?]
Ek-1 b o case where Ek [?]
Ek-1 = [?].
- - o = [?].
Hence, sk = ((si+ + sk-1 )/2, (si+ + sk-1 )/2 + d).
From * Ekb [?]
Ek-1 the *-closure of N , we can deduce that Cik-1 [?]
Cik * Ckk-1 .
Consequently, Cik-1 [?]
{o} * {oi}.
From the fact that {o} * {oi} = {o, oi, d, s, f, di, si, fi, eq} and Cik-1 [?]
T (since i  k - 1).
We deduce that Cik-1 [?]
{o, eq}.
Conse- + + - < si+  sk-1 , with sk-1 - sk-1 = si+ - si- = d. As quently,we have si-  sk-1 + - + - - sk = ((si + sk-1 )/2, (si + sk-1 )/2 + d) we can assert that si-  sk-1 < sk- < + + + si  sk-1 < sk .
Let l [?]
1, .
.
.
, k - 1.
Consider all possible cases concerning the constraint Clk .
We know that Clk [?]
T , hence, we must consider four cases.
- Clk = {eq}.
From the *-closure of N , we can deduce that Clk-1 [?]
Clk * Ckk-1 .
Consequently, Clk-1 [?]
{eq} * {oi}, hence, Clk-1 = {oi}.
Consequently, sl + >  + .
This implies that l > k - 1.
This is a contradiction.
sk-1 - Clk = {m}.
By hypothesis, Ekm = [?].
This is a contradiction.
- Clk = {b}.
From the *-closure of N , Clk-1 [?]
Clk * Ckk-1 .
We deduce that Clk-1 [?]
{b} * {oi}.
Moreover, {b} * {oi} = {b, o, m, d, s} and we know that Clk [?]
T .
Consequently, Clk-1 [?]
{b, o, m}.
In the case where Clk-1 [?]
{b, m}, - .
from the fact that P (k - 1) is true, we have sl {b, m} sk-1 .
Hence, sl+  sk-1 - - + - As sk > sk-1 , we have sl < sk .
Hence, we can assert that sl {b} sk and  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  137  hence, sl Clk sk .
Now, suppose that Clk-1 = {o} (notice that in this case l < o = [?].
This is a contradiction.
k - 1).
Hence, Ekb [?]
Ek-1 - Clk = {o}.
By definition of i we have i  l. Hence, i  l  k -1.
Consequently, Cil [?]
T and Clk-1 [?]
T .
As the property P (k - 1) is satisfied, we have si Cil sl - + and sl Clk-1 sk-1 .
Hence, si-  sl-  sk-1 and si+  sl+  sk-1 .
More- - - + + + over, remember us that si  sk-1 < sk < si  sk-1 < sk .
Consequently, - + we have si-  sl-  sk-1 < sk- < si+  sl+  sk-1 < sk+ .
We deduce that sl {o} sk .
Hence, sl Clk sk .
o * Ekb [?]
Ek-1 = [?].
We deduce that sk = ((si+ + sj+ )/2, (si+ + sj+ )/2 + d), with o ).
As in the previous case we have C j = max(Ekb [?]
Ek-1 ik-1 [?]
{o, eq} and - - + + + - + hence si  sk-1 < si  sk-1 with sk-1 - sk-1 = si - si- = d. Moreover, from the *-closure of N , we deduce that Cij [?]
Cik-1 * Ck-1j .
We o .
Hence, C [?]
{o, eq} * {oi}.
Moreover, have Ck-1j = {oi} since j [?]
Ek-1 ij {o, eq} * {oi} = {eq, o, oi, s, si, f, fi, d, di}.
We know that Cij [?]
S. Consequently, we can assert that Cij [?]
{eq, o, oi}.
Similarly, from the *-closure of N , we have Cij [?]
Cik * Ckj .
Ckj = {bi} since j [?]
Ekb and Cik = {o} since i [?]
Eko .
Consequently, Cij [?]
{o} * {bi}.
Moreover, {o} * {bi} = {bi, oi, di, mi, si} and Cij [?]
S. Hence, Cij [?]
{bi, oi, mi}.
It results that Cij [?]
{eq, o, oi} [?]
{bi, oi, mi}.
Hence, we have Cij = {oi}.
As P (k - 1) is true, we have si Cij sj .
It fol- + < sj+ < sk-1 since lows that sj- < si- < sj+ < si+ .
Moreover, sj- < sk-1 - - + + Cj k-1 = {o}.
Recall that si  sk-1 < si  sk-1 .
Putting these facts together, - + we can deduce that sj- < si-  sk-1 < sj+ < si+  sk-1 .
Moreover, we know + + + that sj = si = sk-1 = d and sk = ((si + sj )/2, (si + sj+ )/2 + d).
Hence, - + sj- < si-  sk-1 < sj+ < sk- < si+  sk-1 < sk+ .
We deduce that sk-1 {o}sk and hence, sk-1 Ck-1k sk .
Let l [?]
1, .
.
.
, k - 2.
Examine all possible cases concerning the constraint Clk .
We know that Clk [?]
T , hence, we must consider four possible cases.
- Clk = {eq}.
From the *-closure of N , we deduce that Clk-1 [?]
Clk * Ckk-1 .
Hence, Clk-1 [?]
{eq} * {oi}.
Since {eq} * {oi} = {oi}, we have Clk-1 = {oi}.
+ and hence, l > k - 1.
This is a contradiction.
Consequently, sl + > sk-1 - Clk = {m}.
By hypothesis, Ekm = [?].
This is a contradiction.
- Clk = {b}.
From the *-closure of N , Clk-1 [?]
Clk * Ckk-1 .
Hence, Clk-1 [?]
{b} * {oi}.
Moreover, {b} * {oi} = {b, o, m, d, s} and Clk-1 [?]
T .
Consequently, Clk-1 [?]
{b, o, m}.
Consider the two following cases: o ).
By definition of j , we have * Clk-1 = {o}.
We deduce that l [?]
(Ekb [?]
Ek-1 l  j .
Hence, Clj [?]
T .
Moreover, sl Clj sj .
Hence, sl- < sj- and sl+ < sj+ .
Since sj+ < sk- , we can assert that sl {b} sk .
Consequently, sl Clk sk .
* Clk-1 = {b, m}.
As the property P (k - 1) is true, we have sl Clk-1 sk-1 .
- - Hence, sl+  sk-1 .
Moreover, sk-1 < sk- .
Hence, we can assert that sl+ < - sk .
Hence, sl {b} sk .
Consequently, sl Clk sk .
- Clk = {o}.
From the *-closure of N , Clk-1 [?]
Clk * Ckk-1 .
Hence, Clk-1 [?]
{o} * {oi}.
Moreover, {o} * {oi} = {o, oi, d, s, f, di, si, fi, eq} and Clk-1 [?]
S. We  138  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  deduce that Clk-1 [?]
{o, oi, eq}.
The case Clk-1 = {oi} is not possible since l < k - 1.
We must still examine two cases: * Clk-1 = {eq}.
As P (k - 1) is true, we have sl Clk-1 sk-1 .
Hence, sl = sk-1 .
Moreover, we know that sk-1 {o} sk .
We deduce that sl Clk sk .
* Clk-1 = {o}.
As the property P (k -1) is true, we have sl Clk-1 sk-1 .
Hence, - + - + sl- < sk-1 < sl+ < sk-1 .
Moreover, we know that sk-1 < sk- < sk-1 < + - - + + sk .
Consequently, sl < sk and sl < sk .
Moreover, recall that the integer i is defined by i = min Eok and sk- < si+ .
From the fact that Clk = {o} we have l [?]
Eok .
Hence, i  l. Consequently, Cil [?]
T and, as property P (k - 1) is true, we can assert that si+  sl+ .
Putting everything together, we get the fact that sk- < sl+ and hence, sl- < sk- < sl+ < sk+ .
We conclude that sl et sk satisfy the relation {o}.
2 We can now state the main result of this section.
Theorem 4.
Let N = (V , C) be a network on IN DU whose constraints are atomic relations defined from INDU= .
If N is closed by  and does not contain the empty relation as a constraint then N is consistent.
Proof.
Let N = (V , C) be an atomic constraint network of INDU= .
Let us suppose that N is -closed and does not contain the empty relation.
N IA is a *-closed network (Proposition 14) and moreover, we cannot have the empty relation as constraint.
We can notice that the basic relations of N IA belong to the relation S = {eq, m, mi, b, bi, o, oi}.
Hence, N IA admits a consistent instantiation s which assigns to the variables intervals with common duration.
s is a consistent instantiation of N .
2 Hence, the -closure method is a complete method for the atomic networks on INDU= .
9.
Conclusions The IN DU calculus lacks many of the nice properties of Allen's calculus: its (weak) composition table does not define a relation algebra.
Consistency does not imply 3consistency, and neither does 3-consistency imply consistency, even for atomic networks: some four node networks are 3-consistent but not consistent.
In spite of these negative results, we are able to characterize interesting tractable subsets of relations.
To this end, we use both the syntactic approach (Horn classes) and the geometrical approach (convexity and pre-convexity).
While the two methods yield the same class in Allen's case, they provide us with two separate tractable subsets in the case of IN DU .
Following the geometrical approach, we define the set of pre-convex relations and prove that its consistency problem is NP-complete (see also Fig.
5).
We then characterize two subsets of pre-convex relations: one is the subset of strongly pre-convex relations, which is tractable (for reasons pertaining to the syntactic properties of its relations), but for which consistency cannot be decided by the -closure method (the usual path-consistency method which uses the  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  139  Fig.
5.
Recapitulatory of the complexity results.
weak composition operation).
The other (incomparable) subclass is tractable and its consistency problem can be solved by the -closure method.
In the general case, this method is not complete for the IN DU atomic networks.
Despite this, we prove that the -closure method is also complete for the set of atomic relations of IN DU implying that the intervals have the same duration.
This paper constitutes a first fully successful exploration of the complexity properties of the IN DU calculus.
References [1] J.F.
Allen, An interval-based representation of temporal knowledge, in: Proceedings of the Seventh Int.
Joint Conf.
on Artificial Intelligence (IJCAI'81), 1981, pp.
221-226.
[2] P. Balbiani, J.-F. Condotta, G. Ligozat, On the consistency problem for the INDU calculus, in: IEEE (Ed.
), Proceeding of the Combined Tenth International Symposium on Temporal Representation and Reasoning and Fourth International Conference on Temporal Logic (TIME-ICTL 2003), Cairns, Queensland, Australia, 2003, pp.
203-211.
140  P. Balbiani et al.
/ Journal of Applied Logic 4 (2006) 119-140  [3] P. Balbiani, J.-F. Condotta, G. Ligozat, Reasoning about generalized intervals: Horn representability and tractability, in: Proc.
of the Seventh International Workshop on Temporal Representation and Reasoning (TIME'2000), Canada, 2000, pp.
23-30.
[4] T. Drakengren, P. Jonsson, Eight maximal tractable subclasses of Allen's algebra with metric time, J.
Artificial Intelligence Res.
7 (1997) 25-45.
[5] M.R.
Garey, D.S.
Johnson, Computers and Intractibility, A Guide to the Theory of NP-Completeness, Freeman, New York, 1979.
[6] M. Koubarakis, Tractable disjunctions of linear constraints, in: Proceedings of the 2nd International Conference on Principles and Practice of Constraint Programming (CP'96), Cambridge, MA, in: Lecture Notes in Comput.
Sci., vol.
1118, Springer, Berlin, 1996, pp.
297-307.
[7] G.V.
Kumari, A.K.
Pujari, Enforcing the local consistency in INDU, in: International Conference on Knowledge Based Computer Systems, India, 2002.
[8] G.V.
Kumari, A.K.
Pujari, Maximality of pre-convex class of INDU, in: International Conference on Knowledge Based Computer Systems, Mumbai, India, 2000.
[9] G. Ligozat, A new proof of tractability for ORD-Horn relations, in: Proc.
of the Thirteenth National Conf.
on Artificial Intel.
(AAAI'96), vol.
1, 1996, pp.
395-401.
[10] A.K.
Mackworth, E.C.
Freuder, The complexity of some polynomial network consistency algorithms for constraint satisfaction problems, Artificial Intelligence 25 (1) (1985) 65-74.
[11] B. Nebel, H.-J.
Burckert, Reasoning about temporal relations: A maximal tractable subclass of Allen's interval algebra, J. ACM 42 (1) (1995) 43-66.
[12] A.K.
Pujari, G.V.
Kumari, A. Sattar, INDU: An interval and duration network, in: Australian Joint Conference on Artificial Intelligence, 1999, pp.
291-303.
[13] A. Tarski, On the calculus of relations, J.
Symbolic Logic 6 (3) (1941) 73-89.
[14] M. Vilain, H. Kautz, Constraint Propagation algorithms for temporal reasoning, in: T. Kehler, S. Rosenschein (Eds.
), Proceedings of the Fifth National Conference on Artificial Intelligence (AAAI'86), American Association for Artificial Intelligence, Morgan Kaufmann, San Mateo, CA, 1986, pp.
377-382.